{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, createVNode as _createVNode, withCtx as _withCtx, openBlock as _openBlock, createBlock as _createBlock, normalizeClass as _normalizeClass, createElementBlock as _createElementBlock, normalizeStyle as _normalizeStyle, createTextVNode as _createTextVNode, vShow as _vShow, withDirectives as _withDirectives, Transition as _Transition, renderList as _renderList, Fragment as _Fragment } from \"vue\";\nconst _hoisted_1 = {\n  class: \"chart-config-panel\"\n};\nconst _hoisted_2 = {\n  class: \"panel-header-CCP\",\n  style: {\n    \"position\": \"relative\",\n    \"display\": \"flex\",\n    \"align-items\": \"center\",\n    \"justify-content\": \"space-between\"\n  }\n};\nconst _hoisted_3 = [\"innerHTML\"];\nconst _hoisted_4 = {\n  class: \"chart-type-name\"\n};\nconst _hoisted_5 = {\n  class: \"mapping-section-toggle-wrapper\"\n};\nconst _hoisted_6 = {\n  key: 0,\n  class: \"filter-panel-modal\"\n};\nconst _hoisted_7 = {\n  style: {\n    \"display\": \"flex\",\n    \"justify-content\": \"space-between\",\n    \"align-items\": \"center\",\n    \"cursor\": \"move\"\n  }\n};\nconst _hoisted_8 = {\n  class: \"echarts-option-preview-collapsible\",\n  style: {\n    \"margin\": \"16px 0\"\n  }\n};\nconst _hoisted_9 = {\n  style: {\n    \"padding\": \"8px 12px\",\n    \"background\": \"#f7f7fa\",\n    \"border-radius\": \"0 0 6px 6px\",\n    \"font-size\": \"13px\",\n    \"color\": \"#444\",\n    \"border-top\": \"1px solid #eee\"\n  }\n};\nconst _hoisted_10 = {\n  style: {\n    \"white-space\": \"pre-wrap\",\n    \"word-break\": \"break-all\",\n    \"background\": \"none\",\n    \"color\": \"#444\",\n    \"margin\": \"0\"\n  }\n};\nconst _hoisted_11 = {\n  key: 0,\n  style: {\n    \"margin-top\": \"8px\"\n  }\n};\nconst _hoisted_12 = {\n  style: {\n    \"white-space\": \"pre-wrap\",\n    \"word-break\": \"break-all\",\n    \"background\": \"none\",\n    \"color\": \"#444\",\n    \"margin\": \"0\"\n  }\n};\nconst _hoisted_13 = {\n  class: \"action-section\"\n};\nconst _hoisted_14 = [\"disabled\"];\nconst _hoisted_15 = {\n  key: 2,\n  class: \"error-message\"\n};\nconst _hoisted_16 = {\n  class: \"error-text\"\n};\nconst _hoisted_17 = {\n  class: \"tooltip-header\"\n};\nconst _hoisted_18 = {\n  class: \"tooltip-title\"\n};\nconst _hoisted_19 = {\n  class: \"tooltip-description\"\n};\nconst _hoisted_20 = {\n  class: \"tooltip-section\"\n};\nconst _hoisted_21 = {\n  class: \"tooltip-tags\"\n};\nconst _hoisted_22 = {\n  class: \"tooltip-section\"\n};\nconst _hoisted_23 = {\n  class: \"tooltip-tags\"\n};\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\" 右侧边栏总标题 \"), _createElementVNode(\"div\", _hoisted_2, [_cache[12] || (_cache[12] = _createElementVNode(\"h3\", {\n    style: {\n      \"margin\": \"0\"\n    }\n  }, \" Chart Configuration \", -1 /* HOISTED */)), _createCommentVNode(\" 图表类型及相关提示 \"), _createElementVNode(\"div\", {\n    class: \"chart-type-tag\",\n    onMouseenter: _cache[0] || (_cache[0] = $event => $setup.showTooltip($event, $setup.props.selectedChartType)),\n    onMouseleave: $setup.hideTooltip,\n    style: {\n      \"position\": \"relative\",\n      \"max-width\": \"50%\",\n      \"white-space\": \"normal\",\n      \"word-break\": \"break-all\",\n      \"text-align\": \"right\",\n      \"right\": \"0\",\n      \"margin-right\": \"3%\"\n    }\n  }, [_createElementVNode(\"span\", {\n    class: \"chart-type-icon\",\n    innerHTML: $setup.getChartIcon($props.selectedChartType)\n  }, null, 8 /* PROPS */, _hoisted_3), _createElementVNode(\"span\", _hoisted_4, _toDisplayString($props.selectedChartType), 1 /* TEXT */)], 32 /* NEED_HYDRATION */)]), _createCommentVNode(\" 动态数据映射配置区域 \"), _createElementVNode(\"div\", _hoisted_5, [$setup.currentTypeConfig.mapping ? (_openBlock(), _createBlock($setup[\"ChartMappingConfig\"], {\n    key: 0,\n    mappingConfig: $setup.currentTypeConfig.mapping,\n    modelValue: $setup.chartConfig,\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => $setup.chartConfig = $event)\n  }, {\n    \"title-append\": _withCtx(() => [_createCommentVNode(\" 自动渲染开关 \"), _createVNode($setup[\"AutoRenderToggle\"], {\n      modelValue: $setup.autoRender,\n      \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => $setup.autoRender = $event)\n    }, null, 8 /* PROPS */, [\"modelValue\"])]),\n    _: 1 /* STABLE */\n  }, 8 /* PROPS */, [\"mappingConfig\", \"modelValue\"])) : _createCommentVNode(\"v-if\", true)]), _createCommentVNode(\" 动态数据过滤配置区域（改为弹窗面板） \"), _createElementVNode(\"button\", {\n    class: \"open-filter-panel-btn\",\n    onClick: _cache[3] || (_cache[3] = $event => $setup.showFilterPanel = true),\n    style: {\n      \"margin\": \"8px 0；\"\n    }\n  }, \" 配置数据过滤条件 \"), $setup.showFilterPanel ? (_openBlock(), _createElementBlock(\"div\", _hoisted_6, [_createElementVNode(\"div\", {\n    class: _normalizeClass([\"filter-panel-content\", {\n      'filter-panel-blur': !$setup.isPanelFocused\n    }]),\n    tabindex: \"0\",\n    onMousedown: $setup.startDrag,\n    onFocus: _cache[6] || (_cache[6] = $event => $setup.isPanelFocused = true),\n    onBlur: _cache[7] || (_cache[7] = $event => $setup.isPanelFocused = false),\n    onMouseenter: _cache[8] || (_cache[8] = $event => $setup.isPanelFocused = true),\n    onMouseleave: _cache[9] || (_cache[9] = $event => $setup.isPanelFocused = false)\n  }, [_createElementVNode(\"div\", _hoisted_7, [_cache[13] || (_cache[13] = _createElementVNode(\"h4\", {\n    style: {\n      \"margin\": \"0\"\n    }\n  }, \"数据过滤条件配置\", -1 /* HOISTED */)), _createElementVNode(\"button\", {\n    onClick: _cache[4] || (_cache[4] = $event => $setup.showFilterPanel = false),\n    style: {\n      \"font-size\": \"18px\"\n    }\n  }, \"×\")]), _createVNode($setup[\"ChartFilterConfig\"], {\n    filterConfig: $setup.currentTypeConfig.filter,\n    modelValue: $setup.chartConfig.filter,\n    \"onUpdate:modelValue\": _cache[5] || (_cache[5] = $event => $setup.chartConfig.filter = $event)\n  }, null, 8 /* PROPS */, [\"filterConfig\", \"modelValue\"])], 34 /* CLASS, NEED_HYDRATION */)])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 动态高级配置区域 \"), $setup.currentTypeConfig.advanced && $setup.currentTypeConfig.advanced.length ? (_openBlock(), _createBlock($setup[\"ChartAdvancedConfig\"], {\n    key: 1,\n    advancedConfig: $setup.currentTypeConfig.advanced,\n    modelValue: $setup.chartConfig,\n    \"onUpdate:modelValue\": _cache[10] || (_cache[10] = $event => $setup.chartConfig = $event)\n  }, null, 8 /* PROPS */, [\"advancedConfig\", \"modelValue\"])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" ECharts option 相关配置项预览（可折叠） \"), _createElementVNode(\"div\", _hoisted_8, [_createElementVNode(\"div\", {\n    onClick: _cache[11] || (_cache[11] = $event => $setup.showOptionPreview = !$setup.showOptionPreview),\n    style: {\n      \"cursor\": \"pointer\",\n      \"display\": \"flex\",\n      \"align-items\": \"center\",\n      \"user-select\": \"none\",\n      \"font-weight\": \"bold\",\n      \"background\": \"#f7f7fa\",\n      \"border-radius\": \"6px 6px 0 0\",\n      \"padding\": \"8px 12px\",\n      \"color\": \"#666\",\n      \"font-size\": \"14px\"\n    }\n  }, [_createElementVNode(\"span\", {\n    style: _normalizeStyle([{\n      \"margin-right\": \"6px\",\n      \"font-size\": \"12px\",\n      \"transition\": \"transform 0.2s\"\n    }, {\n      transform: $setup.showOptionPreview ? 'rotate(0deg)' : 'rotate(-90deg)'\n    }])\n  }, \"▼\", 4 /* STYLE */), _cache[14] || (_cache[14] = _createTextVNode(\" ECharts Option 预览（只读） \"))]), _createVNode(_Transition, {\n    name: \"collapse\",\n    persisted: \"\"\n  }, {\n    default: _withCtx(() => [_withDirectives(_createElementVNode(\"div\", _hoisted_9, [_cache[16] || (_cache[16] = _createElementVNode(\"div\", null, [_createElementVNode(\"b\", null, \"当前配置项：\")], -1 /* HOISTED */)), _createElementVNode(\"pre\", _hoisted_10, _toDisplayString(JSON.stringify($setup.chartConfig, null, 2)), 1 /* TEXT */), $setup.chartConfig.filter && $setup.chartConfig.filter.length ? (_openBlock(), _createElementBlock(\"div\", _hoisted_11, [_cache[15] || (_cache[15] = _createElementVNode(\"b\", null, \"Filter 配置：\", -1 /* HOISTED */)), _createElementVNode(\"pre\", _hoisted_12, _toDisplayString(JSON.stringify($setup.chartConfig.filter, null, 2)), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true)], 512 /* NEED_PATCH */), [[_vShow, $setup.showOptionPreview]])]),\n    _: 1 /* STABLE */\n  })]), _createCommentVNode(\" 操作按钮 \"), _createElementVNode(\"div\", _hoisted_13, [_createElementVNode(\"button\", {\n    class: \"apply-btn\",\n    disabled: $setup.autoRender || !$setup.isConfigValid,\n    onClick: $setup.generateChart\n  }, \" Apply Configuration \", 8 /* PROPS */, _hoisted_14), _createElementVNode(\"button\", {\n    class: \"reset-btn\",\n    onClick: $setup.resetConfig\n  }, \" Reset Configuration \")]), _createCommentVNode(\" 错误提示 \"), $setup.errorMessage ? (_openBlock(), _createElementBlock(\"div\", _hoisted_15, [_createElementVNode(\"div\", _hoisted_16, _toDisplayString($setup.errorMessage), 1 /* TEXT */)])) : _createCommentVNode(\"v-if\", true), _createCommentVNode(\" 提示框 \"), $setup.tooltip.visible ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 3,\n    class: \"chart-tooltip\",\n    style: _normalizeStyle($setup.tooltip.style),\n    ref: \"tooltipRef\"\n  }, [_createElementVNode(\"div\", _hoisted_17, [_createElementVNode(\"span\", _hoisted_18, _toDisplayString($setup.tooltip.type), 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_19, _toDisplayString($setup.tooltip.description), 1 /* TEXT */)]), _createElementVNode(\"div\", _hoisted_20, [_cache[17] || (_cache[17] = _createElementVNode(\"h4\", null, \"Data Requirements\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_21, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.tooltip.dataRequirements, requirement => {\n    return _openBlock(), _createElementBlock(\"span\", {\n      key: requirement,\n      class: \"tooltip-tag data-tag\"\n    }, _toDisplayString(requirement), 1 /* TEXT */);\n  }), 128 /* KEYED_FRAGMENT */))])]), _createElementVNode(\"div\", _hoisted_22, [_cache[18] || (_cache[18] = _createElementVNode(\"h4\", null, \"Use Cases\", -1 /* HOISTED */)), _createElementVNode(\"div\", _hoisted_23, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.tooltip.useCases, useCase => {\n    return _openBlock(), _createElementBlock(\"span\", {\n      key: useCase,\n      class: \"tooltip-tag use-case-tag\"\n    }, _toDisplayString(useCase), 1 /* TEXT */);\n  }), 128 /* KEYED_FRAGMENT */))])])], 4 /* STYLE */)) : _createCommentVNode(\"v-if\", true)]);\n}","map":{"version":3,"names":["class","style","key","_createElementBlock","_hoisted_1","_createCommentVNode","_createElementVNode","_hoisted_2","onMouseenter","_cache","$event","$setup","showTooltip","props","selectedChartType","onMouseleave","hideTooltip","innerHTML","getChartIcon","$props","_hoisted_3","_hoisted_4","_toDisplayString","_hoisted_5","currentTypeConfig","mapping","_createBlock","mappingConfig","modelValue","chartConfig","_withCtx","_createVNode","autoRender","_","onClick","showFilterPanel","_hoisted_6","_normalizeClass","isPanelFocused","tabindex","onMousedown","startDrag","onFocus","onBlur","_hoisted_7","filterConfig","filter","advanced","length","advancedConfig","_hoisted_8","showOptionPreview","_normalizeStyle","transform","_createTextVNode","_Transition","name","persisted","default","_hoisted_9","_hoisted_10","JSON","stringify","_hoisted_11","_hoisted_12","_hoisted_13","disabled","isConfigValid","generateChart","_hoisted_14","resetConfig","errorMessage","_hoisted_15","_hoisted_16","tooltip","visible","ref","_hoisted_17","_hoisted_18","type","_hoisted_19","description","_hoisted_20","_hoisted_21","_Fragment","_renderList","dataRequirements","requirement","_hoisted_22","_hoisted_23","useCases","useCase"],"sources":["D:\\Learning Material\\Git\\Fuck-Charts\\frontend\\src\\components\\Chart\\ChartConfigPanel.vue"],"sourcesContent":["<template>\n<div class=\"chart-config-panel\">\n    <!-- 右侧边栏总标题 -->\n    <div class=\"panel-header-CCP\" style=\"position: relative; display: flex; align-items: center; justify-content: space-between;\">\n        <h3 style=\"margin: 0;\">\n            Chart Configuration\n        </h3>\n        <!-- 图表类型及相关提示 -->\n        <div\n            class=\"chart-type-tag\"\n            @mouseenter=\"showTooltip($event, props.selectedChartType)\"\n            @mouseleave=\"hideTooltip\"\n            style=\"position: relative; max-width: 50%; white-space: normal; word-break: break-all; text-align: right; right: 0; margin-right: 3%;\"\n        >\n            <span class=\"chart-type-icon\" v-html=\"getChartIcon(selectedChartType)\"></span>\n            <span class=\"chart-type-name\">{{ selectedChartType }}</span>\n        </div>\n    </div>\n\n    <!-- 动态数据映射配置区域 -->\n    <div class=\"mapping-section-toggle-wrapper\">\n        <ChartMappingConfig\n            v-if=\"currentTypeConfig.mapping\"\n            :mappingConfig=\"currentTypeConfig.mapping\"\n            v-model=\"chartConfig\"\n        >\n            <template #title-append>\n            <!-- 自动渲染开关 -->\n            <AutoRenderToggle v-model=\"autoRender\" />\n            </template>\n        </ChartMappingConfig>\n    </div>\n\n    <!-- 动态数据过滤配置区域（改为弹窗面板） -->\n    <button class=\"open-filter-panel-btn\" @click=\"showFilterPanel = true\" style=\"margin: 8px 0；\">\n      配置数据过滤条件\n    </button>\n    <div v-if=\"showFilterPanel\" class=\"filter-panel-modal\">\n      <div\n        class=\"filter-panel-content\"\n        :class=\"{ 'filter-panel-blur': !isPanelFocused }\"\n        tabindex=\"0\"\n        @mousedown=\"startDrag\"\n        @focus=\"isPanelFocused = true\"\n        @blur=\"isPanelFocused = false\"\n        @mouseenter=\"isPanelFocused = true\"\n        @mouseleave=\"isPanelFocused = false\"\n      >\n        <div style=\"display:flex;justify-content:space-between;align-items:center;cursor:move;\">\n          <h4 style=\"margin:0;\">数据过滤条件配置</h4>\n          <button @click=\"showFilterPanel = false\" style=\"font-size:18px;\">×</button>\n        </div>\n        <ChartFilterConfig\n          :filterConfig=\"currentTypeConfig.filter\"\n          v-model=\"chartConfig.filter\"\n        />\n      </div>\n    </div>\n\n    <!-- 动态高级配置区域 -->\n    <ChartAdvancedConfig\n        v-if=\"currentTypeConfig.advanced && currentTypeConfig.advanced.length\"\n        :advancedConfig=\"currentTypeConfig.advanced\"\n        v-model=\"chartConfig\"\n    />\n\n    <!-- ECharts option 相关配置项预览（可折叠） -->\n    <div class=\"echarts-option-preview-collapsible\" style=\"margin: 16px 0;\">\n      <div @click=\"showOptionPreview = !showOptionPreview\" style=\"cursor: pointer; display: flex; align-items: center; user-select: none; font-weight: bold; background: #f7f7fa; border-radius: 6px 6px 0 0; padding: 8px 12px; color: #666; font-size: 14px;\">\n        <span style=\"margin-right: 6px; font-size: 12px; transition: transform 0.2s;\" :style=\"{transform: showOptionPreview ? 'rotate(0deg)' : 'rotate(-90deg)'}\">&#9660;</span>\n        ECharts Option 预览（只读）\n      </div>\n      <transition name=\"collapse\">\n        <div v-show=\"showOptionPreview\" style=\"padding: 8px 12px; background: #f7f7fa; border-radius: 0 0 6px 6px; font-size: 13px; color: #444; border-top: 1px solid #eee;\">\n          <div><b>当前配置项：</b></div>\n          <pre style=\"white-space: pre-wrap; word-break: break-all; background: none; color: #444; margin: 0;\">{{ JSON.stringify(chartConfig, null, 2) }}</pre>\n          <div v-if=\"chartConfig.filter && chartConfig.filter.length\" style=\"margin-top: 8px;\">\n            <b>Filter 配置：</b>\n            <pre style=\"white-space: pre-wrap; word-break: break-all; background: none; color: #444; margin: 0;\">{{ JSON.stringify(chartConfig.filter, null, 2) }}</pre>\n          </div>\n        </div>\n      </transition>\n    </div>\n\n    <!-- 操作按钮 -->\n    <div class=\"action-section\">\n        <button\n        class=\"apply-btn\"\n        :disabled=\"autoRender || !isConfigValid\"\n        @click=\"generateChart\"\n        >\n        Apply Configuration\n        </button>\n        <button class=\"reset-btn\" @click=\"resetConfig\">\n        Reset Configuration\n        </button>\n    </div>\n\n    <!-- 错误提示 -->\n    <div v-if=\"errorMessage\" class=\"error-message\">\n        <div class=\"error-text\">{{ errorMessage }}</div>\n    </div>\n\n    <!-- 提示框 -->\n    <div\n        v-if=\"tooltip.visible\"\n        class=\"chart-tooltip\"\n        :style=\"tooltip.style\"\n        ref=\"tooltipRef\"\n    >\n        <div class=\"tooltip-header\">\n            <span class=\"tooltip-title\">{{ tooltip.type }}</span>\n            <span class=\"tooltip-description\">{{ tooltip.description }}</span>\n        </div>\n        <div class=\"tooltip-section\">\n            <h4>Data Requirements</h4>\n            <div class=\"tooltip-tags\">\n                <span\n                    v-for=\"requirement in tooltip.dataRequirements\"\n                    :key=\"requirement\"\n                    class=\"tooltip-tag data-tag\"\n                >\n                    {{ requirement }}\n                </span>\n            </div>\n        </div>\n        <div class=\"tooltip-section\">\n            <h4>Use Cases</h4>\n            <div class=\"tooltip-tags\">\n                <span\n                    v-for=\"useCase in tooltip.useCases\"\n                    :key=\"useCase\"\n                    class=\"tooltip-tag use-case-tag\"\n                >\n                    {{ useCase }}\n                </span>\n            </div>\n        </div>\n    </div>\n</div>\n</template>\n\n<script setup>\n/* eslint-disable */\nimport { ref, computed, watch, reactive, nextTick } from 'vue'\nimport { chartIcons } from '../../assets/JS/SVG/chartIcons.js'\nimport { chartsTooltipConfig } from '../../assets/JS/Config/ChartsTooltipConfig.js'\nimport { chartTypeConfig } from '../../assets/JS/Config/ChartTypeConfig.js'\nimport AutoRenderToggle from '../Common/AutoRenderToggle.vue'\nimport ChartMappingConfig from './ChartMappingConfig.vue'\nimport ChartFilterConfig from './ChartFilterConfig.vue'\nimport ChartAdvancedConfig from './ChartAdvancedConfig.vue'\n\n// ECharts option 预览折叠状态\nconst showOptionPreview = ref(false)\n\n// 当前类型的配置\nconst currentTypeConfig = computed(() => {\n  // 兼容首字母大写/小写\n    return chartTypeConfig[props.selectedChartType] || chartTypeConfig[props.selectedChartType.charAt(0).toUpperCase() + props.selectedChartType.slice(1)] || {}\n})\n\n// Props\nconst props = defineProps({\n    selectedChartType: {\n        type: String,\n        default: 'line'\n    },\n    currentFile: {\n        type: Object,\n        default: null\n    }\n})\n\n// Emits\nconst emit = defineEmits(['config-change', 'generate-chart'])\n\n// 响应式数据\nconst showDataFilter = ref(false)\nconst showAdvancedConfig = ref(false)\nconst showFilterPanel = ref(false)\nconst errorMessage = ref('')\nconst tooltipRef = ref(null)\n\n// 拖拽弹窗相关\nimport { onMounted, onBeforeUnmount } from 'vue'\nconst isPanelFocused = ref(true)\nlet drag = { active: false, offsetX: 0, offsetY: 0 }\nlet panelEl = null\n\nfunction startDrag(e) {\n  panelEl = e.currentTarget\n  drag.active = true\n  drag.offsetX = e.clientX - panelEl.getBoundingClientRect().left\n  drag.offsetY = e.clientY - panelEl.getBoundingClientRect().top\n  document.addEventListener('mousemove', onDrag)\n  document.addEventListener('mouseup', stopDrag)\n}\nfunction onDrag(e) {\n  if (!drag.active || !panelEl) return\n  panelEl.style.left = e.clientX - drag.offsetX + 'px'\n  panelEl.style.top = e.clientY - drag.offsetY + 'px'\n  panelEl.style.transform = 'none'\n}\nfunction stopDrag() {\n  drag.active = false\n  panelEl = null\n  document.removeEventListener('mousemove', onDrag)\n  document.removeEventListener('mouseup', stopDrag)\n}\nonBeforeUnmount(() => {\n  document.removeEventListener('mousemove', onDrag)\n  document.removeEventListener('mouseup', stopDrag)\n})\n\n// 自动渲染开关，默认手动渲染\nconst autoRender = ref(false)\n\n// 提示框状态\nconst tooltip = reactive({\n    visible: false,\n    type: '',\n    description: '',\n    dataRequirements: [],\n    useCases: [],\n    style: {}\n})\n\nlet tooltipTimeout = null\n\n// 拖拽状态\nconst isDragOver = ref({\n    xAxis: false,\n    yAxis: false,\n    series: false\n})\n\nconst dragError = ref({\n    xAxis: false,\n    yAxis: false,\n    series: false\n})\n\n// 图表配置，支持 filter 字段\nconst chartConfig = ref({\n    xAxis: {\n        field: '',\n        type: ''\n    },\n    yAxis: {\n        field: '',\n        type: ''\n    },\n    series: [],\n    title: '',\n    colorScheme: 'default',\n    animation: true,\n    dataRange: 'all',\n    nullHandling: 'ignore',\n    filter: [] // 用于 ECharts 5 filter 语法\n})\n\n// 计算属性\nconst isConfigValid = computed(() => {\n    const xValid = chartConfig.value.xAxis && chartConfig.value.xAxis.field;\n    const y = chartConfig.value.yAxis;\n    const yValid = Array.isArray(y) ? y.length > 0 : (y && y.field);\n    return xValid && yValid;\n})\n\n// 监听 chartConfig 变化，自动渲染\nwatch(chartConfig, (val) => {\n    if (autoRender.value && isConfigValid.value) {\n        emit('generate-chart', chartConfig.value)\n    }\n    console.log('Current chartConfig:', JSON.parse(JSON.stringify(val)))\n}, { deep: true })\n\n// 监听自动渲染开关变化，切换为实时时立即渲染\nwatch(autoRender, (val) => {\n    if (val && isConfigValid.value) {\n        emit('generate-chart', chartConfig.value)\n    }\n})\n\nfunction getChartIcon (type) {\n    // 直接使用传入的类型，chartIcons.js 中的键是首字母大写格式\n    return chartIcons[type] || ''\n}\n\nfunction toggleDataFilter() {\n    showDataFilter.value = !showDataFilter.value\n}\n\nfunction toggleAdvancedConfig() {\n    showAdvancedConfig.value = !showAdvancedConfig.value\n}\n\n// 显示提示框\nfunction showTooltip(event, type) {\n    // 清除之前的定时器\n    if (tooltipTimeout) {\n        clearTimeout(tooltipTimeout)\n    }\n    \n    // 设置1.2秒延迟\n    tooltipTimeout = setTimeout(() => {\n        const config = chartsTooltipConfig[type]\n        if (config) {\n            tooltip.type = type\n            tooltip.description = config.description\n            tooltip.dataRequirements = config.dataRequirements\n            tooltip.useCases = config.useCases\n            tooltip.visible = true\n            \n            // 在下一个tick中计算位置，确保DOM已更新\n            nextTick(() => {\n                positionTooltip(event)\n            })\n        }\n    }, 1200) // 1.2秒延迟\n}\n\n// 隐藏提示框\nfunction hideTooltip() {\n    if (tooltipTimeout) {\n        clearTimeout(tooltipTimeout)\n        tooltipTimeout = null\n    }\n    tooltip.visible = false\n}\n\n// 计算提示框位置，确保不超出屏幕\nfunction positionTooltip(event) {\n    if (!tooltipRef.value) return\n    \n    const tooltipEl = tooltipRef.value\n    const rect = tooltipEl.getBoundingClientRect()\n    const viewportWidth = window.innerWidth\n    const viewportHeight = window.innerHeight\n    \n    let left = event.pageX + 10\n    let top = event.pageY + 10\n    \n    // 防止右边超出屏幕\n    if (left + rect.width > viewportWidth) {\n        left = event.pageX - rect.width - 10\n    }\n    \n    // 防止底部超出屏幕\n    if (top + rect.height > viewportHeight) {\n        top = event.pageY - rect.height - 10\n    }\n    \n    // 防止左边超出屏幕\n    if (left < 0) {\n        left = 10\n    }\n    \n    // 防止顶部超出屏幕\n    if (top < 0) {\n        top = 10\n    }\n    \n    tooltip.style = {\n        left: `${left}px`,\n        top: `${top}px`,\n        position: 'fixed',\n        zIndex: 1000\n    }\n}\n\n// 拖拽处理\nfunction handleDragEnter (target) {\n    isDragOver.value[target] = true\n    dragError.value[target] = false\n    }\n\nfunction handleDragLeave (target) {\n    isDragOver.value[target] = false\n}\n\nfunction handleDragOver (event, target) {\n    event.preventDefault()\n    isDragOver.value[target] = true\n}\n\nfunction handleDrop (event, target) {\n    event.preventDefault()\n    isDragOver.value[target] = false\n\n    try {\n        const dragData = JSON.parse(event.dataTransfer.getData('text/plain'))\n\n        if (dragData.type === 'column') {\n        const column = dragData.column\n\n        // 验证数据类型是否适合目标区域\n        if (validateColumnForTarget(column, target)) {\n            mapColumnToTarget(column, target)\n            errorMessage.value = ''\n        } else {\n            dragError.value[target] = true\n            errorMessage.value = `Column \"${column.name}\" data type is not suitable for ${getTargetName(target)}`\n            setTimeout(() => {\n            dragError.value[target] = false\n            errorMessage.value = ''\n            }, 3000)\n        }\n        }\n    } catch (error) {\n        console.error('Drop failed:', error)\n        errorMessage.value = 'Drag and drop failed, please try again'\n    }\n}\n\nfunction validateColumnForTarget (column, target) {\n    const columnType = column.type\n\n    switch (target) {\n        case 'xAxis':\n        // X轴通常接受类别型数据\n        return ['string', 'category', 'date'].includes(columnType)\n        case 'yAxis':\n        // Y轴通常接受数值型数据\n        return ['number', 'integer'].includes(columnType)\n        case 'series':\n        // 系列数据通常接受数值型数据\n        return ['number', 'integer'].includes(columnType)\n        default:\n        return true\n    }\n}\n\nfunction mapColumnToTarget (column, target) {\n    switch (target) {\n        case 'xAxis':\n        chartConfig.value.xAxis = {\n            field: column.name,\n            type: column.type\n        }\n        break\n        case 'yAxis':\n        chartConfig.value.yAxis = {\n            field: column.name,\n            type: column.type\n        }\n        break\n        case 'series':\n        // 系列可以有多个，但这里简化为单个\n        chartConfig.value.series = [{\n            field: column.name,\n            type: column.type\n        }]\n        break\n    }\n\n    emit('config-change', chartConfig.value)\n}\n\nfunction removeMapping (target) {\n    switch (target) {\n        case 'xAxis':\n        chartConfig.value.xAxis = { field: '', type: '' }\n        break\n        case 'yAxis':\n        chartConfig.value.yAxis = { field: '', type: '' }\n        break\n        case 'series':\n        chartConfig.value.series = []\n        break\n    }\n\n    emit('config-change', chartConfig.value)\n}\n\nfunction removeSeriesMapping (index) {\n    chartConfig.value.series.splice(index, 1)\n    emit('config-change', chartConfig.value)\n}\n\nfunction getTargetName (target) {\n    const names = {\n        xAxis: 'X Axis',\n        yAxis: 'Y Axis',\n        series: 'Data Series'\n    }\n    return names[target] || target\n}\n\nfunction generateChart () {\n    if (!isConfigValid.value) {\n        errorMessage.value = 'Please complete the required data mapping configuration'\n        return\n    }\n\n    emit('generate-chart', chartConfig.value)\n}\n\nfunction resetConfig () {\n    chartConfig.value = {\n        xAxis: { field: '', type: '' },\n        yAxis: { field: '', type: '' },\n        series: [],\n        title: '',\n        colorScheme: 'default',\n        animation: true,\n        dataRange: 'all',\n        nullHandling: 'ignore'\n    }\n\n    errorMessage.value = ''\n    emit('config-change', chartConfig.value)\n}\n\n// 监听图表类型变化\nwatch(() => props.selectedChartType, (newType) => {\n    // 根据图表类型调整配置\n    if (newType === 'Pie' || newType === 'pie') {\n        // 饼图不需要Y轴\n        chartConfig.value.yAxis = { field: '', type: '' }\n    }\n    // 自动渲染开启时，切换类型后立即触发渲染\n    if (autoRender.value && isConfigValid.value) {\n        emit('generate-chart', chartConfig.value)\n    }\n})\n</script>\n\n<style scoped>\n@import '../../assets/CSS/ChartConfigPanel.css';\n\n/* 可折叠ECharts Option预览动画 */\n.collapse-enter-active, .collapse-leave-active {\n  transition: max-height 0.28s cubic-bezier(.4,0,.2,1), opacity 0.22s;\n}\n.collapse-enter-from, .collapse-leave-to {\n  max-height: 0;\n  opacity: 0;\n  overflow: hidden;\n}\n.collapse-enter-to, .collapse-leave-from {\n  max-height: 800px;\n  opacity: 1;\n}\n\n.filter-panel-modal {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 100vw;\n  height: 100vh;\n  z-index: 2000;\n  pointer-events: none;\n}\n.filter-panel-content {\n  position: fixed;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  background: #fff;\n  border-radius: 12px;\n  box-shadow: 0 4px 24px rgba(0,0,0,0.18);\n  padding: 32px 28px 24px 28px;\n  min-width: 420px;\n  max-width: 90vw;\n  max-height: 80vh;\n  overflow-y: auto;\n  z-index: 2001;\n  pointer-events: auto;\n  outline: none;\n}\n.filter-panel-blur {\n  opacity: 0.6;\n  transition: opacity 0.2s;\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}