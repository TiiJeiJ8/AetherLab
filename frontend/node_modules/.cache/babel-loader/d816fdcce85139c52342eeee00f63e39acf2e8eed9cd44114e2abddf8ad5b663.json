{"ast":null,"code":"import { ref, computed, watch } from 'vue';\nexport default {\n  __name: 'FileStructurePanel',\n  props: {\n    visible: {\n      type: Boolean,\n      default: false\n    },\n    files: {\n      type: Array,\n      default: () => []\n    }\n  },\n  emits: ['close', 'column-drag-start', 'column-drag-end'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n    const props = __props;\n    const emit = __emit;\n\n    // 拖拽相关\n    const isDragging = ref(false);\n    const position = ref({\n      x: 100,\n      y: 100\n    });\n    const dragOffset = ref({\n      x: 0,\n      y: 0\n    });\n\n    // 文件选择\n    const activeFileIndex = ref(0);\n    const activeFile = computed(() => props.files[activeFileIndex.value]);\n\n    // 监听文件变化，重置活动文件\n    watch(() => props.files, newFiles => {\n      if (newFiles.length === 0) {\n        activeFileIndex.value = 0;\n      } else if (activeFileIndex.value >= newFiles.length) {\n        activeFileIndex.value = 0;\n      }\n    });\n    function setActiveFile(index) {\n      activeFileIndex.value = index;\n    }\n    function getFileType(filename) {\n      const ext = filename.split('.').pop().toLowerCase();\n      return ext.toUpperCase();\n    }\n    function formatSampleValue(value) {\n      if (value === null || value === undefined) return 'null';\n      if (typeof value === 'string' && value.length > 20) {\n        return value.slice(0, 20) + '...';\n      }\n      return String(value);\n    }\n\n    // 面板拖拽\n    function startDrag(e) {\n      isDragging.value = true;\n      dragOffset.value = {\n        x: e.clientX - position.value.x,\n        y: e.clientY - position.value.y\n      };\n      document.addEventListener('mousemove', onDrag);\n      document.addEventListener('mouseup', stopDrag);\n    }\n    function onDrag(e) {\n      if (!isDragging.value) return;\n      position.value = {\n        x: e.clientX - dragOffset.value.x,\n        y: e.clientY - dragOffset.value.y\n      };\n    }\n    function stopDrag() {\n      isDragging.value = false;\n      document.removeEventListener('mousemove', onDrag);\n      document.removeEventListener('mouseup', stopDrag);\n    }\n\n    // 列拖拽\n    function handleDragStart(e, column, file) {\n      e.dataTransfer.effectAllowed = 'copy';\n      e.dataTransfer.setData('application/json', JSON.stringify({\n        column: column,\n        file: file,\n        type: 'column'\n      }));\n      emit('column-drag-start', {\n        column,\n        file\n      });\n    }\n    function handleDragEnd(e) {\n      emit('column-drag-end');\n    }\n    function refreshStructure() {\n      // 刷新文件结构\n      console.log('Refreshing file structure...');\n    }\n    const __returned__ = {\n      props,\n      emit,\n      isDragging,\n      position,\n      dragOffset,\n      activeFileIndex,\n      activeFile,\n      setActiveFile,\n      getFileType,\n      formatSampleValue,\n      startDrag,\n      onDrag,\n      stopDrag,\n      handleDragStart,\n      handleDragEnd,\n      refreshStructure,\n      ref,\n      computed,\n      watch\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","watch","props","__props","emit","__emit","isDragging","position","x","y","dragOffset","activeFileIndex","activeFile","files","value","newFiles","length","setActiveFile","index","getFileType","filename","ext","split","pop","toLowerCase","toUpperCase","formatSampleValue","undefined","slice","String","startDrag","e","clientX","clientY","document","addEventListener","onDrag","stopDrag","removeEventListener","handleDragStart","column","file","dataTransfer","effectAllowed","setData","JSON","stringify","type","handleDragEnd","refreshStructure","console","log"],"sources":["D:/Learning Material/Git/Fuck-Charts/newArchitecture/frontend_vue_design/src/components/FileStructurePanel.vue"],"sourcesContent":["<template>\n  <div \n    class=\"file-structure-panel\"\n    :class=\"{ 'is-dragging': isDragging }\"\n    :style=\"{ transform: `translate(${position.x}px, ${position.y}px)` }\"\n    v-if=\"visible\"\n  >\n    <div \n      class=\"panel-header\"\n      @mousedown=\"startDrag\"\n    >\n      <div class=\"panel-title\">\n        <svg width=\"20\" height=\"20\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n          <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"/>\n          <polyline points=\"14,2 14,8 20,8\"/>\n          <line x1=\"16\" y1=\"13\" x2=\"8\" y2=\"13\"/>\n          <line x1=\"16\" y1=\"17\" x2=\"8\" y2=\"17\"/>\n          <line x1=\"10\" y1=\"9\" x2=\"8\" y2=\"9\"/>\n        </svg>\n        文件结构\n      </div>\n      <div class=\"panel-actions\">\n        <button class=\"action-btn\" @click=\"refreshStructure\">\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <polyline points=\"23,4 23,10 17,10\"/>\n            <polyline points=\"1,20 1,14 7,14\"/>\n            <path d=\"M20.49,9A9,9,0,0,0,5.64,5.64L1,10\"/>\n            <path d=\"M3.51,15a9,9,0,0,0,14.85,3.36L23,14\"/>\n          </svg>\n        </button>\n        <button class=\"action-btn\" @click=\"$emit('close')\">\n          <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n            <line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"/>\n            <line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"/>\n          </svg>\n        </button>\n      </div>\n    </div>\n\n    <div class=\"panel-content\">\n      <div class=\"file-tabs\">\n        <div \n          v-for=\"(file, index) in files\" \n          :key=\"file.id\"\n          :class=\"['file-tab', { active: activeFileIndex === index }]\"\n          @click=\"setActiveFile(index)\"\n        >\n          <span class=\"file-name\">{{ file.name }}</span>\n          <span class=\"file-type\">{{ getFileType(file.name) }}</span>\n        </div>\n      </div>\n\n      <div class=\"file-structure\" v-if=\"activeFile\">\n        <div class=\"structure-header\">\n          <h4>{{ activeFile.name }}</h4>\n          <span class=\"row-count\">{{ activeFile.structure?.rows || 0 }} 行</span>\n        </div>\n        \n        <div class=\"columns-list\">\n          <div \n            v-for=\"(column, index) in activeFile.structure?.columns || []\"\n            :key=\"index\"\n            class=\"column-item\"\n            :draggable=\"true\"\n            @dragstart=\"handleDragStart($event, column, activeFile)\"\n            @dragend=\"handleDragEnd\"\n          >\n            <div class=\"column-header\">\n              <div class=\"column-info\">\n                <span class=\"column-name\">{{ column.name }}</span>\n                <span class=\"column-type\">{{ column.type }}</span>\n              </div>\n              <div class=\"drag-handle\">\n                <svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n                  <circle cx=\"9\" cy=\"12\" r=\"1\"/>\n                  <circle cx=\"9\" cy=\"5\" r=\"1\"/>\n                  <circle cx=\"9\" cy=\"19\" r=\"1\"/>\n                  <circle cx=\"15\" cy=\"12\" r=\"1\"/>\n                  <circle cx=\"15\" cy=\"5\" r=\"1\"/>\n                  <circle cx=\"15\" cy=\"19\" r=\"1\"/>\n                </svg>\n              </div>\n            </div>\n            <div class=\"column-samples\">\n              <div \n                v-for=\"(sample, sIndex) in column.samples?.slice(0, 3) || []\"\n                :key=\"sIndex\"\n                class=\"sample-value\"\n              >\n                {{ formatSampleValue(sample) }}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class=\"no-files\" v-if=\"!files.length\">\n        <svg width=\"48\" height=\"48\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\">\n          <path d=\"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z\"/>\n          <polyline points=\"14,2 14,8 20,8\"/>\n        </svg>\n        <p>暂无数据文件</p>\n        <p>请先上传数据文件</p>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, watch } from 'vue'\n\nconst props = defineProps({\n  visible: {\n    type: Boolean,\n    default: false\n  },\n  files: {\n    type: Array,\n    default: () => []\n  }\n})\n\nconst emit = defineEmits(['close', 'column-drag-start', 'column-drag-end'])\n\n// 拖拽相关\nconst isDragging = ref(false)\nconst position = ref({ x: 100, y: 100 })\nconst dragOffset = ref({ x: 0, y: 0 })\n\n// 文件选择\nconst activeFileIndex = ref(0)\nconst activeFile = computed(() => props.files[activeFileIndex.value])\n\n// 监听文件变化，重置活动文件\nwatch(() => props.files, (newFiles) => {\n  if (newFiles.length === 0) {\n    activeFileIndex.value = 0\n  } else if (activeFileIndex.value >= newFiles.length) {\n    activeFileIndex.value = 0\n  }\n})\n\nfunction setActiveFile(index) {\n  activeFileIndex.value = index\n}\n\nfunction getFileType(filename) {\n  const ext = filename.split('.').pop().toLowerCase()\n  return ext.toUpperCase()\n}\n\nfunction formatSampleValue(value) {\n  if (value === null || value === undefined) return 'null'\n  if (typeof value === 'string' && value.length > 20) {\n    return value.slice(0, 20) + '...'\n  }\n  return String(value)\n}\n\n// 面板拖拽\nfunction startDrag(e) {\n  isDragging.value = true\n  dragOffset.value = {\n    x: e.clientX - position.value.x,\n    y: e.clientY - position.value.y\n  }\n  \n  document.addEventListener('mousemove', onDrag)\n  document.addEventListener('mouseup', stopDrag)\n}\n\nfunction onDrag(e) {\n  if (!isDragging.value) return\n  \n  position.value = {\n    x: e.clientX - dragOffset.value.x,\n    y: e.clientY - dragOffset.value.y\n  }\n}\n\nfunction stopDrag() {\n  isDragging.value = false\n  document.removeEventListener('mousemove', onDrag)\n  document.removeEventListener('mouseup', stopDrag)\n}\n\n// 列拖拽\nfunction handleDragStart(e, column, file) {\n  e.dataTransfer.effectAllowed = 'copy'\n  e.dataTransfer.setData('application/json', JSON.stringify({\n    column: column,\n    file: file,\n    type: 'column'\n  }))\n  \n  emit('column-drag-start', { column, file })\n}\n\nfunction handleDragEnd(e) {\n  emit('column-drag-end')\n}\n\nfunction refreshStructure() {\n  // 刷新文件结构\n  console.log('Refreshing file structure...')\n}\n</script>\n\n<style scoped>\n.file-structure-panel {\n  position: fixed;\n  top: 0;\n  left: 0;\n  width: 400px;\n  max-height: 600px;\n  background: var(--bg-color, #ffffff);\n  border: 1px solid var(--border-color, #e5e7eb);\n  border-radius: 12px;\n  box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);\n  z-index: 1000;\n  overflow: hidden;\n  transition: box-shadow 0.3s ease;\n}\n\n.file-structure-panel.is-dragging {\n  box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);\n}\n\n.panel-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  padding: 1rem;\n  background: var(--bg-secondary, #f8fafc);\n  border-bottom: 1px solid var(--border-color, #e5e7eb);\n  cursor: move;\n  user-select: none;\n}\n\n.panel-title {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  font-weight: 600;\n  color: var(--text-color);\n}\n\n.panel-actions {\n  display: flex;\n  gap: 0.5rem;\n}\n\n.action-btn {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 32px;\n  height: 32px;\n  border: none;\n  border-radius: 6px;\n  background: transparent;\n  color: var(--text-secondary);\n  cursor: pointer;\n  transition: all 0.2s ease;\n}\n\n.action-btn:hover {\n  background: var(--bg-hover, rgba(59, 130, 246, 0.1));\n  color: var(--primary-color, #3b82f6);\n}\n\n.panel-content {\n  max-height: 500px;\n  overflow-y: auto;\n}\n\n.file-tabs {\n  display: flex;\n  overflow-x: auto;\n  border-bottom: 1px solid var(--border-color, #e5e7eb);\n}\n\n.file-tab {\n  display: flex;\n  align-items: center;\n  gap: 0.5rem;\n  padding: 0.75rem 1rem;\n  min-width: 0;\n  cursor: pointer;\n  border-bottom: 2px solid transparent;\n  transition: all 0.2s ease;\n  white-space: nowrap;\n}\n\n.file-tab:hover {\n  background: var(--bg-hover, rgba(59, 130, 246, 0.05));\n}\n\n.file-tab.active {\n  border-bottom-color: var(--primary-color, #3b82f6);\n  background: var(--bg-hover, rgba(59, 130, 246, 0.05));\n}\n\n.file-name {\n  font-weight: 500;\n  color: var(--text-color);\n  flex: 1;\n  min-width: 0;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n\n.file-type {\n  font-size: 0.75rem;\n  color: var(--text-secondary);\n  background: var(--bg-secondary, #f1f5f9);\n  padding: 0.25rem 0.5rem;\n  border-radius: 4px;\n}\n\n.file-structure {\n  padding: 1rem;\n}\n\n.structure-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 1rem;\n}\n\n.structure-header h4 {\n  margin: 0;\n  color: var(--text-color);\n}\n\n.row-count {\n  font-size: 0.875rem;\n  color: var(--text-secondary);\n  background: var(--bg-secondary, #f1f5f9);\n  padding: 0.25rem 0.5rem;\n  border-radius: 4px;\n}\n\n.columns-list {\n  display: flex;\n  flex-direction: column;\n  gap: 0.5rem;\n}\n\n.column-item {\n  border: 1px solid var(--border-color, #e5e7eb);\n  border-radius: 8px;\n  padding: 0.75rem;\n  background: var(--bg-color, #ffffff);\n  cursor: grab;\n  transition: all 0.2s ease;\n}\n\n.column-item:hover {\n  border-color: var(--primary-color, #3b82f6);\n  box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);\n}\n\n.column-item:active {\n  cursor: grabbing;\n}\n\n.column-header {\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin-bottom: 0.5rem;\n}\n\n.column-info {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n\n.column-name {\n  font-weight: 600;\n  color: var(--text-color);\n}\n\n.column-type {\n  font-size: 0.75rem;\n  color: var(--text-secondary);\n  background: var(--bg-secondary, #f1f5f9);\n  padding: 0.25rem 0.5rem;\n  border-radius: 4px;\n  align-self: flex-start;\n}\n\n.drag-handle {\n  color: var(--text-secondary);\n  opacity: 0.6;\n}\n\n.column-samples {\n  display: flex;\n  flex-direction: column;\n  gap: 0.25rem;\n}\n\n.sample-value {\n  font-size: 0.875rem;\n  color: var(--text-secondary);\n  background: var(--bg-secondary, #f8fafc);\n  padding: 0.25rem 0.5rem;\n  border-radius: 4px;\n  font-family: 'Courier New', monospace;\n}\n\n.no-files {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  justify-content: center;\n  padding: 3rem 2rem;\n  color: var(--text-secondary);\n  text-align: center;\n}\n\n.no-files svg {\n  margin-bottom: 1rem;\n  opacity: 0.5;\n}\n\n.no-files p {\n  margin: 0.25rem 0;\n}\n\n@media (max-width: 640px) {\n  .file-structure-panel {\n    width: 90vw;\n    max-width: 350px;\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}