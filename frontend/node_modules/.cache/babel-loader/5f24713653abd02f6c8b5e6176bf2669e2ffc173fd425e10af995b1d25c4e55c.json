{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.for-each.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, normalizeClass as _normalizeClass, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, normalizeStyle as _normalizeStyle, withModifiers as _withModifiers, isRef as _isRef, vModelRadio as _vModelRadio, withDirectives as _withDirectives, createTextVNode as _createTextVNode, vModelText as _vModelText, vModelSelect as _vModelSelect, createStaticVNode as _createStaticVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"data-mapping-panel\"\n};\nconst _hoisted_2 = {\n  class: \"panel-header\"\n};\nconst _hoisted_3 = {\n  class: \"panel-controls\"\n};\nconst _hoisted_4 = [\"disabled\"];\nconst _hoisted_5 = {\n  class: \"mapping-sections\"\n};\nconst _hoisted_6 = {\n  class: \"section-header\"\n};\nconst _hoisted_7 = {\n  class: \"section-title\"\n};\nconst _hoisted_8 = {\n  key: 0,\n  class: \"section-info\"\n};\nconst _hoisted_9 = [\"onDrop\", \"onDragover\"];\nconst _hoisted_10 = {\n  key: 0,\n  class: \"drop-placeholder\"\n};\nconst _hoisted_11 = {\n  class: \"placeholder-text\"\n};\nconst _hoisted_12 = {\n  key: 1,\n  class: \"mapped-items\"\n};\nconst _hoisted_13 = {\n  class: \"item-info\"\n};\nconst _hoisted_14 = {\n  class: \"file-name\"\n};\nconst _hoisted_15 = {\n  class: \"column-name\"\n};\nconst _hoisted_16 = [\"onClick\"];\nconst _hoisted_17 = {\n  class: \"mapping-section\"\n};\nconst _hoisted_18 = {\n  class: \"filter-options\"\n};\nconst _hoisted_19 = {\n  class: \"filter-type\"\n};\nconst _hoisted_20 = {\n  class: \"filter-type\"\n};\nconst _hoisted_21 = {\n  key: 0,\n  class: \"range-inputs\"\n};\nconst _hoisted_22 = {\n  class: \"filter-type\"\n};\nconst _hoisted_23 = {\n  key: 0,\n  class: \"condition-inputs\"\n};\nconst _hoisted_24 = [\"value\"];\nconst _hoisted_25 = {\n  class: \"mapping-section\"\n};\nconst _hoisted_26 = {\n  class: \"section-header\"\n};\nconst _hoisted_27 = {\n  key: 0,\n  class: \"data-preview\"\n};\nconst _hoisted_28 = {\n  class: \"preview-stats\"\n};\nconst _hoisted_29 = {\n  class: \"preview-table\"\n};\nimport { ref, computed, watch } from 'vue';\nimport { useChartMapping } from '../composables/useChartMapping';\nimport { useDataFiltering } from '../composables/useDataFiltering';\nexport default {\n  __name: 'DataMappingPanel',\n  props: {\n    selectedChartType: {\n      type: String,\n      default: 'line'\n    },\n    workspaceFiles: {\n      type: Array,\n      default: () => []\n    }\n  },\n  emits: ['chart-updated', 'mapping-changed'],\n  setup(__props, {\n    emit: __emit\n  }) {\n    const props = __props;\n    const emit = __emit;\n\n    // 图表映射配置\n    const {\n      chartConfigs,\n      mappedData,\n      generateChartOption,\n      removeMapping,\n      addMapping\n    } = useChartMapping(props.selectedChartType);\n\n    // 数据过滤\n    const {\n      filterType,\n      rangeStart,\n      rangeEnd,\n      conditionColumn,\n      conditionOperator,\n      conditionValue,\n      filteredData,\n      updateFilter\n    } = useDataFiltering();\n\n    // 组件状态\n    const realTimeRender = ref(true);\n    const dragOverZone = ref(null);\n    const showPreview = ref(false);\n\n    // 计算属性\n    const availableColumns = computed(() => {\n      const columns = [];\n      props.workspaceFiles.forEach(file => {\n        if (file.columns) {\n          file.columns.forEach(col => {\n            columns.push({\n              id: `${file.id}_${col.name}`,\n              fileName: file.name,\n              columnName: col.name,\n              columnType: col.type,\n              fileId: file.id,\n              color: file.color || '#007acc'\n            });\n          });\n        }\n      });\n      return columns;\n    });\n    const previewData = computed(() => {\n      return filteredData.value.slice(0, 10);\n    });\n    const canRender = computed(() => {\n      return Object.values(mappedData.value).some(arr => arr.length > 0);\n    });\n\n    // 拖拽处理\n    function handleDrop(event, configKey) {\n      event.preventDefault();\n      const columnData = JSON.parse(event.dataTransfer.getData('text/plain'));\n      addMapping(configKey, columnData);\n      dragOverZone.value = null;\n      if (realTimeRender.value) {\n        renderChart();\n      }\n    }\n    function handleDragOver(configKey) {\n      dragOverZone.value = configKey;\n    }\n    function handleDragLeave() {\n      dragOverZone.value = null;\n    }\n\n    // 渲染控制\n    function toggleRealTimeRender() {\n      realTimeRender.value = !realTimeRender.value;\n    }\n    function renderChart() {\n      if (!canRender.value) return;\n      const option = generateChartOption(filteredData.value);\n      emit('chart-updated', option);\n    }\n    function togglePreview() {\n      showPreview.value = !showPreview.value;\n    }\n\n    // 监听变化\n    watch(() => [mappedData.value, filteredData.value], () => {\n      if (realTimeRender.value) {\n        renderChart();\n      }\n      emit('mapping-changed', {\n        mappedData: mappedData.value,\n        filteredData: filteredData.value\n      });\n    }, {\n      deep: true\n    });\n    watch(() => props.selectedChartType, newType => {\n      // 重置映射数据\n      Object.keys(mappedData.value).forEach(key => {\n        mappedData.value[key] = [];\n      });\n    });\n    return (_ctx, _cache) => {\n      return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createElementVNode(\"div\", _hoisted_2, [_cache[16] || (_cache[16] = _createElementVNode(\"h3\", null, \"Data Mapping\", -1)), _createElementVNode(\"div\", _hoisted_3, [_createElementVNode(\"button\", {\n        class: _normalizeClass([\"toggle-btn\", {\n          active: realTimeRender.value\n        }]),\n        onClick: toggleRealTimeRender\n      }, _toDisplayString(realTimeRender.value ? 'Real-time' : 'Manual'), 3), _createElementVNode(\"button\", {\n        class: \"render-btn\",\n        onClick: renderChart,\n        disabled: realTimeRender.value || !canRender.value\n      }, \" Render \", 8, _hoisted_4)])]), _createElementVNode(\"div\", _hoisted_5, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(chartConfigs), config => {\n        return _openBlock(), _createElementBlock(\"div\", {\n          class: \"mapping-section\",\n          key: config.key\n        }, [_createElementVNode(\"div\", _hoisted_6, [_createElementVNode(\"span\", _hoisted_7, _toDisplayString(config.title), 1), config.required ? (_openBlock(), _createElementBlock(\"span\", _hoisted_8, \"*\")) : _createCommentVNode(\"\", true)]), _createElementVNode(\"div\", {\n          class: _normalizeClass([\"drop-zone\", {\n            'drag-over': dragOverZone.value === config.key,\n            'has-data': _unref(mappedData)[config.key]?.length > 0\n          }]),\n          onDrop: $event => handleDrop($event, config.key),\n          onDragover: _withModifiers($event => handleDragOver(config.key), [\"prevent\"]),\n          onDragleave: handleDragLeave\n        }, [_unref(mappedData)[config.key]?.length === 0 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_10, [_cache[17] || (_cache[17] = _createElementVNode(\"span\", {\n          class: \"placeholder-icon\"\n        }, \"📊\", -1)), _createElementVNode(\"span\", _hoisted_11, \"Drop \" + _toDisplayString(config.title) + \" here\", 1)])) : (_openBlock(), _createElementBlock(\"div\", _hoisted_12, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(mappedData)[config.key], (item, index) => {\n          return _openBlock(), _createElementBlock(\"div\", {\n            key: index,\n            class: \"mapped-item\",\n            style: _normalizeStyle({\n              backgroundColor: item.color\n            })\n          }, [_createElementVNode(\"span\", _hoisted_13, [_createElementVNode(\"span\", _hoisted_14, _toDisplayString(item.fileName), 1), _createElementVNode(\"span\", _hoisted_15, _toDisplayString(item.columnName), 1)]), _createElementVNode(\"button\", {\n            class: \"remove-item-btn\",\n            onClick: $event => _unref(removeMapping)(config.key, index)\n          }, \" × \", 8, _hoisted_16)], 4);\n        }), 128))]))], 42, _hoisted_9)]);\n      }), 128)), _createElementVNode(\"div\", _hoisted_17, [_cache[24] || (_cache[24] = _createElementVNode(\"div\", {\n        class: \"section-header\"\n      }, [_createElementVNode(\"span\", {\n        class: \"section-title\"\n      }, \"Data Filtering\")], -1)), _createElementVNode(\"div\", _hoisted_18, [_createElementVNode(\"div\", _hoisted_19, [_createElementVNode(\"label\", null, [_withDirectives(_createElementVNode(\"input\", {\n        type: \"radio\",\n        \"onUpdate:modelValue\": _cache[0] || (_cache[0] = $event => _isRef(filterType) ? filterType.value = $event : null),\n        value: \"all\",\n        onChange: _cache[1] || (_cache[1] = (...args) => _unref(updateFilter) && _unref(updateFilter)(...args))\n      }, null, 544), [[_vModelRadio, _unref(filterType)]]), _cache[18] || (_cache[18] = _createTextVNode(\" All Rows \"))])]), _createElementVNode(\"div\", _hoisted_20, [_createElementVNode(\"label\", null, [_withDirectives(_createElementVNode(\"input\", {\n        type: \"radio\",\n        \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => _isRef(filterType) ? filterType.value = $event : null),\n        value: \"range\",\n        onChange: _cache[3] || (_cache[3] = (...args) => _unref(updateFilter) && _unref(updateFilter)(...args))\n      }, null, 544), [[_vModelRadio, _unref(filterType)]]), _cache[19] || (_cache[19] = _createTextVNode(\" Range \"))]), _unref(filterType) === 'range' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_21, [_withDirectives(_createElementVNode(\"input\", {\n        type: \"number\",\n        \"onUpdate:modelValue\": _cache[4] || (_cache[4] = $event => _isRef(rangeStart) ? rangeStart.value = $event : null),\n        placeholder: \"Start\",\n        onInput: _cache[5] || (_cache[5] = (...args) => _unref(updateFilter) && _unref(updateFilter)(...args))\n      }, null, 544), [[_vModelText, _unref(rangeStart), void 0, {\n        number: true\n      }]]), _cache[20] || (_cache[20] = _createElementVNode(\"span\", null, \"-\", -1)), _withDirectives(_createElementVNode(\"input\", {\n        type: \"number\",\n        \"onUpdate:modelValue\": _cache[6] || (_cache[6] = $event => _isRef(rangeEnd) ? rangeEnd.value = $event : null),\n        placeholder: \"End\",\n        onInput: _cache[7] || (_cache[7] = (...args) => _unref(updateFilter) && _unref(updateFilter)(...args))\n      }, null, 544), [[_vModelText, _unref(rangeEnd), void 0, {\n        number: true\n      }]])])) : _createCommentVNode(\"\", true)]), _createElementVNode(\"div\", _hoisted_22, [_createElementVNode(\"label\", null, [_withDirectives(_createElementVNode(\"input\", {\n        type: \"radio\",\n        \"onUpdate:modelValue\": _cache[8] || (_cache[8] = $event => _isRef(filterType) ? filterType.value = $event : null),\n        value: \"condition\",\n        onChange: _cache[9] || (_cache[9] = (...args) => _unref(updateFilter) && _unref(updateFilter)(...args))\n      }, null, 544), [[_vModelRadio, _unref(filterType)]]), _cache[21] || (_cache[21] = _createTextVNode(\" Condition \"))]), _unref(filterType) === 'condition' ? (_openBlock(), _createElementBlock(\"div\", _hoisted_23, [_withDirectives(_createElementVNode(\"select\", {\n        \"onUpdate:modelValue\": _cache[10] || (_cache[10] = $event => _isRef(conditionColumn) ? conditionColumn.value = $event : null),\n        onChange: _cache[11] || (_cache[11] = (...args) => _unref(updateFilter) && _unref(updateFilter)(...args))\n      }, [_cache[22] || (_cache[22] = _createElementVNode(\"option\", {\n        value: \"\"\n      }, \"Select Column\", -1)), (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(availableColumns.value, col => {\n        return _openBlock(), _createElementBlock(\"option\", {\n          key: col.id,\n          value: col.id\n        }, _toDisplayString(col.fileName) + \".\" + _toDisplayString(col.columnName), 9, _hoisted_24);\n      }), 128))], 544), [[_vModelSelect, _unref(conditionColumn)]]), _withDirectives(_createElementVNode(\"select\", {\n        \"onUpdate:modelValue\": _cache[12] || (_cache[12] = $event => _isRef(conditionOperator) ? conditionOperator.value = $event : null),\n        onChange: _cache[13] || (_cache[13] = (...args) => _unref(updateFilter) && _unref(updateFilter)(...args))\n      }, _cache[23] || (_cache[23] = [_createStaticVNode(\"<option value=\\\"&gt;\\\" data-v-78d87a38>&gt;</option><option value=\\\"&lt;\\\" data-v-78d87a38>&lt;</option><option value=\\\"=\\\" data-v-78d87a38>equals</option><option value=\\\"!=\\\" data-v-78d87a38>not equals</option><option value=\\\"contains\\\" data-v-78d87a38>contains</option>\", 5)]), 544), [[_vModelSelect, _unref(conditionOperator)]]), _withDirectives(_createElementVNode(\"input\", {\n        type: \"text\",\n        \"onUpdate:modelValue\": _cache[14] || (_cache[14] = $event => _isRef(conditionValue) ? conditionValue.value = $event : null),\n        placeholder: \"Value\",\n        onInput: _cache[15] || (_cache[15] = (...args) => _unref(updateFilter) && _unref(updateFilter)(...args))\n      }, null, 544), [[_vModelText, _unref(conditionValue)]])])) : _createCommentVNode(\"\", true)])])]), _createElementVNode(\"div\", _hoisted_25, [_createElementVNode(\"div\", _hoisted_26, [_cache[25] || (_cache[25] = _createElementVNode(\"span\", {\n        class: \"section-title\"\n      }, \"Data Preview\", -1)), _createElementVNode(\"button\", {\n        class: \"preview-toggle-btn\",\n        onClick: togglePreview\n      }, _toDisplayString(showPreview.value ? 'Hide' : 'Show'), 1)]), showPreview.value ? (_openBlock(), _createElementBlock(\"div\", _hoisted_27, [_createElementVNode(\"div\", _hoisted_28, [_createElementVNode(\"span\", null, _toDisplayString(previewData.value.length) + \" rows\", 1), _createElementVNode(\"span\", null, _toDisplayString(Object.keys(previewData.value[0] || {}).length) + \" columns\", 1)]), _createElementVNode(\"div\", _hoisted_29, [_createElementVNode(\"table\", null, [_createElementVNode(\"thead\", null, [_createElementVNode(\"tr\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(previewData.value[0], (value, key) => {\n        return _openBlock(), _createElementBlock(\"th\", {\n          key: key\n        }, _toDisplayString(key), 1);\n      }), 128))])]), _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(previewData.value.slice(0, 5), (row, index) => {\n        return _openBlock(), _createElementBlock(\"tr\", {\n          key: index\n        }, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList(row, (value, key) => {\n          return _openBlock(), _createElementBlock(\"td\", {\n            key: key\n          }, _toDisplayString(value), 1);\n        }), 128))]);\n      }), 128))])])])])) : _createCommentVNode(\"\", true)])])]);\n    };\n  }\n};","map":{"version":3,"names":["ref","computed","watch","useChartMapping","useDataFiltering","props","__props","emit","__emit","chartConfigs","mappedData","generateChartOption","removeMapping","addMapping","selectedChartType","filterType","rangeStart","rangeEnd","conditionColumn","conditionOperator","conditionValue","filteredData","updateFilter","realTimeRender","dragOverZone","showPreview","availableColumns","columns","workspaceFiles","forEach","file","col","push","id","name","fileName","columnName","columnType","type","fileId","color","previewData","value","slice","canRender","Object","values","some","arr","length","handleDrop","event","configKey","preventDefault","columnData","JSON","parse","dataTransfer","getData","renderChart","handleDragOver","handleDragLeave","toggleRealTimeRender","option","togglePreview","deep","newType","keys","key"],"sources":["D:/Learning Material/Git/Fuck-Charts/newArchitecture/frontend_vue_design/src/components/DataMappingPanel.vue"],"sourcesContent":["<template>\n  <div class=\"data-mapping-panel\">\n    <div class=\"panel-header\">\n      <h3>Data Mapping</h3>\n      <div class=\"panel-controls\">\n        <button \n          class=\"toggle-btn\"\n          @click=\"toggleRealTimeRender\"\n          :class=\"{ active: realTimeRender }\">\n          {{ realTimeRender ? 'Real-time' : 'Manual' }}\n        </button>\n        <button \n          class=\"render-btn\"\n          @click=\"renderChart\"\n          :disabled=\"realTimeRender || !canRender\">\n          Render\n        </button>\n      </div>\n    </div>\n\n    <div class=\"mapping-sections\">\n      <!-- 图表类型相关配置 -->\n      <div class=\"mapping-section\" v-for=\"config in chartConfigs\" :key=\"config.key\">\n        <div class=\"section-header\">\n          <span class=\"section-title\">{{ config.title }}</span>\n          <span class=\"section-info\" v-if=\"config.required\">*</span>\n        </div>\n        <div \n          class=\"drop-zone\"\n          :class=\"{ \n            'drag-over': dragOverZone === config.key,\n            'has-data': mappedData[config.key]?.length > 0\n          }\"\n          @drop=\"handleDrop($event, config.key)\"\n          @dragover.prevent=\"handleDragOver(config.key)\"\n          @dragleave=\"handleDragLeave\">\n          \n          <div v-if=\"mappedData[config.key]?.length === 0\" class=\"drop-placeholder\">\n            <span class=\"placeholder-icon\">📊</span>\n            <span class=\"placeholder-text\">Drop {{ config.title }} here</span>\n          </div>\n          \n          <div v-else class=\"mapped-items\">\n            <div \n              v-for=\"(item, index) in mappedData[config.key]\" \n              :key=\"index\"\n              class=\"mapped-item\"\n              :style=\"{ backgroundColor: item.color }\">\n              <span class=\"item-info\">\n                <span class=\"file-name\">{{ item.fileName }}</span>\n                <span class=\"column-name\">{{ item.columnName }}</span>\n              </span>\n              <button \n                class=\"remove-item-btn\"\n                @click=\"removeMapping(config.key, index)\">\n                ×\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- 数据过滤选项 -->\n      <div class=\"mapping-section\">\n        <div class=\"section-header\">\n          <span class=\"section-title\">Data Filtering</span>\n        </div>\n        <div class=\"filter-options\">\n          <div class=\"filter-type\">\n            <label>\n              <input \n                type=\"radio\" \n                v-model=\"filterType\" \n                value=\"all\"\n                @change=\"updateFilter\">\n              All Rows\n            </label>\n          </div>\n          <div class=\"filter-type\">\n            <label>\n              <input \n                type=\"radio\" \n                v-model=\"filterType\" \n                value=\"range\"\n                @change=\"updateFilter\">\n              Range\n            </label>\n            <div v-if=\"filterType === 'range'\" class=\"range-inputs\">\n              <input \n                type=\"number\" \n                v-model.number=\"rangeStart\" \n                placeholder=\"Start\"\n                @input=\"updateFilter\">\n              <span>-</span>\n              <input \n                type=\"number\" \n                v-model.number=\"rangeEnd\" \n                placeholder=\"End\"\n                @input=\"updateFilter\">\n            </div>\n          </div>\n          <div class=\"filter-type\">\n            <label>\n              <input \n                type=\"radio\" \n                v-model=\"filterType\" \n                value=\"condition\"\n                @change=\"updateFilter\">\n              Condition\n            </label>\n            <div v-if=\"filterType === 'condition'\" class=\"condition-inputs\">\n              <select v-model=\"conditionColumn\" @change=\"updateFilter\">\n                <option value=\"\">Select Column</option>\n                <option \n                  v-for=\"col in availableColumns\" \n                  :key=\"col.id\"\n                  :value=\"col.id\">\n                  {{ col.fileName }}.{{ col.columnName }}\n                </option>\n              </select>\n              <select v-model=\"conditionOperator\" @change=\"updateFilter\">\n                <option value=\">\">&gt;</option>\n                <option value=\"<\">&lt;</option>\n                <option value=\"=\">equals</option>\n                <option value=\"!=\">not equals</option>\n                <option value=\"contains\">contains</option>\n              </select>\n              <input \n                type=\"text\" \n                v-model=\"conditionValue\" \n                placeholder=\"Value\"\n                @input=\"updateFilter\">\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <!-- 数据预览 -->\n      <div class=\"mapping-section\">\n        <div class=\"section-header\">\n          <span class=\"section-title\">Data Preview</span>\n          <button \n            class=\"preview-toggle-btn\"\n            @click=\"togglePreview\">\n            {{ showPreview ? 'Hide' : 'Show' }}\n          </button>\n        </div>\n        <div v-if=\"showPreview\" class=\"data-preview\">\n          <div class=\"preview-stats\">\n            <span>{{ previewData.length }} rows</span>\n            <span>{{ Object.keys(previewData[0] || {}).length }} columns</span>\n          </div>\n          <div class=\"preview-table\">\n            <table>\n              <thead>\n                <tr>\n                  <th v-for=\"(value, key) in previewData[0]\" :key=\"key\">\n                    {{ key }}\n                  </th>\n                </tr>\n              </thead>\n              <tbody>\n                <tr v-for=\"(row, index) in previewData.slice(0, 5)\" :key=\"index\">\n                  <td v-for=\"(value, key) in row\" :key=\"key\">\n                    {{ value }}\n                  </td>\n                </tr>\n              </tbody>\n            </table>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script setup>\nimport { ref, computed, watch } from 'vue'\nimport { useChartMapping } from '../composables/useChartMapping'\nimport { useDataFiltering } from '../composables/useDataFiltering'\n\nconst props = defineProps({\n  selectedChartType: {\n    type: String,\n    default: 'line'\n  },\n  workspaceFiles: {\n    type: Array,\n    default: () => []\n  }\n})\n\nconst emit = defineEmits(['chart-updated', 'mapping-changed'])\n\n// 图表映射配置\nconst { \n  chartConfigs, \n  mappedData, \n  generateChartOption,\n  removeMapping,\n  addMapping\n} = useChartMapping(props.selectedChartType)\n\n// 数据过滤\nconst {\n  filterType,\n  rangeStart,\n  rangeEnd,\n  conditionColumn,\n  conditionOperator,\n  conditionValue,\n  filteredData,\n  updateFilter\n} = useDataFiltering()\n\n// 组件状态\nconst realTimeRender = ref(true)\nconst dragOverZone = ref(null)\nconst showPreview = ref(false)\n\n// 计算属性\nconst availableColumns = computed(() => {\n  const columns = []\n  props.workspaceFiles.forEach(file => {\n    if (file.columns) {\n      file.columns.forEach(col => {\n        columns.push({\n          id: `${file.id}_${col.name}`,\n          fileName: file.name,\n          columnName: col.name,\n          columnType: col.type,\n          fileId: file.id,\n          color: file.color || '#007acc'\n        })\n      })\n    }\n  })\n  return columns\n})\n\nconst previewData = computed(() => {\n  return filteredData.value.slice(0, 10)\n})\n\nconst canRender = computed(() => {\n  return Object.values(mappedData.value).some(arr => arr.length > 0)\n})\n\n// 拖拽处理\nfunction handleDrop(event, configKey) {\n  event.preventDefault()\n  const columnData = JSON.parse(event.dataTransfer.getData('text/plain'))\n  \n  addMapping(configKey, columnData)\n  dragOverZone.value = null\n  \n  if (realTimeRender.value) {\n    renderChart()\n  }\n}\n\nfunction handleDragOver(configKey) {\n  dragOverZone.value = configKey\n}\n\nfunction handleDragLeave() {\n  dragOverZone.value = null\n}\n\n// 渲染控制\nfunction toggleRealTimeRender() {\n  realTimeRender.value = !realTimeRender.value\n}\n\nfunction renderChart() {\n  if (!canRender.value) return\n  \n  const option = generateChartOption(filteredData.value)\n  emit('chart-updated', option)\n}\n\nfunction togglePreview() {\n  showPreview.value = !showPreview.value\n}\n\n// 监听变化\nwatch(\n  () => [mappedData.value, filteredData.value],\n  () => {\n    if (realTimeRender.value) {\n      renderChart()\n    }\n    emit('mapping-changed', {\n      mappedData: mappedData.value,\n      filteredData: filteredData.value\n    })\n  },\n  { deep: true }\n)\n\nwatch(\n  () => props.selectedChartType,\n  (newType) => {\n    // 重置映射数据\n    Object.keys(mappedData.value).forEach(key => {\n      mappedData.value[key] = []\n    })\n  }\n)\n</script>\n\n<style scoped>\n.data-mapping-panel {\n  padding: 20px;\n  background: var(--bg-color);\n  border-radius: 8px;\n  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);\n  max-height: 100vh;\n  overflow-y: auto;\n}\n\n.panel-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 20px;\n  padding-bottom: 12px;\n  border-bottom: 2px solid var(--border-color);\n}\n\n.panel-header h3 {\n  margin: 0;\n  color: var(--text-color);\n  font-size: 1.2rem;\n}\n\n.panel-controls {\n  display: flex;\n  gap: 8px;\n}\n\n.toggle-btn, .render-btn {\n  padding: 6px 12px;\n  border: 1px solid var(--border-color);\n  border-radius: 4px;\n  background: var(--bg-color);\n  color: var(--text-color);\n  cursor: pointer;\n  transition: all 0.2s;\n}\n\n.toggle-btn.active {\n  background: var(--primary-color);\n  color: white;\n}\n\n.render-btn:disabled {\n  opacity: 0.5;\n  cursor: not-allowed;\n}\n\n.mapping-sections {\n  display: flex;\n  flex-direction: column;\n  gap: 20px;\n}\n\n.mapping-section {\n  border: 1px solid var(--border-color);\n  border-radius: 6px;\n  padding: 12px;\n}\n\n.section-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin-bottom: 10px;\n}\n\n.section-title {\n  font-weight: 600;\n  color: var(--text-color);\n}\n\n.section-info {\n  color: var(--error-color);\n  font-weight: bold;\n}\n\n.drop-zone {\n  min-height: 80px;\n  border: 2px dashed var(--border-color);\n  border-radius: 4px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: all 0.3s;\n  position: relative;\n}\n\n.drop-zone.drag-over {\n  border-color: var(--primary-color);\n  background: rgba(0, 122, 204, 0.1);\n}\n\n.drop-zone.has-data {\n  border-style: solid;\n  min-height: auto;\n  padding: 8px;\n}\n\n.drop-placeholder {\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  gap: 8px;\n  color: var(--text-secondary);\n}\n\n.placeholder-icon {\n  font-size: 2rem;\n  opacity: 0.5;\n}\n\n.mapped-items {\n  display: flex;\n  flex-direction: column;\n  gap: 6px;\n  width: 100%;\n}\n\n.mapped-item {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  padding: 8px 10px;\n  border-radius: 4px;\n  color: white;\n  font-size: 0.9rem;\n}\n\n.item-info {\n  display: flex;\n  flex-direction: column;\n}\n\n.file-name {\n  font-size: 0.75rem;\n  opacity: 0.8;\n}\n\n.column-name {\n  font-weight: 600;\n}\n\n.remove-item-btn {\n  background: rgba(255, 255, 255, 0.2);\n  border: none;\n  color: white;\n  width: 20px;\n  height: 20px;\n  border-radius: 50%;\n  cursor: pointer;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  transition: background 0.2s;\n}\n\n.remove-item-btn:hover {\n  background: rgba(255, 255, 255, 0.3);\n}\n\n.filter-options {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.filter-type {\n  display: flex;\n  align-items: center;\n  gap: 8px;\n}\n\n.range-inputs, .condition-inputs {\n  display: flex;\n  align-items: center;\n  gap: 6px;\n  margin-left: 20px;\n}\n\n.range-inputs input, .condition-inputs input, .condition-inputs select {\n  padding: 4px 8px;\n  border: 1px solid var(--border-color);\n  border-radius: 3px;\n  background: var(--bg-color);\n  color: var(--text-color);\n}\n\n.data-preview {\n  margin-top: 10px;\n}\n\n.preview-stats {\n  display: flex;\n  gap: 16px;\n  margin-bottom: 8px;\n  font-size: 0.9rem;\n  color: var(--text-secondary);\n}\n\n.preview-table {\n  max-height: 200px;\n  overflow: auto;\n  border: 1px solid var(--border-color);\n  border-radius: 4px;\n}\n\n.preview-table table {\n  width: 100%;\n  border-collapse: collapse;\n}\n\n.preview-table th, .preview-table td {\n  padding: 6px 10px;\n  text-align: left;\n  border-bottom: 1px solid var(--border-color);\n  font-size: 0.85rem;\n}\n\n.preview-table th {\n  background: var(--bg-secondary);\n  font-weight: 600;\n  position: sticky;\n  top: 0;\n}\n\n.preview-toggle-btn {\n  background: transparent;\n  border: 1px solid var(--border-color);\n  color: var(--text-color);\n  padding: 4px 8px;\n  border-radius: 3px;\n  cursor: pointer;\n  font-size: 0.8rem;\n}\n\n.preview-toggle-btn:hover {\n  background: var(--bg-secondary);\n}\n\n@media (max-width: 768px) {\n  .data-mapping-panel {\n    padding: 12px;\n  }\n  \n  .panel-controls {\n    flex-direction: column;\n  }\n  \n  .range-inputs, .condition-inputs {\n    flex-wrap: wrap;\n  }\n}\n</style>\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiLA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,KAAK,QAAQ,KAAI;AACzC,SAASC,eAAe,QAAQ,gCAA+B;AAC/D,SAASC,gBAAgB,QAAQ,iCAAgC;;;;;;;;;;;;;;;;;IAEjE,MAAMC,KAAK,GAAGC,OAAA;IAWd,MAAMC,IAAI,GAAGC,MAAA;;IAEb;IACA,MAAM;MACJC,YAAY;MACZC,UAAU;MACVC,mBAAmB;MACnBC,aAAa;MACbC;IACF,CAAC,GAAGV,eAAe,CAACE,KAAK,CAACS,iBAAiB;;IAE3C;IACA,MAAM;MACJC,UAAU;MACVC,UAAU;MACVC,QAAQ;MACRC,eAAe;MACfC,iBAAiB;MACjBC,cAAc;MACdC,YAAY;MACZC;IACF,CAAC,GAAGlB,gBAAgB,CAAC;;IAErB;IACA,MAAMmB,cAAc,GAAGvB,GAAG,CAAC,IAAI;IAC/B,MAAMwB,YAAY,GAAGxB,GAAG,CAAC,IAAI;IAC7B,MAAMyB,WAAW,GAAGzB,GAAG,CAAC,KAAK;;IAE7B;IACA,MAAM0B,gBAAgB,GAAGzB,QAAQ,CAAC,MAAM;MACtC,MAAM0B,OAAO,GAAG,EAAC;MACjBtB,KAAK,CAACuB,cAAc,CAACC,OAAO,CAACC,IAAI,IAAI;QACnC,IAAIA,IAAI,CAACH,OAAO,EAAE;UAChBG,IAAI,CAACH,OAAO,CAACE,OAAO,CAACE,GAAG,IAAI;YAC1BJ,OAAO,CAACK,IAAI,CAAC;cACXC,EAAE,EAAE,GAAGH,IAAI,CAACG,EAAE,IAAIF,GAAG,CAACG,IAAI,EAAE;cAC5BC,QAAQ,EAAEL,IAAI,CAACI,IAAI;cACnBE,UAAU,EAAEL,GAAG,CAACG,IAAI;cACpBG,UAAU,EAAEN,GAAG,CAACO,IAAI;cACpBC,MAAM,EAAET,IAAI,CAACG,EAAE;cACfO,KAAK,EAAEV,IAAI,CAACU,KAAK,IAAI;YACvB,CAAC;UACH,CAAC;QACH;MACF,CAAC;MACD,OAAOb,OAAM;IACf,CAAC;IAED,MAAMc,WAAW,GAAGxC,QAAQ,CAAC,MAAM;MACjC,OAAOoB,YAAY,CAACqB,KAAK,CAACC,KAAK,CAAC,CAAC,EAAE,EAAE;IACvC,CAAC;IAED,MAAMC,SAAS,GAAG3C,QAAQ,CAAC,MAAM;MAC/B,OAAO4C,MAAM,CAACC,MAAM,CAACpC,UAAU,CAACgC,KAAK,CAAC,CAACK,IAAI,CAACC,GAAG,IAAIA,GAAG,CAACC,MAAM,GAAG,CAAC;IACnE,CAAC;;IAED;IACA,SAASC,UAAUA,CAACC,KAAK,EAAEC,SAAS,EAAE;MACpCD,KAAK,CAACE,cAAc,CAAC;MACrB,MAAMC,UAAU,GAAGC,IAAI,CAACC,KAAK,CAACL,KAAK,CAACM,YAAY,CAACC,OAAO,CAAC,YAAY,CAAC;MAEtE7C,UAAU,CAACuC,SAAS,EAAEE,UAAU;MAChC9B,YAAY,CAACkB,KAAK,GAAG,IAAG;MAExB,IAAInB,cAAc,CAACmB,KAAK,EAAE;QACxBiB,WAAW,CAAC;MACd;IACF;IAEA,SAASC,cAAcA,CAACR,SAAS,EAAE;MACjC5B,YAAY,CAACkB,KAAK,GAAGU,SAAQ;IAC/B;IAEA,SAASS,eAAeA,CAAA,EAAG;MACzBrC,YAAY,CAACkB,KAAK,GAAG,IAAG;IAC1B;;IAEA;IACA,SAASoB,oBAAoBA,CAAA,EAAG;MAC9BvC,cAAc,CAACmB,KAAK,GAAG,CAACnB,cAAc,CAACmB,KAAI;IAC7C;IAEA,SAASiB,WAAWA,CAAA,EAAG;MACrB,IAAI,CAACf,SAAS,CAACF,KAAK,EAAE;MAEtB,MAAMqB,MAAM,GAAGpD,mBAAmB,CAACU,YAAY,CAACqB,KAAK;MACrDnC,IAAI,CAAC,eAAe,EAAEwD,MAAM;IAC9B;IAEA,SAASC,aAAaA,CAAA,EAAG;MACvBvC,WAAW,CAACiB,KAAK,GAAG,CAACjB,WAAW,CAACiB,KAAI;IACvC;;IAEA;IACAxC,KAAK,CACH,MAAM,CAACQ,UAAU,CAACgC,KAAK,EAAErB,YAAY,CAACqB,KAAK,CAAC,EAC5C,MAAM;MACJ,IAAInB,cAAc,CAACmB,KAAK,EAAE;QACxBiB,WAAW,CAAC;MACd;MACApD,IAAI,CAAC,iBAAiB,EAAE;QACtBG,UAAU,EAAEA,UAAU,CAACgC,KAAK;QAC5BrB,YAAY,EAAEA,YAAY,CAACqB;MAC7B,CAAC;IACH,CAAC,EACD;MAAEuB,IAAI,EAAE;IAAK,CACf;IAEA/D,KAAK,CACH,MAAMG,KAAK,CAACS,iBAAiB,EAC5BoD,OAAO,IAAK;MACX;MACArB,MAAM,CAACsB,IAAI,CAACzD,UAAU,CAACgC,KAAK,CAAC,CAACb,OAAO,CAACuC,GAAG,IAAI;QAC3C1D,UAAU,CAACgC,KAAK,CAAC0B,GAAG,CAAC,GAAG,EAAC;MAC3B,CAAC;IACH,CACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}