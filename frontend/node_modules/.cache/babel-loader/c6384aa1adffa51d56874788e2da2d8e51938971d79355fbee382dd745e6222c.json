{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.filter.js\";\nimport \"core-js/modules/es.iterator.map.js\";\nimport \"core-js/modules/es.iterator.reduce.js\";\nimport \"core-js/modules/es.set.difference.v2.js\";\nimport \"core-js/modules/es.set.intersection.v2.js\";\nimport \"core-js/modules/es.set.is-disjoint-from.v2.js\";\nimport \"core-js/modules/es.set.is-subset-of.v2.js\";\nimport \"core-js/modules/es.set.is-superset-of.v2.js\";\nimport \"core-js/modules/es.set.symmetric-difference.v2.js\";\nimport \"core-js/modules/es.set.union.v2.js\";\nimport { ref, nextTick, onMounted, computed } from 'vue';\nimport DataPreviewModal from './DataPreviewModal.vue';\nimport { formatFileSize, getStatusText, getStatusIcon, isValidFileType } from '../utils/fileUtils.js';\nimport { UPLOAD_CONFIG } from '../constants/fileConstants.js';\nimport { uploadFile, deleteFile, renameFile, getFilePreview, getAllFiles, checkBackendConnection, syncFileToBackend } from '../services/FileServices.js';\nexport default {\n  __name: 'FileUploadModal',\n  props: {\n    show: Boolean\n  },\n  emits: ['close'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n\n    /* eslint-disable */\n    const props = __props;\n    const emit = __emit;\n    const isDragging = ref(false);\n    const files = ref([]);\n    const showPreview = ref(false);\n    const currentPreviewFile = ref(null);\n    const previewData = ref([]);\n    const isBackendConnected = ref(false);\n    const isLoading = ref(false);\n\n    // 计算统计信息\n    const stats = computed(() => {\n      const totalFiles = files.value.length;\n      const totalSize = files.value.reduce((sum, file) => sum + (file.size || 0), 0);\n      const notUploadedCount = files.value.filter(file => file.status === 'local').length;\n      const cachedCount = files.value.filter(file => file.status === 'cached').length;\n      return {\n        totalFiles,\n        totalSize: formatFileSize(totalSize),\n        notUploadedCount,\n        cachedCount\n      };\n    });\n\n    // 多选功能\n    const selectedFiles = ref([]);\n    const isSelectMode = ref(false);\n\n    // 计算选中的文件统计\n    const selectedStats = computed(() => {\n      const selectedList = files.value.filter(file => selectedFiles.value.includes(file.id));\n      const cachedCount = selectedList.filter(file => file.status === 'cached').length;\n      return {\n        count: selectedList.length,\n        cachedCount: cachedCount\n      };\n    });\n\n    // 页面加载时检查后端连接并加载文件\n    onMounted(async () => {\n      await checkConnectionStatus();\n      await loadFiles();\n    });\n\n    // 检查后端连接状态\n    async function checkConnectionStatus() {\n      isBackendConnected.value = await checkBackendConnection();\n    }\n\n    // 加载所有文件\n    async function loadFiles() {\n      isLoading.value = true;\n      try {\n        const allFiles = await getAllFiles();\n        files.value = allFiles.map(file => ({\n          ...file,\n          isEditing: false,\n          newName: file.name\n        }));\n\n        // 如果没有文件，添加一些示例数据用于测试\n        if (files.value.length === 0) {\n          files.value = [{\n            id: 1,\n            name: 'sample_data.csv',\n            size: 1024 * 50,\n            status: 'cached',\n            isEditing: false,\n            newName: 'sample_data.csv',\n            rows: 100,\n            columns: 5,\n            createdAt: new Date().toISOString()\n          }, {\n            id: 2,\n            name: 'test_file.xlsx',\n            size: 1024 * 200,\n            status: 'local',\n            isEditing: false,\n            newName: 'test_file.xlsx',\n            rows: 50,\n            columns: 8,\n            createdAt: new Date().toISOString()\n          }, {\n            id: 3,\n            name: 'report.xls',\n            size: 1024 * 150,\n            status: 'cached',\n            isEditing: false,\n            newName: 'report.xls',\n            rows: 200,\n            columns: 10,\n            createdAt: new Date().toISOString()\n          }];\n        }\n      } catch (error) {\n        console.error('加载文件列表失败:', error);\n        // 加载失败时也添加示例数据\n        files.value = [{\n          id: 1,\n          name: 'sample_data.csv',\n          size: 1024 * 50,\n          status: 'cached',\n          isEditing: false,\n          newName: 'sample_data.csv',\n          rows: 100,\n          columns: 5,\n          createdAt: new Date().toISOString()\n        }, {\n          id: 2,\n          name: 'test_file.xlsx',\n          size: 1024 * 200,\n          status: 'local',\n          isEditing: false,\n          newName: 'test_file.xlsx',\n          rows: 50,\n          columns: 8,\n          createdAt: new Date().toISOString()\n        }, {\n          id: 3,\n          name: 'report.xls',\n          size: 1024 * 150,\n          status: 'cached',\n          isEditing: false,\n          newName: 'report.xls',\n          rows: 200,\n          columns: 10,\n          createdAt: new Date().toISOString()\n        }];\n      } finally {\n        isLoading.value = false;\n      }\n    }\n\n    // 触发文件选择\n    function triggerFileInput() {\n      document.querySelector('.file-input').click();\n    }\n\n    // 处理文件选择\n    async function handleFileSelect(event) {\n      const newFiles = Array.from(event.target.files);\n      await processFiles(newFiles);\n    }\n\n    // 处理拖拽\n    async function handleDrop(event) {\n      isDragging.value = false;\n      const newFiles = Array.from(event.dataTransfer.files);\n      await processFiles(newFiles);\n    }\n\n    // 重命名相关\n    function startRename(idx) {\n      files.value[idx].isEditing = true;\n      files.value[idx].newName = files.value[idx].name;\n      nextTick(() => {\n        const inputs = document.querySelectorAll('.file-item input');\n        if (inputs[idx]) {\n          inputs[idx].focus();\n        }\n      });\n    }\n    async function finishRename(idx) {\n      const file = files.value[idx];\n      if (file.newName && file.newName !== file.name) {\n        try {\n          await renameFile(file.id, file.newName);\n          file.name = file.newName;\n        } catch (error) {\n          console.error('重命名失败:', error);\n          alert('重命名失败：' + error.message);\n          file.newName = file.name; // 恢复原名\n        }\n      }\n      file.isEditing = false;\n    }\n\n    // 删除文件\n    async function unloadFile(idx) {\n      const file = files.value[idx];\n      if (confirm(`确定要删除文件 \"${file.name}\" 吗？`)) {\n        try {\n          await deleteFile(file.id);\n          files.value.splice(idx, 1);\n        } catch (error) {\n          console.error('删除失败:', error);\n          alert('删除失败：' + error.message);\n        }\n      }\n    }\n\n    // 同步文件到后端\n    async function syncFile(idx) {\n      const file = files.value[idx];\n      try {\n        file.status = 'syncing';\n        const syncedFile = await syncFileToBackend(file.id);\n        files.value[idx] = {\n          ...syncedFile,\n          isEditing: false,\n          newName: syncedFile.name\n        };\n      } catch (error) {\n        console.error('同步失败:', error);\n        alert('同步失败：' + error.message);\n        file.status = 'local';\n      }\n    }\n\n    // 预览文件\n    async function previewFile(idx) {\n      const file = files.value[idx];\n      try {\n        const previewResult = await getFilePreview(file.id);\n        currentPreviewFile.value = file;\n        previewData.value = previewResult.data;\n        showPreview.value = true;\n      } catch (error) {\n        console.error('预览失败:', error);\n        alert('预览失败：' + error.message);\n      }\n    }\n    function closePreview() {\n      showPreview.value = false;\n      currentPreviewFile.value = null;\n      previewData.value = [];\n    }\n    function onClose() {\n      emit('close');\n    }\n\n    // 多选功能\n    function toggleSelectMode() {\n      isSelectMode.value = !isSelectMode.value;\n      if (!isSelectMode.value) {\n        selectedFiles.value = [];\n      }\n    }\n    function toggleFileSelection(fileId) {\n      const index = selectedFiles.value.indexOf(fileId);\n      if (index > -1) {\n        selectedFiles.value.splice(index, 1);\n      } else {\n        selectedFiles.value.push(fileId);\n      }\n    }\n    function selectAllFiles() {\n      selectedFiles.value = files.value.map(file => file.id);\n    }\n    function selectAllCachedFiles() {\n      const cachedFiles = files.value.filter(file => file.status === 'cached');\n      const cachedIds = cachedFiles.map(file => file.id);\n      // 合并现有选择和缓存文件ID，去重\n      selectedFiles.value = [...new Set([...selectedFiles.value, ...cachedIds])];\n    }\n    function clearSelection() {\n      selectedFiles.value = [];\n    }\n\n    // 批量清除缓存文件\n    async function clearSelectedCachedFiles() {\n      const selectedCachedFiles = files.value.filter(file => selectedFiles.value.includes(file.id) && file.status === 'cached');\n      if (selectedFiles.value.length === 0) {\n        alert('Please select files to clear first');\n        return;\n      }\n      if (selectedCachedFiles.length === 0) {\n        alert('No cached files in the selected files to clear');\n        return;\n      }\n      if (confirm(`Are you sure you want to clear ${selectedCachedFiles.length} cached files?`)) {\n        for (const file of selectedCachedFiles) {\n          try {\n            await deleteFile(file.id);\n            const index = files.value.findIndex(f => f.id === file.id);\n            if (index !== -1) {\n              files.value.splice(index, 1);\n            }\n            // 从选中列表中移除\n            const selectedIndex = selectedFiles.value.indexOf(file.id);\n            if (selectedIndex > -1) {\n              selectedFiles.value.splice(selectedIndex, 1);\n            }\n          } catch (error) {\n            console.error('Failed to clear cached file:', error);\n            alert(`Failed to clear file \"${file.name}\": ${error.message}`);\n          }\n        }\n\n        // Exit multi-select mode if no files are selected\n        if (selectedFiles.value.length === 0) {\n          isSelectMode.value = false;\n        }\n        alert(`Successfully cleared ${selectedCachedFiles.length} cached files`);\n      }\n    }\n    // 批量同步所有本地文件\n    async function syncAllFiles() {\n      const localFiles = files.value.filter(file => file.status === 'local');\n      if (localFiles.length === 0) {\n        alert('没有需要同步的文件');\n        return;\n      }\n      if (!isBackendConnected.value) {\n        alert('后端未连接，无法同步');\n        return;\n      }\n      if (confirm(`确定要同步 ${localFiles.length} 个文件到后端吗？`)) {\n        for (let i = 0; i < localFiles.length; i++) {\n          const fileIndex = files.value.findIndex(f => f.id === localFiles[i].id);\n          if (fileIndex !== -1) {\n            await syncFile(fileIndex);\n          }\n        }\n      }\n    }\n\n    // 刷新文件列表\n    async function refreshFiles() {\n      await checkConnectionStatus();\n      await loadFiles();\n    }\n\n    // 处理文件\n    async function processFiles(newFiles) {\n      const validFiles = newFiles.filter(file => isValidFileType(file.name));\n      if (validFiles.length !== newFiles.length) {\n        alert('只支持 CSV、XLSX、XLS 格式的文件');\n      }\n      for (const file of validFiles) {\n        try {\n          // 添加文件到列表（正在上传状态）\n          const fileItem = {\n            id: Date.now() + Math.random(),\n            name: file.name,\n            size: file.size,\n            status: 'uploading',\n            isEditing: false,\n            newName: file.name,\n            rows: 0,\n            columns: 0,\n            createdAt: new Date().toISOString()\n          };\n          files.value.push(fileItem);\n\n          // 调用智能上传 API\n          const uploadedFile = await uploadFile(file);\n\n          // 更新文件状态\n          const fileIndex = files.value.findIndex(f => f.id === fileItem.id);\n          if (fileIndex !== -1) {\n            files.value[fileIndex] = {\n              ...uploadedFile,\n              isEditing: false,\n              newName: uploadedFile.name\n            };\n          }\n        } catch (error) {\n          console.error('文件处理失败:', error);\n          // 更新失败状态\n          const index = files.value.findIndex(f => f.name === file.name);\n          if (index !== -1) {\n            files.value[index].status = 'error';\n          }\n        }\n      }\n    }\n    const __returned__ = {\n      props,\n      emit,\n      isDragging,\n      files,\n      showPreview,\n      currentPreviewFile,\n      previewData,\n      isBackendConnected,\n      isLoading,\n      stats,\n      selectedFiles,\n      isSelectMode,\n      selectedStats,\n      checkConnectionStatus,\n      loadFiles,\n      triggerFileInput,\n      handleFileSelect,\n      handleDrop,\n      startRename,\n      finishRename,\n      unloadFile,\n      syncFile,\n      previewFile,\n      closePreview,\n      onClose,\n      toggleSelectMode,\n      toggleFileSelection,\n      selectAllFiles,\n      selectAllCachedFiles,\n      clearSelection,\n      clearSelectedCachedFiles,\n      syncAllFiles,\n      refreshFiles,\n      processFiles,\n      ref,\n      nextTick,\n      onMounted,\n      computed,\n      DataPreviewModal,\n      get formatFileSize() {\n        return formatFileSize;\n      },\n      get getStatusText() {\n        return getStatusText;\n      },\n      get getStatusIcon() {\n        return getStatusIcon;\n      },\n      get isValidFileType() {\n        return isValidFileType;\n      },\n      get UPLOAD_CONFIG() {\n        return UPLOAD_CONFIG;\n      },\n      get uploadFile() {\n        return uploadFile;\n      },\n      get deleteFile() {\n        return deleteFile;\n      },\n      get renameFile() {\n        return renameFile;\n      },\n      get getFilePreview() {\n        return getFilePreview;\n      },\n      get getAllFiles() {\n        return getAllFiles;\n      },\n      get checkBackendConnection() {\n        return checkBackendConnection;\n      },\n      get syncFileToBackend() {\n        return syncFileToBackend;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","nextTick","onMounted","computed","DataPreviewModal","formatFileSize","getStatusText","getStatusIcon","isValidFileType","UPLOAD_CONFIG","uploadFile","deleteFile","renameFile","getFilePreview","getAllFiles","checkBackendConnection","syncFileToBackend","props","__props","emit","__emit","isDragging","files","showPreview","currentPreviewFile","previewData","isBackendConnected","isLoading","stats","totalFiles","value","length","totalSize","reduce","sum","file","size","notUploadedCount","filter","status","cachedCount","selectedFiles","isSelectMode","selectedStats","selectedList","includes","id","count","checkConnectionStatus","loadFiles","allFiles","map","isEditing","newName","name","rows","columns","createdAt","Date","toISOString","error","console","triggerFileInput","document","querySelector","click","handleFileSelect","event","newFiles","Array","from","target","processFiles","handleDrop","dataTransfer","startRename","idx","inputs","querySelectorAll","focus","finishRename","alert","message","unloadFile","confirm","splice","syncFile","syncedFile","previewFile","previewResult","data","closePreview","onClose","toggleSelectMode","toggleFileSelection","fileId","index","indexOf","push","selectAllFiles","selectAllCachedFiles","cachedFiles","cachedIds","Set","clearSelection","clearSelectedCachedFiles","selectedCachedFiles","findIndex","f","selectedIndex","syncAllFiles","localFiles","i","fileIndex","refreshFiles","validFiles","fileItem","now","Math","random","uploadedFile"],"sources":["D:/Learning Material/Git/Fuck-Charts/newArchitecture/frontend_vue_design/src/components/FileUploadModal.vue"],"sourcesContent":["<template>\n    <transition name=\"modal\" appear>\n        <div v-if=\"show\" class=\"file-modal\" @click.self=\"onClose\">\n            <div class=\"file-content\">\n                <div class=\"file-header\">\n                    <div class=\"header-left\">\n                        <span>File Manager</span>\n                        <div class=\"connection-status\">\n                            <span class=\"status-dot\" :class=\"{ 'connected': isBackendConnected }\"></span>\n                            <span class=\"status-text\">{{ isBackendConnected ? 'Connected' : 'Offline' }}</span>\n                        </div>\n                    </div>\n                <div class=\"header-right\">\n                    <button class=\"refresh-btn\" @click=\"refreshFiles\" title=\"刷新文件列表\">🔄</button>\n                    <button v-if=\"files.length > 0\"\n                            class=\"select-btn\"\n                            @click=\"toggleSelectMode\"\n                            :class=\"{ 'active': isSelectMode }\"\n                            title=\"多选模式\">\n                        {{ isSelectMode ? 'Cancel' : 'Multi-Select' }}\n                    </button>\n                    <button v-if=\"isSelectMode\"\n                            class=\"clear-selected-btn\"\n                            @click=\"clearSelectedCachedFiles\"\n                            :disabled=\"selectedStats.cachedCount === 0\"\n                            title=\"Clear selected cached files\">\n                        Clear Selected ({{ selectedStats.cachedCount }})\n                    </button>\n                    <button v-if=\"stats.notUploadedCount > 0\"\n                            class=\"sync-all-btn\"\n                            @click=\"syncAllFiles\"\n                            :disabled=\"!isBackendConnected\"\n                            title=\"Sync all files to backend\">\n                        Sync All ({{ stats.notUploadedCount }})\n                    </button>\n                    <button class=\"close-btn\" @click=\"onClose\">×</button>\n                </div>\n            </div>\n\n            <!-- 主要内容区域 -->\n            <div class=\"main-content\">\n                <!-- 左侧：拖拽上传区域 -->\n                <div class=\"upload-section\">\n                    <div class=\"upload-area\"\n                            :class=\"{ 'dragging': isDragging }\"\n                            @drop.prevent=\"handleDrop\"\n                            @dragover.prevent=\"isDragging = true\"\n                            @dragleave.prevent=\"isDragging = false\">\n                        <input type=\"file\"\n                                ref=\"fileInput\"\n                                @change=\"handleFileSelect\"\n                                :accept=\"UPLOAD_CONFIG.acceptString\"\n                                multiple\n                                class=\"file-input\" />\n                        <div class=\"upload-tip\">\n                            <i class=\"upload-icon\">📁</i>\n                            <p>Drag files here or <button @click=\"triggerFileInput\">click to select</button></p>\n                            <p class=\"sub-tip\">Supports CSV、XLSX、XLS formats</p>\n                        </div>\n                    </div>\n                </div>\n\n                <!-- 右侧：文件列表 -->\n                <div class=\"file-section\">\n                    <!-- 统计信息 -->\n                    <div class=\"stats-bar\" v-if=\"files.length\">\n                        <div class=\"stat-item\">\n                            <span class=\"stat-label\">总文件数:</span>\n                            <span class=\"stat-value\">{{ stats.totalFiles }}</span>\n                        </div>\n                        <div class=\"stat-item\">\n                            <span class=\"stat-label\">总大小:</span>\n                            <span class=\"stat-value\">{{ stats.totalSize }}</span>\n                        </div>\n                        <div class=\"stat-item\" v-if=\"stats.cachedCount > 0\">\n                            <span class=\"stat-label\">缓存文件:</span>\n                            <span class=\"stat-value\">{{ stats.cachedCount }}</span>\n                        </div>\n                        <div class=\"stat-item\" v-if=\"isSelectMode\">\n                            <span class=\"stat-label\">Selected:</span>\n                            <span class=\"stat-value\">{{ selectedStats.count }}</span>\n                        </div>\n                        <div class=\"stat-item batch-actions\" v-if=\"isSelectMode && files.length > 0\">\n                            <div class=\"action-group single-row\">\n                                <button class=\"select-all-btn\" @click=\"selectAllFiles\">Select All</button>\n                                <button class=\"select-cached-btn\"\n                                        @click=\"selectAllCachedFiles\"\n                                        v-if=\"stats.cachedCount > 0\">\n                                    Select Cached\n                                </button>\n                                <button class=\"clear-selection-btn\" @click=\"clearSelection\">Clear Selection</button>\n                                <button class=\"batch-clear-btn\"\n                                        @click=\"clearSelectedCachedFiles\"\n                                        :disabled=\"selectedStats.cachedCount === 0\"\n                                        title=\"Clear selected cached files\">\n                                    Clear Cached ({{ selectedStats.cachedCount }})\n                                </button>\n                            </div>\n                        </div>\n                    </div>\n\n                    <!-- 文件列表 -->\n                    <div class=\"file-list\" v-if=\"files.length\">\n                        <transition-group name=\"file-list\" tag=\"div\">\n                            <div v-for=\"(file, idx) in files\"\n                                    :key=\"file.id\"\n                                    class=\"file-item\"\n                                    :class=\"{ 'selected': selectedFiles.includes(file.id), 'select-mode': isSelectMode }\">\n                                <div class=\"file-checkbox\" v-if=\"isSelectMode\">\n                                    <input type=\"checkbox\"\n                                           :id=\"`file-${file.id}`\"\n                                           :checked=\"selectedFiles.includes(file.id)\"\n                                           @change=\"toggleFileSelection(file.id)\">\n                                    <label :for=\"`file-${file.id}`\"></label>\n                                </div>\n                                <div class=\"file-info\">\n                                    <div class=\"file-basic\">\n                                        <div class=\"file-name-section\">\n                                            <span class=\"file-name\"\n                                                    :class=\"{ 'editing': file.isEditing }\"\n                                                    @dblclick=\"startRename(idx)\">\n                                                <template v-if=\"!file.isEditing\">\n                                                    {{ file.name }}\n                                                </template>\n                                                <input v-else\n                                                        v-model=\"file.newName\"\n                                                        @blur=\"finishRename(idx)\"\n                                                        @keyup.enter=\"finishRename(idx)\"\n                                                        ref=\"renameInput\"\n                                                        type=\"text\" />\n                                            </span>\n                                            <span class=\"file-status\" :class=\"file.status\">\n                                                {{ getStatusIcon(file.status) }} {{ getStatusText(file.status) }}\n                                            </span>\n                                        </div>\n                                        <div class=\"file-details\">\n                                            <span class=\"file-size\">{{ formatFileSize(file.size) }}</span>\n                                            <span class=\"file-type\">{{ file.name.split('.').pop().toUpperCase() }}</span>\n                                            <span class=\"file-dimensions\" v-if=\"file.rows && file.columns\">\n                                                {{ file.rows }} x {{ file.columns }}\n                                            </span>\n                                            <span class=\"file-created\">\n                                                {{ new Date(file.createdAt).toLocaleString() }}\n                                            </span>\n                                        </div>\n                                    </div>\n                                </div>\n                                <div class=\"file-actions\">\n                                    <button @click=\"previewFile(idx)\"\n                                            title=\"预览数据\"\n                                            class=\"action-btn preview-btn\">\n                                        👁️\n                                    </button>\n                                    <button v-if=\"file.status === 'local'\"\n                                            @click=\"syncFile(idx)\"\n                                            title=\"同步到后端\"\n                                            class=\"action-btn sync-btn\"\n                                            :disabled=\"!isBackendConnected\">\n                                        ⬆️\n                                    </button>\n                                    <button @click=\"unloadFile(idx)\"\n                                            title=\"删除文件\"\n                                            class=\"action-btn delete-btn\">\n                                        🗑️\n                                    </button>\n                                </div>\n                            </div>\n                        </transition-group>\n                    </div>\n                    <div v-else-if=\"!isLoading\" class=\"no-files\">\n                        <p>暂无文件，请在左侧上传文件</p>\n                    </div>\n                    <div v-else class=\"loading\">\n                        <p>加载中...</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- 数据预览组件 -->\n        <DataPreviewModal\n            v-if=\"currentPreviewFile\"\n            :show=\"showPreview\"\n            :current-file=\"currentPreviewFile\"\n            :preview-data=\"previewData\"\n            @close=\"closePreview\"\n        />\n    </div>\n</transition>\n</template>\n\n<script setup>\n/* eslint-disable */\nimport { ref, nextTick, onMounted, computed } from 'vue'\nimport DataPreviewModal from './DataPreviewModal.vue'\nimport { formatFileSize, getStatusText, getStatusIcon, isValidFileType } from '../utils/fileUtils.js'\nimport { UPLOAD_CONFIG } from '../constants/fileConstants.js'\nimport { \n    uploadFile, \n    deleteFile, \n    renameFile, \n    getFilePreview,\n    getAllFiles,\n    checkBackendConnection,\n    syncFileToBackend\n} from '../services/FileServices.js'\n\nconst props = defineProps({\n    show: Boolean\n})\n\nconst emit = defineEmits(['close'])\n\nconst isDragging = ref(false)\nconst files = ref([])\nconst showPreview = ref(false)\nconst currentPreviewFile = ref(null)\nconst previewData = ref([])\nconst isBackendConnected = ref(false)\nconst isLoading = ref(false)\n\n// 计算统计信息\nconst stats = computed(() => {\n    const totalFiles = files.value.length\n    const totalSize = files.value.reduce((sum, file) => sum + (file.size || 0), 0)\n    const notUploadedCount = files.value.filter(file => file.status === 'local').length\n    const cachedCount = files.value.filter(file => file.status === 'cached').length\n    \n    return {\n        totalFiles,\n        totalSize: formatFileSize(totalSize),\n        notUploadedCount,\n        cachedCount\n    }\n})\n\n// 多选功能\nconst selectedFiles = ref([])\nconst isSelectMode = ref(false)\n\n// 计算选中的文件统计\nconst selectedStats = computed(() => {\n    const selectedList = files.value.filter(file => selectedFiles.value.includes(file.id))\n    const cachedCount = selectedList.filter(file => file.status === 'cached').length\n    return {\n        count: selectedList.length,\n        cachedCount: cachedCount\n    }\n})\n\n// 页面加载时检查后端连接并加载文件\nonMounted(async () => {\n    await checkConnectionStatus()\n    await loadFiles()\n})\n\n// 检查后端连接状态\nasync function checkConnectionStatus() {\n    isBackendConnected.value = await checkBackendConnection()\n}\n\n// 加载所有文件\nasync function loadFiles() {\n    isLoading.value = true\n    try {\n        const allFiles = await getAllFiles()\n        files.value = allFiles.map(file => ({\n            ...file,\n            isEditing: false,\n            newName: file.name\n        }))\n        \n        // 如果没有文件，添加一些示例数据用于测试\n        if (files.value.length === 0) {\n            files.value = [\n                {\n                    id: 1,\n                    name: 'sample_data.csv',\n                    size: 1024 * 50,\n                    status: 'cached',\n                    isEditing: false,\n                    newName: 'sample_data.csv',\n                    rows: 100,\n                    columns: 5,\n                    createdAt: new Date().toISOString()\n                },\n                {\n                    id: 2,\n                    name: 'test_file.xlsx',\n                    size: 1024 * 200,\n                    status: 'local',\n                    isEditing: false,\n                    newName: 'test_file.xlsx',\n                    rows: 50,\n                    columns: 8,\n                    createdAt: new Date().toISOString()\n                },\n                {\n                    id: 3,\n                    name: 'report.xls',\n                    size: 1024 * 150,\n                    status: 'cached',\n                    isEditing: false,\n                    newName: 'report.xls',\n                    rows: 200,\n                    columns: 10,\n                    createdAt: new Date().toISOString()\n                }\n            ]\n        }\n    } catch (error) {\n        console.error('加载文件列表失败:', error)\n        // 加载失败时也添加示例数据\n        files.value = [\n            {\n                id: 1,\n                name: 'sample_data.csv',\n                size: 1024 * 50,\n                status: 'cached',\n                isEditing: false,\n                newName: 'sample_data.csv',\n                rows: 100,\n                columns: 5,\n                createdAt: new Date().toISOString()\n            },\n            {\n                id: 2,\n                name: 'test_file.xlsx',\n                size: 1024 * 200,\n                status: 'local',\n                isEditing: false,\n                newName: 'test_file.xlsx',\n                rows: 50,\n                columns: 8,\n                createdAt: new Date().toISOString()\n            },\n            {\n                id: 3,\n                name: 'report.xls',\n                size: 1024 * 150,\n                status: 'cached',\n                isEditing: false,\n                newName: 'report.xls',\n                rows: 200,\n                columns: 10,\n                createdAt: new Date().toISOString()\n            }\n        ]\n    } finally {\n        isLoading.value = false\n    }\n}\n\n// 触发文件选择\nfunction triggerFileInput() {\n    document.querySelector('.file-input').click()\n}\n\n// 处理文件选择\nasync function handleFileSelect(event) {\n    const newFiles = Array.from(event.target.files)\n    await processFiles(newFiles)\n}\n\n// 处理拖拽\nasync function handleDrop(event) {\n    isDragging.value = false\n    const newFiles = Array.from(event.dataTransfer.files)\n    await processFiles(newFiles)\n}\n\n// 重命名相关\nfunction startRename(idx) {\n    files.value[idx].isEditing = true\n    files.value[idx].newName = files.value[idx].name\n    nextTick(() => {\n        const inputs = document.querySelectorAll('.file-item input')\n        if (inputs[idx]) {\n            inputs[idx].focus()\n        }\n    })\n}\n\nasync function finishRename(idx) {\n    const file = files.value[idx]\n    if (file.newName && file.newName !== file.name) {\n        try {\n            await renameFile(file.id, file.newName)\n            file.name = file.newName\n        } catch (error) {\n            console.error('重命名失败:', error)\n            alert('重命名失败：' + error.message)\n            file.newName = file.name // 恢复原名\n        }\n    }\n    file.isEditing = false\n}\n\n// 删除文件\nasync function unloadFile(idx) {\n    const file = files.value[idx]\n    if (confirm(`确定要删除文件 \"${file.name}\" 吗？`)) {\n        try {\n            await deleteFile(file.id)\n            files.value.splice(idx, 1)\n        } catch (error) {\n            console.error('删除失败:', error)\n            alert('删除失败：' + error.message)\n        }\n    }\n}\n\n// 同步文件到后端\nasync function syncFile(idx) {\n    const file = files.value[idx]\n    try {\n        file.status = 'syncing'\n        \n        const syncedFile = await syncFileToBackend(file.id)\n        files.value[idx] = {\n            ...syncedFile,\n            isEditing: false,\n            newName: syncedFile.name\n        }\n    } catch (error) {\n        console.error('同步失败:', error)\n        alert('同步失败：' + error.message)\n        file.status = 'local'\n    }\n}\n\n// 预览文件\nasync function previewFile(idx) {\n    const file = files.value[idx]\n    try {\n        const previewResult = await getFilePreview(file.id)\n        currentPreviewFile.value = file\n        previewData.value = previewResult.data\n        showPreview.value = true\n    } catch (error) {\n        console.error('预览失败:', error)\n        alert('预览失败：' + error.message)\n    }\n}\n\nfunction closePreview() {\n    showPreview.value = false\n    currentPreviewFile.value = null\n    previewData.value = []\n}\n\nfunction onClose() {\n    emit('close')\n}\n\n// 多选功能\nfunction toggleSelectMode() {\n    isSelectMode.value = !isSelectMode.value\n    if (!isSelectMode.value) {\n        selectedFiles.value = []\n    }\n}\n\nfunction toggleFileSelection(fileId) {\n    const index = selectedFiles.value.indexOf(fileId)\n    if (index > -1) {\n        selectedFiles.value.splice(index, 1)\n    } else {\n        selectedFiles.value.push(fileId)\n    }\n}\n\nfunction selectAllFiles() {\n    selectedFiles.value = files.value.map(file => file.id)\n}\n\nfunction selectAllCachedFiles() {\n    const cachedFiles = files.value.filter(file => file.status === 'cached')\n    const cachedIds = cachedFiles.map(file => file.id)\n    // 合并现有选择和缓存文件ID，去重\n    selectedFiles.value = [...new Set([...selectedFiles.value, ...cachedIds])]\n}\n\nfunction clearSelection() {\n    selectedFiles.value = []\n}\n\n// 批量清除缓存文件\nasync function clearSelectedCachedFiles() {\n    const selectedCachedFiles = files.value.filter(file => \n        selectedFiles.value.includes(file.id) && file.status === 'cached'\n    )\n    \n    if (selectedFiles.value.length === 0) {\n        alert('Please select files to clear first')\n        return\n    }\n    \n    if (selectedCachedFiles.length === 0) {\n        alert('No cached files in the selected files to clear')\n        return\n    }\n    \n    if (confirm(`Are you sure you want to clear ${selectedCachedFiles.length} cached files?`)) {\n        for (const file of selectedCachedFiles) {\n            try {\n                await deleteFile(file.id)\n                const index = files.value.findIndex(f => f.id === file.id)\n                if (index !== -1) {\n                    files.value.splice(index, 1)\n                }\n                // 从选中列表中移除\n                const selectedIndex = selectedFiles.value.indexOf(file.id)\n                if (selectedIndex > -1) {\n                    selectedFiles.value.splice(selectedIndex, 1)\n                }\n            } catch (error) {\n                console.error('Failed to clear cached file:', error)\n                alert(`Failed to clear file \"${file.name}\": ${error.message}`)\n            }\n        }\n        \n        // Exit multi-select mode if no files are selected\n        if (selectedFiles.value.length === 0) {\n            isSelectMode.value = false\n        }\n        \n        alert(`Successfully cleared ${selectedCachedFiles.length} cached files`)\n    }\n}\n// 批量同步所有本地文件\nasync function syncAllFiles() {\n    const localFiles = files.value.filter(file => file.status === 'local')\n    \n    if (localFiles.length === 0) {\n        alert('没有需要同步的文件')\n        return\n    }\n    \n    if (!isBackendConnected.value) {\n        alert('后端未连接，无法同步')\n        return\n    }\n    \n    if (confirm(`确定要同步 ${localFiles.length} 个文件到后端吗？`)) {\n        for (let i = 0; i < localFiles.length; i++) {\n            const fileIndex = files.value.findIndex(f => f.id === localFiles[i].id)\n            if (fileIndex !== -1) {\n                await syncFile(fileIndex)\n            }\n        }\n    }\n}\n\n// 刷新文件列表\nasync function refreshFiles() {\n    await checkConnectionStatus()\n    await loadFiles()\n}\n\n// 处理文件\nasync function processFiles(newFiles) {\n    const validFiles = newFiles.filter(file => isValidFileType(file.name))\n\n    if (validFiles.length !== newFiles.length) {\n        alert('只支持 CSV、XLSX、XLS 格式的文件')\n    }\n\n    for (const file of validFiles) {\n        try {\n            // 添加文件到列表（正在上传状态）\n            const fileItem = {\n                id: Date.now() + Math.random(),\n                name: file.name,\n                size: file.size,\n                status: 'uploading',\n                isEditing: false,\n                newName: file.name,\n                rows: 0,\n                columns: 0,\n                createdAt: new Date().toISOString()\n            }\n            files.value.push(fileItem)\n            \n            // 调用智能上传 API\n            const uploadedFile = await uploadFile(file)\n            \n            // 更新文件状态\n            const fileIndex = files.value.findIndex(f => f.id === fileItem.id)\n            if (fileIndex !== -1) {\n                files.value[fileIndex] = {\n                    ...uploadedFile,\n                    isEditing: false,\n                    newName: uploadedFile.name\n                }\n            }\n        } catch (error) {\n            console.error('文件处理失败:', error)\n            // 更新失败状态\n            const index = files.value.findIndex(f => f.name === file.name)\n            if (index !== -1) {\n                files.value[index].status = 'error'\n            }\n        }\n    }\n}\n</script>\n\n<style scoped>\n/* 模态框基础样式 */\n.file-modal {\n    position: fixed;\n    top: 0; left: 0; right: 0; bottom: 0;\n    background: rgba(0,0,0,0.5);\n    z-index: 9999;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    backdrop-filter: blur(3px);\n}\n\n/* 模态框动画 */\n.modal-enter-active {\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.modal-leave-active {\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.modal-enter-from {\n    opacity: 0;\n    backdrop-filter: blur(0px);\n}\n\n.modal-leave-to {\n    opacity: 0;\n    backdrop-filter: blur(0px);\n}\n\n.modal-enter-from .file-content {\n    transform: scale(0.8) translateY(-50px);\n    opacity: 0;\n}\n\n.modal-leave-to .file-content {\n    transform: scale(0.9) translateY(20px);\n    opacity: 0;\n}\n\n.file-content {\n    background: var(--bg-color, #fff);\n    box-shadow: 0 20px 60px rgba(0,0,0,0.25);\n    overflow: hidden;\n    display: flex;\n    flex-direction: column;\n    border: 1px solid rgba(255, 255, 255, 0.1);\n    width: min(90vw, 900px);\n    height: min(90vh, 800px);\n    max-height: min(90vh, 800px);\n    border-radius: 16px;\n    position: relative;\n    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n/* 文件内容动画 */\n.file-content > * {\n    animation: fadeInSlide 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.file-content > .file-header {\n    animation-delay: 0.1s;\n}\n\n.file-content > .main-content {\n    animation-delay: 0.2s;\n}\n\n@keyframes fadeInSlide {\n    from {\n        transform: translateY(20px);\n        opacity: 0;\n    }\n    to {\n        transform: translateY(0);\n        opacity: 1;\n    }\n}\n\n/* 头部样式 */\n.file-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 24px;\n    border-bottom: 1px solid #e5e7eb;\n    background: linear-gradient(135deg, #f8f9fa 0%, #f1f5f9 100%);\n    position: relative;\n}\n\n.file-header::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    height: 3px;\n    background: linear-gradient(90deg, #3b82f6, #8b5cf6, #06b6d4);\n    border-radius: 16px 16px 0 0;\n}\n\n.header-left {\n    display: flex;\n    align-items: center;\n    gap: 15px;\n}\n\n.header-left span {\n    font-size: 20px;\n    font-weight: 600;\n    color: #333;\n}\n\n.connection-status {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    font-size: 14px;\n}\n\n.status-dot {\n    width: 8px;\n    height: 8px;\n    border-radius: 50%;\n    background: #9ca3af;\n    transition: background-color 0.3s;\n}\n\n.status-dot.connected {\n    background: #22c55e;\n}\n\n.status-text {\n    color: #666;\n    font-weight: 500;\n}\n\n.header-right {\n    display: flex;\n    align-items: center;\n    gap: 10px;\n    animation: fadeInButtons 0.6s cubic-bezier(0.4, 0, 0.2, 1) 0.3s both;\n}\n\n@keyframes fadeInButtons {\n    from {\n        transform: translateY(-20px);\n        opacity: 0;\n    }\n    to {\n        transform: translateY(0);\n        opacity: 1;\n    }\n}\n\n.refresh-btn, .sync-all-btn, .select-btn, .clear-selected-btn {\n    padding: 8px 16px;\n    border: none;\n    border-radius: 8px;\n    cursor: pointer;\n    font-size: 14px;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    font-weight: 500;\n    transform: translateY(0);\n}\n\n.refresh-btn {\n    background: #3b82f6;\n    color: white;\n}\n\n.refresh-btn:hover {\n    background: #2563eb;\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4);\n}\n\n.select-btn {\n    background: #8b5cf6;\n    color: white;\n    animation: buttonSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n@keyframes buttonSlideIn {\n    from {\n        transform: scale(0.8) translateX(-20px);\n        opacity: 0;\n    }\n    to {\n        transform: scale(1) translateX(0);\n        opacity: 1;\n    }\n}\n\n.select-btn:hover {\n    background: #7c3aed;\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(139, 92, 246, 0.4);\n}\n\n.select-btn.active {\n    background: #dc2626;\n    animation: buttonPulse 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n@keyframes buttonPulse {\n    0% {\n        transform: scale(1);\n    }\n    50% {\n        transform: scale(1.05);\n    }\n    100% {\n        transform: scale(1);\n    }\n}\n\n.select-btn.active:hover {\n    background: #b91c1c;\n}\n\n.clear-selected-btn {\n    background: #f59e0b;\n    color: white;\n    animation: buttonSlideIn 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.clear-selected-btn:hover:not(:disabled) {\n    background: #d97706;\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(245, 158, 11, 0.4);\n}\n\n.clear-selected-btn:disabled {\n    background: #d1d5db;\n    color: #9ca3af;\n    cursor: not-allowed;\n    transform: none;\n}\n\n.sync-all-btn {\n    background: #10b981;\n    color: white;\n}\n\n.sync-all-btn:hover:not(:disabled) {\n    background: #059669;\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(16, 185, 129, 0.4);\n}\n\n.sync-all-btn:disabled {\n    background: #d1d5db;\n    cursor: not-allowed;\n    transform: none;\n}\n\n.close-btn {\n    background: none;\n    border: none;\n    font-size: 28px;\n    cursor: pointer;\n    color: #6b7280;\n    padding: 8px;\n    border-radius: 8px;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    line-height: 1;\n}\n\n.close-btn:hover {\n    color: #ef4444;\n    background: rgba(239, 68, 68, 0.1);\n    transform: scale(1.1);\n}\n\n/* 主要内容区域 */\n.main-content {\n    display: flex;\n    flex: 1;\n    overflow: hidden;\n}\n\n/* 左侧上传区域 */\n.upload-section {\n    width: 300px;\n    padding: 20px;\n    border-right: 1px solid #e5e7eb;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    animation: slideInLeft 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n@keyframes slideInLeft {\n    from {\n        transform: translateX(-50px);\n        opacity: 0;\n    }\n    to {\n        transform: translateX(0);\n        opacity: 1;\n    }\n}\n\n/* 右侧文件列表区域 */\n.file-section {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n    overflow: hidden;\n    animation: slideInRight 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n@keyframes slideInRight {\n    from {\n        transform: translateX(30px);\n        opacity: 0;\n    }\n    to {\n        transform: translateX(0);\n        opacity: 1;\n    }\n}\n\n/* 上传区域样式 */\n.upload-area {\n    width: 100%;\n    border: 2px dashed #d1d5db;\n    border-radius: 12px;\n    padding: 30px 20px;\n    text-align: center;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n}\n\n.upload-area::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: -100%;\n    width: 100%;\n    height: 100%;\n    background: linear-gradient(90deg, transparent, rgba(59, 130, 246, 0.1), transparent);\n    transition: left 0.5s;\n}\n\n.upload-area:hover::before {\n    left: 100%;\n}\n\n.upload-area:hover,\n.upload-area.dragging {\n    border-color: #3b82f6;\n    background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);\n    transform: translateY(-2px);\n    box-shadow: 0 8px 25px rgba(59, 130, 246, 0.15);\n}\n\n.file-input {\n    display: none;\n}\n\n.upload-tip {\n    color: #666;\n}\n\n.upload-icon {\n    font-size: 48px;\n    margin-bottom: 16px;\n    display: block;\n    animation: bounceIcon 2s ease-in-out infinite;\n}\n\n@keyframes bounceIcon {\n    0%, 20%, 50%, 80%, 100% {\n        transform: translateY(0);\n    }\n    40% {\n        transform: translateY(-8px);\n    }\n    60% {\n        transform: translateY(-4px);\n    }\n}\n\n.upload-tip p {\n    margin: 8px 0;\n}\n\n.upload-tip button {\n    background: none;\n    border: none;\n    color: #3b82f6;\n    cursor: pointer;\n    text-decoration: underline;\n    font-size: inherit;\n}\n\n.sub-tip {\n    font-size: 12px;\n    color: #999;\n}\n\n/* 统计信息样式 */\n.stats-bar {\n    display: flex;\n    gap: 20px;\n    padding: 16px 20px;\n    background: linear-gradient(135deg, #f8f9fa 0%, #f1f5f9 100%);\n    border-bottom: 1px solid #e5e7eb;\n    flex-shrink: 0;\n    animation: slideInDown 0.4s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n@keyframes slideInDown {\n    from {\n        transform: translateY(-20px);\n        opacity: 0;\n    }\n    to {\n        transform: translateY(0);\n        opacity: 1;\n    }\n}\n\n.stat-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    animation: fadeInUp 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n@keyframes fadeInUp {\n    from {\n        transform: translateY(10px);\n        opacity: 0;\n    }\n    to {\n        transform: translateY(0);\n        opacity: 1;\n    }\n}\n\n/* 文件列表样式 */\n.file-list {\n    flex: 1;\n    overflow-y: auto;\n    padding: 0;\n}\n\n.no-files, .loading {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    height: 100%;\n    color: #666;\n    font-size: 14px;\n}\n\n.stat-item {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n}\n\n.stat-label {\n    font-size: 14px;\n    color: #666;\n}\n\n.stat-value {\n    font-size: 14px;\n    font-weight: 600;\n    color: #333;\n}\n\n.batch-actions {\n    flex-direction: column;\n    gap: 8px;\n    align-items: flex-start;\n}\n\n.action-group {\n    display: flex;\n    gap: 8px;\n    flex-wrap: wrap;\n}\n\n.action-group.single-row {\n    flex-wrap: nowrap;\n    overflow-x: auto;\n    scrollbar-width: none;\n    -ms-overflow-style: none;\n}\n\n.action-group.single-row::-webkit-scrollbar {\n    display: none;\n}\n\n.select-all-btn, .clear-selection-btn, .batch-clear-btn, .select-cached-btn {\n    padding: 4px 12px;\n    border: none;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 12px;\n    font-weight: 500;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    margin-left: 8px;\n}\n\n.select-all-btn {\n    background: #3b82f6;\n    color: white;\n}\n\n.select-all-btn:hover {\n    background: #2563eb;\n    transform: translateY(-1px);\n}\n\n.select-cached-btn {\n    background: #f59e0b;\n    color: white;\n}\n\n.select-cached-btn:hover {\n    background: #d97706;\n    transform: translateY(-1px);\n}\n\n.clear-selection-btn {\n    background: #6b7280;\n    color: white;\n}\n\n.clear-selection-btn:hover {\n    background: #4b5563;\n    transform: translateY(-1px);\n}\n\n.batch-clear-btn {\n    background: #ef4444;\n    color: white;\n}\n\n.batch-clear-btn:hover:not(:disabled) {\n    background: #dc2626;\n    transform: translateY(-1px);\n    box-shadow: 0 2px 8px rgba(239, 68, 68, 0.4);\n}\n\n.batch-clear-btn:disabled {\n    background: #d1d5db;\n    color: #9ca3af;\n    cursor: not-allowed;\n    transform: none;\n}\n\n.file-item {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    padding: 16px 20px;\n    border-bottom: 1px solid #e5e7eb;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    position: relative;\n}\n\n.file-item:hover {\n    background: #f8f9fa;\n    transform: translateX(4px);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);\n}\n\n.file-item.selected {\n    background: linear-gradient(135deg, #e0f2fe 0%, #f0f9ff 100%);\n    border-left: 4px solid #3b82f6;\n    transform: translateX(4px);\n}\n\n.file-item.select-mode {\n    padding-left: 56px;\n}\n\n.file-item:last-child {\n    border-bottom: none;\n}\n\n/* 文件列表动画 */\n.file-list-enter-active {\n    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.file-list-leave-active {\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.file-list-enter-from {\n    opacity: 0;\n    transform: translateX(-30px) scale(0.95);\n}\n\n.file-list-leave-to {\n    opacity: 0;\n    transform: translateX(30px) scale(0.95);\n}\n\n.file-list-move {\n    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n/* 文件项初始动画 */\n.file-item {\n    animation: fileItemFadeIn 0.6s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.file-item:nth-child(1) { animation-delay: 0.1s; }\n.file-item:nth-child(2) { animation-delay: 0.2s; }\n.file-item:nth-child(3) { animation-delay: 0.3s; }\n.file-item:nth-child(4) { animation-delay: 0.4s; }\n.file-item:nth-child(5) { animation-delay: 0.5s; }\n.file-item:nth-child(n+6) { animation-delay: 0.6s; }\n\n@keyframes fileItemFadeIn {\n    from {\n        transform: translateY(20px);\n        opacity: 0;\n    }\n    to {\n        transform: translateY(0);\n        opacity: 1;\n    }\n}\n\n/* 复选框样式 */\n.file-checkbox {\n    position: absolute;\n    left: 20px;\n    top: 50%;\n    transform: translateY(-50%);\n}\n\n.file-checkbox input[type=\"checkbox\"] {\n    display: none;\n}\n\n.file-checkbox label {\n    display: block;\n    width: 20px;\n    height: 20px;\n    border: 2px solid #d1d5db;\n    border-radius: 4px;\n    cursor: pointer;\n    position: relative;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n}\n\n.file-checkbox input[type=\"checkbox\"]:checked + label {\n    background: #3b82f6;\n    border-color: #3b82f6;\n}\n\n.file-checkbox input[type=\"checkbox\"]:checked + label::after {\n    content: '';\n    position: absolute;\n    left: 50%;\n    top: 50%;\n    width: 6px;\n    height: 10px;\n    border: solid white;\n    border-width: 0 2px 2px 0;\n    transform: translate(-50%, -60%) rotate(45deg);\n}\n\n.file-checkbox label:hover {\n    border-color: #3b82f6;\n    transform: scale(1.1);\n}\n\n.file-info {\n    flex: 1;\n}\n\n.file-basic {\n    display: flex;\n    flex-direction: column;\n    gap: 8px;\n}\n\n.file-name-section {\n    display: flex;\n    align-items: center;\n    gap: 12px;\n}\n\n.file-name {\n    font-size: 16px;\n    font-weight: 500;\n    color: #333;\n}\n\n.file-name.editing input {\n    border: 1px solid #3b82f6;\n    border-radius: 4px;\n    padding: 4px 8px;\n    font-size: 16px;\n    outline: none;\n}\n\n.file-status {\n    padding: 4px 8px;\n    border-radius: 4px;\n    font-size: 12px;\n    font-weight: 500;\n}\n\n.file-status.cached {\n    background: #fef3c7;\n    color: #92400e;\n}\n\n.file-status.local {\n    background: #e0f2fe;\n    color: #0369a1;\n}\n\n.file-status.uploading {\n    background: #dbeafe;\n    color: #1e40af;\n    animation: pulse 2s infinite;\n}\n\n.file-status.syncing {\n    background: #d1fae5;\n    color: #059669;\n    animation: pulse 2s infinite;\n}\n\n.file-status.uploaded {\n    background: #d1fae5;\n    color: #065f46;\n}\n\n.file-status.error {\n    background: #fee2e2;\n    color: #b91c1c;\n}\n\n@keyframes pulse {\n    0%, 100% {\n        opacity: 1;\n    }\n    50% {\n        opacity: 0.7;\n    }\n}\n\n.file-details {\n    display: flex;\n    gap: 16px;\n    font-size: 12px;\n    color: #666;\n}\n\n.file-details span {\n    display: flex;\n    align-items: center;\n    gap: 4px;\n}\n\n.file-actions {\n    display: flex;\n    gap: 8px;\n}\n\n.action-btn {\n    padding: 8px 12px;\n    border: none;\n    border-radius: 6px;\n    cursor: pointer;\n    font-size: 14px;\n    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\n    transform: translateY(0);\n}\n\n.action-btn:hover:not(:disabled) {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\n}\n\n.action-btn:active:not(:disabled) {\n    transform: translateY(0);\n}\n\n.preview-btn {\n    background: #3b82f6;\n    color: white;\n}\n\n.preview-btn:hover {\n    background: #2563eb;\n}\n\n.sync-btn {\n    background: #10b981;\n    color: white;\n}\n\n.sync-btn:hover:not(:disabled) {\n    background: #059669;\n}\n\n.sync-btn:disabled {\n    background: #d1d5db;\n    cursor: not-allowed;\n    transform: none;\n}\n\n.delete-btn {\n    background: #ef4444;\n    color: white;\n}\n\n.delete-btn:hover {\n    background: #dc2626;\n}\n\n/* 响应式适配 */\n@media (max-width: 768px) {\n    .file-content {\n        width: 95vw;\n        max-height: 95vh;\n    }\n    \n    .main-content {\n        flex-direction: column;\n    }\n    \n    .upload-section {\n        width: 100%;\n        border-right: none;\n        border-bottom: 1px solid #e5e7eb;\n        padding: 15px;\n    }\n    \n    .upload-area {\n        padding: 20px 15px;\n    }\n    \n    .header-left {\n        flex-direction: column;\n        align-items: flex-start;\n        gap: 8px;\n    }\n    \n    .header-right {\n        flex-wrap: wrap;\n        gap: 6px;\n    }\n    \n    .action-group.single-row {\n        flex-wrap: wrap;\n        gap: 4px;\n    }\n    \n    .select-all-btn, .clear-selection-btn, .batch-clear-btn, .select-cached-btn {\n        padding: 3px 8px;\n        font-size: 11px;\n        min-width: auto;\n    }\n    \n    .stats-bar {\n        flex-direction: column;\n        gap: 8px;\n        padding: 12px 15px;\n    }\n    \n    .file-item {\n        flex-direction: column;\n        align-items: flex-start;\n        gap: 12px;\n        padding: 12px 15px;\n    }\n    \n    .file-item.select-mode {\n        padding-left: 15px;\n        padding-top: 40px;\n    }\n    \n    .file-checkbox {\n        left: 15px;\n        top: 15px;\n        transform: none;\n    }\n    \n    .file-actions {\n        align-self: flex-end;\n    }\n    \n    .file-details {\n        flex-wrap: wrap;\n        gap: 8px;\n    }\n}\n\n/* 加载状态动画 */\n.loading {\n    position: relative;\n}\n\n.loading::after {\n    content: '';\n    position: absolute;\n    width: 20px;\n    height: 20px;\n    border: 2px solid #f3f3f3;\n    border-top: 2px solid #3b82f6;\n    border-radius: 50%;\n    animation: spin 1s linear infinite;\n    margin-left: 10px;\n}\n\n@keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n/* 微交互动画 */\n.action-btn {\n    position: relative;\n    overflow: hidden;\n}\n\n.action-btn::before {\n    content: '';\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    width: 0;\n    height: 0;\n    background: rgba(255, 255, 255, 0.2);\n    border-radius: 50%;\n    transform: translate(-50%, -50%);\n    transition: width 0.3s, height 0.3s;\n}\n\n.action-btn:active::before {\n    width: 200px;\n    height: 200px;\n}\n</style>\n"],"mappings":";;;;;;;;;;;;AAiMA,SAASA,GAAG,EAAEC,QAAQ,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,KAAI;AACvD,OAAOC,gBAAgB,MAAM,wBAAuB;AACpD,SAASC,cAAc,EAAEC,aAAa,EAAEC,aAAa,EAAEC,eAAe,QAAQ,uBAAsB;AACpG,SAASC,aAAa,QAAQ,+BAA8B;AAC5D,SACIC,UAAU,EACVC,UAAU,EACVC,UAAU,EACVC,cAAc,EACdC,WAAW,EACXC,sBAAsB,EACtBC,iBAAgB,QACb,6BAA4B;;;;;;;;;;;;;IAbnC;IAeA,MAAMC,KAAK,GAAGC,OAAA;IAId,MAAMC,IAAI,GAAGC,MAAA;IAEb,MAAMC,UAAU,GAAGrB,GAAG,CAAC,KAAK;IAC5B,MAAMsB,KAAK,GAAGtB,GAAG,CAAC,EAAE;IACpB,MAAMuB,WAAW,GAAGvB,GAAG,CAAC,KAAK;IAC7B,MAAMwB,kBAAkB,GAAGxB,GAAG,CAAC,IAAI;IACnC,MAAMyB,WAAW,GAAGzB,GAAG,CAAC,EAAE;IAC1B,MAAM0B,kBAAkB,GAAG1B,GAAG,CAAC,KAAK;IACpC,MAAM2B,SAAS,GAAG3B,GAAG,CAAC,KAAK;;IAE3B;IACA,MAAM4B,KAAK,GAAGzB,QAAQ,CAAC,MAAM;MACzB,MAAM0B,UAAU,GAAGP,KAAK,CAACQ,KAAK,CAACC,MAAK;MACpC,MAAMC,SAAS,GAAGV,KAAK,CAACQ,KAAK,CAACG,MAAM,CAAC,CAACC,GAAG,EAAEC,IAAI,KAAKD,GAAG,IAAIC,IAAI,CAACC,IAAI,IAAI,CAAC,CAAC,EAAE,CAAC;MAC7E,MAAMC,gBAAgB,GAAGf,KAAK,CAACQ,KAAK,CAACQ,MAAM,CAACH,IAAI,IAAIA,IAAI,CAACI,MAAM,KAAK,OAAO,CAAC,CAACR,MAAK;MAClF,MAAMS,WAAW,GAAGlB,KAAK,CAACQ,KAAK,CAACQ,MAAM,CAACH,IAAI,IAAIA,IAAI,CAACI,MAAM,KAAK,QAAQ,CAAC,CAACR,MAAK;MAE9E,OAAO;QACHF,UAAU;QACVG,SAAS,EAAE3B,cAAc,CAAC2B,SAAS,CAAC;QACpCK,gBAAgB;QAChBG;MACJ;IACJ,CAAC;;IAED;IACA,MAAMC,aAAa,GAAGzC,GAAG,CAAC,EAAE;IAC5B,MAAM0C,YAAY,GAAG1C,GAAG,CAAC,KAAK;;IAE9B;IACA,MAAM2C,aAAa,GAAGxC,QAAQ,CAAC,MAAM;MACjC,MAAMyC,YAAY,GAAGtB,KAAK,CAACQ,KAAK,CAACQ,MAAM,CAACH,IAAI,IAAIM,aAAa,CAACX,KAAK,CAACe,QAAQ,CAACV,IAAI,CAACW,EAAE,CAAC;MACrF,MAAMN,WAAW,GAAGI,YAAY,CAACN,MAAM,CAACH,IAAI,IAAIA,IAAI,CAACI,MAAM,KAAK,QAAQ,CAAC,CAACR,MAAK;MAC/E,OAAO;QACHgB,KAAK,EAAEH,YAAY,CAACb,MAAM;QAC1BS,WAAW,EAAEA;MACjB;IACJ,CAAC;;IAED;IACAtC,SAAS,CAAC,YAAY;MAClB,MAAM8C,qBAAqB,CAAC;MAC5B,MAAMC,SAAS,CAAC;IACpB,CAAC;;IAED;IACA,eAAeD,qBAAqBA,CAAA,EAAG;MACnCtB,kBAAkB,CAACI,KAAK,GAAG,MAAMf,sBAAsB,CAAC;IAC5D;;IAEA;IACA,eAAekC,SAASA,CAAA,EAAG;MACvBtB,SAAS,CAACG,KAAK,GAAG,IAAG;MACrB,IAAI;QACA,MAAMoB,QAAQ,GAAG,MAAMpC,WAAW,CAAC;QACnCQ,KAAK,CAACQ,KAAK,GAAGoB,QAAQ,CAACC,GAAG,CAAChB,IAAI,KAAK;UAChC,GAAGA,IAAI;UACPiB,SAAS,EAAE,KAAK;UAChBC,OAAO,EAAElB,IAAI,CAACmB;QAClB,CAAC,CAAC;;QAEF;QACA,IAAIhC,KAAK,CAACQ,KAAK,CAACC,MAAM,KAAK,CAAC,EAAE;UAC1BT,KAAK,CAACQ,KAAK,GAAG,CACV;YACIgB,EAAE,EAAE,CAAC;YACLQ,IAAI,EAAE,iBAAiB;YACvBlB,IAAI,EAAE,IAAI,GAAG,EAAE;YACfG,MAAM,EAAE,QAAQ;YAChBa,SAAS,EAAE,KAAK;YAChBC,OAAO,EAAE,iBAAiB;YAC1BE,IAAI,EAAE,GAAG;YACTC,OAAO,EAAE,CAAC;YACVC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;UACtC,CAAC,EACD;YACIb,EAAE,EAAE,CAAC;YACLQ,IAAI,EAAE,gBAAgB;YACtBlB,IAAI,EAAE,IAAI,GAAG,GAAG;YAChBG,MAAM,EAAE,OAAO;YACfa,SAAS,EAAE,KAAK;YAChBC,OAAO,EAAE,gBAAgB;YACzBE,IAAI,EAAE,EAAE;YACRC,OAAO,EAAE,CAAC;YACVC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;UACtC,CAAC,EACD;YACIb,EAAE,EAAE,CAAC;YACLQ,IAAI,EAAE,YAAY;YAClBlB,IAAI,EAAE,IAAI,GAAG,GAAG;YAChBG,MAAM,EAAE,QAAQ;YAChBa,SAAS,EAAE,KAAK;YAChBC,OAAO,EAAE,YAAY;YACrBE,IAAI,EAAE,GAAG;YACTC,OAAO,EAAE,EAAE;YACXC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;UACtC,EACJ;QACJ;MACJ,CAAC,CAAC,OAAOC,KAAK,EAAE;QACZC,OAAO,CAACD,KAAK,CAAC,WAAW,EAAEA,KAAK;QAChC;QACAtC,KAAK,CAACQ,KAAK,GAAG,CACV;UACIgB,EAAE,EAAE,CAAC;UACLQ,IAAI,EAAE,iBAAiB;UACvBlB,IAAI,EAAE,IAAI,GAAG,EAAE;UACfG,MAAM,EAAE,QAAQ;UAChBa,SAAS,EAAE,KAAK;UAChBC,OAAO,EAAE,iBAAiB;UAC1BE,IAAI,EAAE,GAAG;UACTC,OAAO,EAAE,CAAC;UACVC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;QACtC,CAAC,EACD;UACIb,EAAE,EAAE,CAAC;UACLQ,IAAI,EAAE,gBAAgB;UACtBlB,IAAI,EAAE,IAAI,GAAG,GAAG;UAChBG,MAAM,EAAE,OAAO;UACfa,SAAS,EAAE,KAAK;UAChBC,OAAO,EAAE,gBAAgB;UACzBE,IAAI,EAAE,EAAE;UACRC,OAAO,EAAE,CAAC;UACVC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;QACtC,CAAC,EACD;UACIb,EAAE,EAAE,CAAC;UACLQ,IAAI,EAAE,YAAY;UAClBlB,IAAI,EAAE,IAAI,GAAG,GAAG;UAChBG,MAAM,EAAE,QAAQ;UAChBa,SAAS,EAAE,KAAK;UAChBC,OAAO,EAAE,YAAY;UACrBE,IAAI,EAAE,GAAG;UACTC,OAAO,EAAE,EAAE;UACXC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;QACtC,EACJ;MACJ,CAAC,SAAS;QACNhC,SAAS,CAACG,KAAK,GAAG,KAAI;MAC1B;IACJ;;IAEA;IACA,SAASgC,gBAAgBA,CAAA,EAAG;MACxBC,QAAQ,CAACC,aAAa,CAAC,aAAa,CAAC,CAACC,KAAK,CAAC;IAChD;;IAEA;IACA,eAAeC,gBAAgBA,CAACC,KAAK,EAAE;MACnC,MAAMC,QAAQ,GAAGC,KAAK,CAACC,IAAI,CAACH,KAAK,CAACI,MAAM,CAACjD,KAAK;MAC9C,MAAMkD,YAAY,CAACJ,QAAQ;IAC/B;;IAEA;IACA,eAAeK,UAAUA,CAACN,KAAK,EAAE;MAC7B9C,UAAU,CAACS,KAAK,GAAG,KAAI;MACvB,MAAMsC,QAAQ,GAAGC,KAAK,CAACC,IAAI,CAACH,KAAK,CAACO,YAAY,CAACpD,KAAK;MACpD,MAAMkD,YAAY,CAACJ,QAAQ;IAC/B;;IAEA;IACA,SAASO,WAAWA,CAACC,GAAG,EAAE;MACtBtD,KAAK,CAACQ,KAAK,CAAC8C,GAAG,CAAC,CAACxB,SAAS,GAAG,IAAG;MAChC9B,KAAK,CAACQ,KAAK,CAAC8C,GAAG,CAAC,CAACvB,OAAO,GAAG/B,KAAK,CAACQ,KAAK,CAAC8C,GAAG,CAAC,CAACtB,IAAG;MAC/CrD,QAAQ,CAAC,MAAM;QACX,MAAM4E,MAAM,GAAGd,QAAQ,CAACe,gBAAgB,CAAC,kBAAkB;QAC3D,IAAID,MAAM,CAACD,GAAG,CAAC,EAAE;UACbC,MAAM,CAACD,GAAG,CAAC,CAACG,KAAK,CAAC;QACtB;MACJ,CAAC;IACL;IAEA,eAAeC,YAAYA,CAACJ,GAAG,EAAE;MAC7B,MAAMzC,IAAI,GAAGb,KAAK,CAACQ,KAAK,CAAC8C,GAAG;MAC5B,IAAIzC,IAAI,CAACkB,OAAO,IAAIlB,IAAI,CAACkB,OAAO,KAAKlB,IAAI,CAACmB,IAAI,EAAE;QAC5C,IAAI;UACA,MAAM1C,UAAU,CAACuB,IAAI,CAACW,EAAE,EAAEX,IAAI,CAACkB,OAAO;UACtClB,IAAI,CAACmB,IAAI,GAAGnB,IAAI,CAACkB,OAAM;QAC3B,CAAC,CAAC,OAAOO,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,QAAQ,EAAEA,KAAK;UAC7BqB,KAAK,CAAC,QAAQ,GAAGrB,KAAK,CAACsB,OAAO;UAC9B/C,IAAI,CAACkB,OAAO,GAAGlB,IAAI,CAACmB,IAAI,EAAC;QAC7B;MACJ;MACAnB,IAAI,CAACiB,SAAS,GAAG,KAAI;IACzB;;IAEA;IACA,eAAe+B,UAAUA,CAACP,GAAG,EAAE;MAC3B,MAAMzC,IAAI,GAAGb,KAAK,CAACQ,KAAK,CAAC8C,GAAG;MAC5B,IAAIQ,OAAO,CAAC,YAAYjD,IAAI,CAACmB,IAAI,MAAM,CAAC,EAAE;QACtC,IAAI;UACA,MAAM3C,UAAU,CAACwB,IAAI,CAACW,EAAE;UACxBxB,KAAK,CAACQ,KAAK,CAACuD,MAAM,CAACT,GAAG,EAAE,CAAC;QAC7B,CAAC,CAAC,OAAOhB,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,OAAO,EAAEA,KAAK;UAC5BqB,KAAK,CAAC,OAAO,GAAGrB,KAAK,CAACsB,OAAO;QACjC;MACJ;IACJ;;IAEA;IACA,eAAeI,QAAQA,CAACV,GAAG,EAAE;MACzB,MAAMzC,IAAI,GAAGb,KAAK,CAACQ,KAAK,CAAC8C,GAAG;MAC5B,IAAI;QACAzC,IAAI,CAACI,MAAM,GAAG,SAAQ;QAEtB,MAAMgD,UAAU,GAAG,MAAMvE,iBAAiB,CAACmB,IAAI,CAACW,EAAE;QAClDxB,KAAK,CAACQ,KAAK,CAAC8C,GAAG,CAAC,GAAG;UACf,GAAGW,UAAU;UACbnC,SAAS,EAAE,KAAK;UAChBC,OAAO,EAAEkC,UAAU,CAACjC;QACxB;MACJ,CAAC,CAAC,OAAOM,KAAK,EAAE;QACZC,OAAO,CAACD,KAAK,CAAC,OAAO,EAAEA,KAAK;QAC5BqB,KAAK,CAAC,OAAO,GAAGrB,KAAK,CAACsB,OAAO;QAC7B/C,IAAI,CAACI,MAAM,GAAG,OAAM;MACxB;IACJ;;IAEA;IACA,eAAeiD,WAAWA,CAACZ,GAAG,EAAE;MAC5B,MAAMzC,IAAI,GAAGb,KAAK,CAACQ,KAAK,CAAC8C,GAAG;MAC5B,IAAI;QACA,MAAMa,aAAa,GAAG,MAAM5E,cAAc,CAACsB,IAAI,CAACW,EAAE;QAClDtB,kBAAkB,CAACM,KAAK,GAAGK,IAAG;QAC9BV,WAAW,CAACK,KAAK,GAAG2D,aAAa,CAACC,IAAG;QACrCnE,WAAW,CAACO,KAAK,GAAG,IAAG;MAC3B,CAAC,CAAC,OAAO8B,KAAK,EAAE;QACZC,OAAO,CAACD,KAAK,CAAC,OAAO,EAAEA,KAAK;QAC5BqB,KAAK,CAAC,OAAO,GAAGrB,KAAK,CAACsB,OAAO;MACjC;IACJ;IAEA,SAASS,YAAYA,CAAA,EAAG;MACpBpE,WAAW,CAACO,KAAK,GAAG,KAAI;MACxBN,kBAAkB,CAACM,KAAK,GAAG,IAAG;MAC9BL,WAAW,CAACK,KAAK,GAAG,EAAC;IACzB;IAEA,SAAS8D,OAAOA,CAAA,EAAG;MACfzE,IAAI,CAAC,OAAO;IAChB;;IAEA;IACA,SAAS0E,gBAAgBA,CAAA,EAAG;MACxBnD,YAAY,CAACZ,KAAK,GAAG,CAACY,YAAY,CAACZ,KAAI;MACvC,IAAI,CAACY,YAAY,CAACZ,KAAK,EAAE;QACrBW,aAAa,CAACX,KAAK,GAAG,EAAC;MAC3B;IACJ;IAEA,SAASgE,mBAAmBA,CAACC,MAAM,EAAE;MACjC,MAAMC,KAAK,GAAGvD,aAAa,CAACX,KAAK,CAACmE,OAAO,CAACF,MAAM;MAChD,IAAIC,KAAK,GAAG,CAAC,CAAC,EAAE;QACZvD,aAAa,CAACX,KAAK,CAACuD,MAAM,CAACW,KAAK,EAAE,CAAC;MACvC,CAAC,MAAM;QACHvD,aAAa,CAACX,KAAK,CAACoE,IAAI,CAACH,MAAM;MACnC;IACJ;IAEA,SAASI,cAAcA,CAAA,EAAG;MACtB1D,aAAa,CAACX,KAAK,GAAGR,KAAK,CAACQ,KAAK,CAACqB,GAAG,CAAChB,IAAI,IAAIA,IAAI,CAACW,EAAE;IACzD;IAEA,SAASsD,oBAAoBA,CAAA,EAAG;MAC5B,MAAMC,WAAW,GAAG/E,KAAK,CAACQ,KAAK,CAACQ,MAAM,CAACH,IAAI,IAAIA,IAAI,CAACI,MAAM,KAAK,QAAQ;MACvE,MAAM+D,SAAS,GAAGD,WAAW,CAAClD,GAAG,CAAChB,IAAI,IAAIA,IAAI,CAACW,EAAE;MACjD;MACAL,aAAa,CAACX,KAAK,GAAG,CAAC,GAAG,IAAIyE,GAAG,CAAC,CAAC,GAAG9D,aAAa,CAACX,KAAK,EAAE,GAAGwE,SAAS,CAAC,CAAC;IAC7E;IAEA,SAASE,cAAcA,CAAA,EAAG;MACtB/D,aAAa,CAACX,KAAK,GAAG,EAAC;IAC3B;;IAEA;IACA,eAAe2E,wBAAwBA,CAAA,EAAG;MACtC,MAAMC,mBAAmB,GAAGpF,KAAK,CAACQ,KAAK,CAACQ,MAAM,CAACH,IAAI,IAC/CM,aAAa,CAACX,KAAK,CAACe,QAAQ,CAACV,IAAI,CAACW,EAAE,CAAC,IAAIX,IAAI,CAACI,MAAM,KAAK,QAC7D;MAEA,IAAIE,aAAa,CAACX,KAAK,CAACC,MAAM,KAAK,CAAC,EAAE;QAClCkD,KAAK,CAAC,oCAAoC;QAC1C;MACJ;MAEA,IAAIyB,mBAAmB,CAAC3E,MAAM,KAAK,CAAC,EAAE;QAClCkD,KAAK,CAAC,gDAAgD;QACtD;MACJ;MAEA,IAAIG,OAAO,CAAC,kCAAkCsB,mBAAmB,CAAC3E,MAAM,gBAAgB,CAAC,EAAE;QACvF,KAAK,MAAMI,IAAI,IAAIuE,mBAAmB,EAAE;UACpC,IAAI;YACA,MAAM/F,UAAU,CAACwB,IAAI,CAACW,EAAE;YACxB,MAAMkD,KAAK,GAAG1E,KAAK,CAACQ,KAAK,CAAC6E,SAAS,CAACC,CAAC,IAAIA,CAAC,CAAC9D,EAAE,KAAKX,IAAI,CAACW,EAAE;YACzD,IAAIkD,KAAK,KAAK,CAAC,CAAC,EAAE;cACd1E,KAAK,CAACQ,KAAK,CAACuD,MAAM,CAACW,KAAK,EAAE,CAAC;YAC/B;YACA;YACA,MAAMa,aAAa,GAAGpE,aAAa,CAACX,KAAK,CAACmE,OAAO,CAAC9D,IAAI,CAACW,EAAE;YACzD,IAAI+D,aAAa,GAAG,CAAC,CAAC,EAAE;cACpBpE,aAAa,CAACX,KAAK,CAACuD,MAAM,CAACwB,aAAa,EAAE,CAAC;YAC/C;UACJ,CAAC,CAAC,OAAOjD,KAAK,EAAE;YACZC,OAAO,CAACD,KAAK,CAAC,8BAA8B,EAAEA,KAAK;YACnDqB,KAAK,CAAC,yBAAyB9C,IAAI,CAACmB,IAAI,MAAMM,KAAK,CAACsB,OAAO,EAAE;UACjE;QACJ;;QAEA;QACA,IAAIzC,aAAa,CAACX,KAAK,CAACC,MAAM,KAAK,CAAC,EAAE;UAClCW,YAAY,CAACZ,KAAK,GAAG,KAAI;QAC7B;QAEAmD,KAAK,CAAC,wBAAwByB,mBAAmB,CAAC3E,MAAM,eAAe;MAC3E;IACJ;IACA;IACA,eAAe+E,YAAYA,CAAA,EAAG;MAC1B,MAAMC,UAAU,GAAGzF,KAAK,CAACQ,KAAK,CAACQ,MAAM,CAACH,IAAI,IAAIA,IAAI,CAACI,MAAM,KAAK,OAAO;MAErE,IAAIwE,UAAU,CAAChF,MAAM,KAAK,CAAC,EAAE;QACzBkD,KAAK,CAAC,WAAW;QACjB;MACJ;MAEA,IAAI,CAACvD,kBAAkB,CAACI,KAAK,EAAE;QAC3BmD,KAAK,CAAC,YAAY;QAClB;MACJ;MAEA,IAAIG,OAAO,CAAC,SAAS2B,UAAU,CAAChF,MAAM,WAAW,CAAC,EAAE;QAChD,KAAK,IAAIiF,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGD,UAAU,CAAChF,MAAM,EAAEiF,CAAC,EAAE,EAAE;UACxC,MAAMC,SAAS,GAAG3F,KAAK,CAACQ,KAAK,CAAC6E,SAAS,CAACC,CAAC,IAAIA,CAAC,CAAC9D,EAAE,KAAKiE,UAAU,CAACC,CAAC,CAAC,CAAClE,EAAE;UACtE,IAAImE,SAAS,KAAK,CAAC,CAAC,EAAE;YAClB,MAAM3B,QAAQ,CAAC2B,SAAS;UAC5B;QACJ;MACJ;IACJ;;IAEA;IACA,eAAeC,YAAYA,CAAA,EAAG;MAC1B,MAAMlE,qBAAqB,CAAC;MAC5B,MAAMC,SAAS,CAAC;IACpB;;IAEA;IACA,eAAeuB,YAAYA,CAACJ,QAAQ,EAAE;MAClC,MAAM+C,UAAU,GAAG/C,QAAQ,CAAC9B,MAAM,CAACH,IAAI,IAAI3B,eAAe,CAAC2B,IAAI,CAACmB,IAAI,CAAC;MAErE,IAAI6D,UAAU,CAACpF,MAAM,KAAKqC,QAAQ,CAACrC,MAAM,EAAE;QACvCkD,KAAK,CAAC,wBAAwB;MAClC;MAEA,KAAK,MAAM9C,IAAI,IAAIgF,UAAU,EAAE;QAC3B,IAAI;UACA;UACA,MAAMC,QAAQ,GAAG;YACbtE,EAAE,EAAEY,IAAI,CAAC2D,GAAG,CAAC,CAAC,GAAGC,IAAI,CAACC,MAAM,CAAC,CAAC;YAC9BjE,IAAI,EAAEnB,IAAI,CAACmB,IAAI;YACflB,IAAI,EAAED,IAAI,CAACC,IAAI;YACfG,MAAM,EAAE,WAAW;YACnBa,SAAS,EAAE,KAAK;YAChBC,OAAO,EAAElB,IAAI,CAACmB,IAAI;YAClBC,IAAI,EAAE,CAAC;YACPC,OAAO,EAAE,CAAC;YACVC,SAAS,EAAE,IAAIC,IAAI,CAAC,CAAC,CAACC,WAAW,CAAC;UACtC;UACArC,KAAK,CAACQ,KAAK,CAACoE,IAAI,CAACkB,QAAQ;;UAEzB;UACA,MAAMI,YAAY,GAAG,MAAM9G,UAAU,CAACyB,IAAI;;UAE1C;UACA,MAAM8E,SAAS,GAAG3F,KAAK,CAACQ,KAAK,CAAC6E,SAAS,CAACC,CAAC,IAAIA,CAAC,CAAC9D,EAAE,KAAKsE,QAAQ,CAACtE,EAAE;UACjE,IAAImE,SAAS,KAAK,CAAC,CAAC,EAAE;YAClB3F,KAAK,CAACQ,KAAK,CAACmF,SAAS,CAAC,GAAG;cACrB,GAAGO,YAAY;cACfpE,SAAS,EAAE,KAAK;cAChBC,OAAO,EAAEmE,YAAY,CAAClE;YAC1B;UACJ;QACJ,CAAC,CAAC,OAAOM,KAAK,EAAE;UACZC,OAAO,CAACD,KAAK,CAAC,SAAS,EAAEA,KAAK;UAC9B;UACA,MAAMoC,KAAK,GAAG1E,KAAK,CAACQ,KAAK,CAAC6E,SAAS,CAACC,CAAC,IAAIA,CAAC,CAACtD,IAAI,KAAKnB,IAAI,CAACmB,IAAI;UAC7D,IAAI0C,KAAK,KAAK,CAAC,CAAC,EAAE;YACd1E,KAAK,CAACQ,KAAK,CAACkE,KAAK,CAAC,CAACzD,MAAM,GAAG,OAAM;UACtC;QACJ;MACJ;IACJ","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}