{"ast":null,"code":"import { ref, computed, watch, onMounted } from 'vue';\nexport default {\n  __name: 'DataPreviewModal',\n  props: {\n    show: Boolean,\n    currentFile: Object,\n    previewData: {\n      type: Array,\n      default: () => []\n    },\n    previewInfo: {\n      type: Object,\n      default: () => null\n    },\n    isSidePreview: {\n      type: Boolean,\n      default: false\n    },\n    maxRows: {\n      type: Number,\n      default: 200\n    }\n  },\n  emits: ['close', 'refresh', 'export'],\n  setup(__props, {\n    expose: __expose,\n    emit: __emit\n  }) {\n    __expose();\n\n    /* eslint-disable */\n    const props = __props;\n    const emit = __emit;\n    const loading = ref(false);\n    const error = ref('');\n    const isFullScreen = ref(false);\n    const sortColumn = ref('');\n    const sortDirection = ref('asc');\n\n    // Ë°®Â§¥ËÆ°ÁÆó\n    const tableHeaders = computed(() => {\n      if (!props.previewData.length) return [];\n      return Object.keys(props.previewData[0]);\n    });\n\n    // ÊéíÂ∫èÂêéÁöÑÊï∞ÊçÆ\n    const sortedData = computed(() => {\n      if (!sortColumn.value) return props.previewData;\n      const sorted = [...props.previewData].sort((a, b) => {\n        const aVal = a[sortColumn.value];\n        const bVal = b[sortColumn.value];\n\n        // Â§ÑÁêÜÊï∞Â≠óÊéíÂ∫è\n        if (!isNaN(aVal) && !isNaN(bVal)) {\n          return sortDirection.value === 'asc' ? aVal - bVal : bVal - aVal;\n        }\n\n        // Â§ÑÁêÜÂ≠óÁ¨¶‰∏≤ÊéíÂ∫è\n        const aStr = String(aVal).toLowerCase();\n        const bStr = String(bVal).toLowerCase();\n        if (sortDirection.value === 'asc') {\n          return aStr.localeCompare(bStr);\n        } else {\n          return bStr.localeCompare(aStr);\n        }\n      });\n      return sorted;\n    });\n\n    // ÁõëÂê¨Êñá‰ª∂ÂèòÂåñ\n    watch(() => props.currentFile, newFile => {\n      if (newFile) {\n        error.value = '';\n        sortColumn.value = '';\n        sortDirection.value = 'asc';\n      }\n    }, {\n      immediate: true\n    });\n    function onClose() {\n      emit('close');\n    }\n    function refreshData() {\n      loading.value = true;\n      error.value = '';\n      emit('refresh');\n    }\n    function exportData() {\n      emit('export');\n    }\n    function toggleFullScreen() {\n      isFullScreen.value = !isFullScreen.value;\n    }\n    function sortByColumn(column) {\n      if (sortColumn.value === column) {\n        sortDirection.value = sortDirection.value === 'asc' ? 'desc' : 'asc';\n      } else {\n        sortColumn.value = column;\n        sortDirection.value = 'asc';\n      }\n    }\n    function formatCellValue(value) {\n      if (value === null || value === undefined) return '';\n      if (typeof value === 'string' && value.length > 100) {\n        return value.substring(0, 100) + '...';\n      }\n      return String(value);\n    }\n    function formatDate(dateString) {\n      if (!dateString) return 'Unknown';\n      try {\n        const date = new Date(dateString);\n        return date.toLocaleDateString('zh-CN');\n      } catch (error) {\n        return 'Invalid Date';\n      }\n    }\n    onMounted(() => {\n      // ÈîÆÁõòÂø´Êç∑ÈîÆ\n      document.addEventListener('keydown', handleKeyDown);\n    });\n    function handleKeyDown(event) {\n      if (!props.show) return;\n      if (event.key === 'Escape') {\n        onClose();\n      } else if (event.key === 'F11') {\n        event.preventDefault();\n        toggleFullScreen();\n      }\n    }\n    const __returned__ = {\n      props,\n      emit,\n      loading,\n      error,\n      isFullScreen,\n      sortColumn,\n      sortDirection,\n      tableHeaders,\n      sortedData,\n      onClose,\n      refreshData,\n      exportData,\n      toggleFullScreen,\n      sortByColumn,\n      formatCellValue,\n      formatDate,\n      handleKeyDown,\n      ref,\n      computed,\n      watch,\n      onMounted\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","watch","onMounted","props","__props","emit","__emit","loading","error","isFullScreen","sortColumn","sortDirection","tableHeaders","previewData","length","Object","keys","sortedData","value","sorted","sort","a","b","aVal","bVal","isNaN","aStr","String","toLowerCase","bStr","localeCompare","currentFile","newFile","immediate","onClose","refreshData","exportData","toggleFullScreen","sortByColumn","column","formatCellValue","undefined","substring","formatDate","dateString","date","Date","toLocaleDateString","document","addEventListener","handleKeyDown","event","show","key","preventDefault"],"sources":["D:/Learning Material/Git/Fuck-Charts/newArchitecture/frontend_vue_design/src/components/DataPreviewModal.vue"],"sourcesContent":["<template>\n<transition name=\"fade-slide\">\n    <div v-if=\"show\"\n        class=\"preview-modal\"\n        :class=\"{ 'side-preview': isSidePreview }\"\n        @click.self=\"onClose\">\n        <div class=\"preview-content\">\n            <!-- Â§¥ÈÉ® -->\n            <div class=\"preview-header\">\n                <div class=\"header-left\">\n                    <span class=\"file-title\">{{ currentFile?.name || 'Data Preview' }}</span>\n                    <span class=\"file-info\" v-if=\"previewInfo\">\n                        ({{ previewInfo.totalRows }} rows, {{ previewInfo.headers.length }} columns)\n                    </span>\n                </div>\n                <div class=\"header-actions\">\n                    <button \n                        class=\"action-btn\"\n                        @click=\"refreshData\"\n                        title=\"Refresh Data\">\n                        üîÑ\n                    </button>\n                    <button \n                        class=\"action-btn\"\n                        @click=\"exportData\"\n                        title=\"Export Data\">\n                        üì•\n                    </button>\n                    <button class=\"close-btn\" @click=\"onClose\">√ó</button>\n                </div>\n            </div>\n\n            <!-- Êñá‰ª∂ÂÖÉ‰ø°ÊÅØ -->\n            <div class=\"file-metadata\" v-if=\"previewInfo?.fileInfo\">\n                <div class=\"metadata-item\">\n                    <span class=\"label\">Size:</span>\n                    <span class=\"value\">{{ previewInfo.fileInfo.size }}</span>\n                </div>\n                <div class=\"metadata-item\">\n                    <span class=\"label\">Type:</span>\n                    <span class=\"value\">{{ previewInfo.fileInfo.extension.toUpperCase() }}</span>\n                </div>\n                <div class=\"metadata-item\">\n                    <span class=\"label\">Created:</span>\n                    <span class=\"value\">{{ formatDate(previewInfo.fileInfo.createdAt) }}</span>\n                </div>\n            </div>\n\n            <!-- Âä†ËΩΩÁä∂ÊÄÅ -->\n            <div v-if=\"loading\" class=\"loading-container\">\n                <div class=\"loading-spinner\"></div>\n                <p>Loading data...</p>\n            </div>\n\n            <!-- ÈîôËØØÁä∂ÊÄÅ -->\n            <div v-else-if=\"error\" class=\"error-container\">\n                <div class=\"error-icon\">‚ö†Ô∏è</div>\n                <p>{{ error }}</p>\n                <button class=\"retry-btn\" @click=\"refreshData\">Retry</button>\n            </div>\n\n            <!-- Êï∞ÊçÆË°®Ê†ºÈ¢ÑËßà -->\n            <div v-else class=\"preview-table-wrapper\">\n                <div class=\"table-controls\">\n                    <div class=\"controls-left\">\n                        <span class=\"row-count\">Showing {{ Math.min(previewData.length, maxRows) }} of {{ previewInfo?.totalRows || 0 }} rows</span>\n                    </div>\n                    <div class=\"controls-right\">\n                        <button \n                            class=\"control-btn\"\n                            @click=\"toggleFullScreen\"\n                            title=\"Toggle Full Screen\">\n                            {{ isFullScreen ? 'üóó' : 'üóñ' }}\n                        </button>\n                    </div>\n                </div>\n                \n                <div class=\"table-container\" :class=\"{ 'fullscreen': isFullScreen }\">\n                    <table v-if=\"previewData.length\" class=\"preview-table\">\n                        <thead>\n                            <tr>\n                                <th class=\"row-number\">#</th>\n                                <th v-for=\"header in tableHeaders\"\n                                    :key=\"header\"\n                                    class=\"sortable\"\n                                    @click=\"sortByColumn(header)\">\n                                    {{ header }}\n                                    <span class=\"sort-icon\" v-if=\"sortColumn === header\">\n                                        {{ sortDirection === 'asc' ? '‚ñ≤' : '‚ñº' }}\n                                    </span>\n                                </th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <tr v-for=\"(row, idx) in sortedData\"\n                                :key=\"idx\"\n                                class=\"data-row\">\n                                <td class=\"row-number\">{{ idx + 1 }}</td>\n                                <td v-for=\"header in tableHeaders\"\n                                    :key=\"header\"\n                                    class=\"data-cell\"\n                                    :title=\"String(row[header])\">\n                                    {{ formatCellValue(row[header]) }}\n                                </td>\n                            </tr>\n                        </tbody>\n                    </table>\n                    <div v-else class=\"empty-tip\">\n                        <div class=\"empty-icon\">üìÑ</div>\n                        <p>No data available</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</transition>\n</template>\n\n<script setup>\n/* eslint-disable */\nimport { ref, computed, watch, onMounted } from 'vue'\n\nconst props = defineProps({\n    show: Boolean,\n    currentFile: Object,\n    previewData: {\n        type: Array,\n        default: () => []\n    },\n    previewInfo: {\n        type: Object,\n        default: () => null\n    },\n    isSidePreview: {\n        type: Boolean,\n        default: false\n    },\n    maxRows: {\n        type: Number,\n        default: 200\n    }\n})\n\nconst emit = defineEmits(['close', 'refresh', 'export'])\n\nconst loading = ref(false)\nconst error = ref('')\nconst isFullScreen = ref(false)\nconst sortColumn = ref('')\nconst sortDirection = ref('asc')\n\n// Ë°®Â§¥ËÆ°ÁÆó\nconst tableHeaders = computed(() => {\n    if (!props.previewData.length) return []\n    return Object.keys(props.previewData[0])\n})\n\n// ÊéíÂ∫èÂêéÁöÑÊï∞ÊçÆ\nconst sortedData = computed(() => {\n    if (!sortColumn.value) return props.previewData\n    \n    const sorted = [...props.previewData].sort((a, b) => {\n        const aVal = a[sortColumn.value]\n        const bVal = b[sortColumn.value]\n        \n        // Â§ÑÁêÜÊï∞Â≠óÊéíÂ∫è\n        if (!isNaN(aVal) && !isNaN(bVal)) {\n            return sortDirection.value === 'asc' ? aVal - bVal : bVal - aVal\n        }\n        \n        // Â§ÑÁêÜÂ≠óÁ¨¶‰∏≤ÊéíÂ∫è\n        const aStr = String(aVal).toLowerCase()\n        const bStr = String(bVal).toLowerCase()\n        \n        if (sortDirection.value === 'asc') {\n            return aStr.localeCompare(bStr)\n        } else {\n            return bStr.localeCompare(aStr)\n        }\n    })\n    \n    return sorted\n})\n\n// ÁõëÂê¨Êñá‰ª∂ÂèòÂåñ\nwatch(() => props.currentFile, (newFile) => {\n    if (newFile) {\n        error.value = ''\n        sortColumn.value = ''\n        sortDirection.value = 'asc'\n    }\n}, { immediate: true })\n\nfunction onClose() {\n    emit('close')\n}\n\nfunction refreshData() {\n    loading.value = true\n    error.value = ''\n    emit('refresh')\n}\n\nfunction exportData() {\n    emit('export')\n}\n\nfunction toggleFullScreen() {\n    isFullScreen.value = !isFullScreen.value\n}\n\nfunction sortByColumn(column) {\n    if (sortColumn.value === column) {\n        sortDirection.value = sortDirection.value === 'asc' ? 'desc' : 'asc'\n    } else {\n        sortColumn.value = column\n        sortDirection.value = 'asc'\n    }\n}\n\nfunction formatCellValue(value) {\n    if (value === null || value === undefined) return ''\n    if (typeof value === 'string' && value.length > 100) {\n        return value.substring(0, 100) + '...'\n    }\n    return String(value)\n}\n\nfunction formatDate(dateString) {\n    if (!dateString) return 'Unknown'\n    \n    try {\n        const date = new Date(dateString)\n        return date.toLocaleDateString('zh-CN')\n    } catch (error) {\n        return 'Invalid Date'\n    }\n}\n\nonMounted(() => {\n    // ÈîÆÁõòÂø´Êç∑ÈîÆ\n    document.addEventListener('keydown', handleKeyDown)\n})\n\nfunction handleKeyDown(event) {\n    if (!props.show) return\n    \n    if (event.key === 'Escape') {\n        onClose()\n    } else if (event.key === 'F11') {\n        event.preventDefault()\n        toggleFullScreen()\n    }\n}\n</script>\n\n\n<style scoped>\n.preview-modal {\n    position: fixed;\n    top: 0; left: 0; right: 0; bottom: 0;\n    background: rgba(0,0,0,0.18);\n    z-index: 9999;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n}\n\n.preview-content {\n    width: min(90vw, 800px);\n    height: min(90vh, 600px);\n    background: var(--bg-color, #fff);\n    border-radius: 12px;\n    box-shadow: 0 8px 32px rgba(0,0,0,0.18);\n    display: flex;\n    flex-direction: column;\n}\n\n/* ‰æßËæπÈ¢ÑËßàÊ®°Âºè */\n.side-preview {\n    justify-content: flex-start;\n    padding-left: 520px;\n}\n\n.side-preview .preview-content {\n    width: min(90vw - 520px, 600px);\n}\n\n.preview-header {\n    padding: 16px 20px;\n    border-bottom: 1px solid #eee;\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n}\n\n.close-btn {\n    background: none;\n    border: none;\n    font-size: 1.5em;\n    cursor: pointer;\n    color: var(--text-color);\n}\n\n.preview-table-wrapper {\n    flex: 1;\n    overflow: auto;\n    padding: 16px;\n}\n\n.preview-table {\n    width: 100%;\n    border-collapse: collapse;\n}\n\n.preview-table th,\n.preview-table td {\n    padding: 8px 12px;\n    border: 1px solid #eee;\n    text-align: left;\n}\n\n.preview-table th {\n    background: #f8f9fa;\n    font-weight: 500;\n}\n\n.empty-tip {\n    text-align: center;\n    color: #999;\n    padding: 40px;\n}\n\n/* Âä®Áîª */\n.fade-slide-enter-active,\n.fade-slide-leave-active {\n    transition: all 0.3s;\n}\n\n.fade-slide-enter-from,\n.fade-slide-leave-to {\n    opacity: 0;\n    transform: translateX(30px);\n}\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}