{"ast":null,"code":"import { ref } from 'vue';\nimport FileUploadModal from '@/components/FileUploadModal.vue';\nimport { checkBackendConnection, getCachedFiles } from '@/services/FileServices.js';\nexport default {\n  __name: 'FileUploadTest',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n    const showFileModal = ref(false);\n    const connectionStatus = ref(null);\n    const cacheData = ref(null);\n    async function checkConnection() {\n      try {\n        const isConnected = await checkBackendConnection();\n        connectionStatus.value = {\n          type: isConnected ? 'alert-success' : 'alert-danger',\n          message: isConnected ? '后端连接正常' : '后端未连接（离线模式）'\n        };\n      } catch (error) {\n        connectionStatus.value = {\n          type: 'alert-danger',\n          message: '连接检查失败：' + error.message\n        };\n      }\n    }\n    function viewCache() {\n      try {\n        cacheData.value = getCachedFiles();\n      } catch (error) {\n        connectionStatus.value = {\n          type: 'alert-danger',\n          message: '获取缓存失败：' + error.message\n        };\n      }\n    }\n    function clearCache() {\n      if (confirm('确定要清除所有缓存文件吗？')) {\n        try {\n          localStorage.removeItem('fuck_charts_files');\n          cacheData.value = null;\n          connectionStatus.value = {\n            type: 'alert-success',\n            message: '缓存已清除'\n          };\n        } catch (error) {\n          connectionStatus.value = {\n            type: 'alert-danger',\n            message: '清除缓存失败：' + error.message\n          };\n        }\n      }\n    }\n    function formatFileSize(bytes) {\n      if (bytes === 0) return '0 Bytes';\n      const k = 1024;\n      const sizes = ['Bytes', 'KB', 'MB', 'GB'];\n      const i = Math.floor(Math.log(bytes) / Math.log(k));\n      return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];\n    }\n    function getStatusText(status) {\n      const statusMap = {\n        'local': '本地缓存',\n        'uploading': '上传中',\n        'uploaded': '已上传',\n        'error': '出错'\n      };\n      return statusMap[status] || '未知';\n    }\n    const __returned__ = {\n      showFileModal,\n      connectionStatus,\n      cacheData,\n      checkConnection,\n      viewCache,\n      clearCache,\n      formatFileSize,\n      getStatusText,\n      ref,\n      FileUploadModal,\n      get checkBackendConnection() {\n        return checkBackendConnection;\n      },\n      get getCachedFiles() {\n        return getCachedFiles;\n      }\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","FileUploadModal","checkBackendConnection","getCachedFiles","showFileModal","connectionStatus","cacheData","checkConnection","isConnected","value","type","message","error","viewCache","clearCache","confirm","localStorage","removeItem","formatFileSize","bytes","k","sizes","i","Math","floor","log","parseFloat","pow","toFixed","getStatusText","status","statusMap"],"sources":["D:/Learning Material/Git/Fuck-Charts/newArchitecture/frontend_vue_design/src/views/FileUploadTest.vue"],"sourcesContent":["<template>\n  <div class=\"test-page\">\n    <div class=\"container\">\n      <h1>文件上传组件测试</h1>\n      <div class=\"test-controls\">\n        <button @click=\"showFileModal = true\" class=\"btn btn-primary\">\n          打开文件管理器\n        </button>\n        <button @click=\"checkConnection\" class=\"btn btn-secondary\">\n          检查后端连接\n        </button>\n        <button @click=\"viewCache\" class=\"btn btn-info\">\n          查看缓存\n        </button>\n        <button @click=\"clearCache\" class=\"btn btn-warning\">\n          清除缓存\n        </button>\n      </div>\n      \n      <div v-if=\"connectionStatus\" class=\"alert\" :class=\"connectionStatus.type\">\n        {{ connectionStatus.message }}\n      </div>\n      \n      <div v-if=\"cacheData\" class=\"cache-info\">\n        <h3>缓存信息</h3>\n        <div v-if=\"cacheData.length === 0\" class=\"alert alert-info\">\n          暂无缓存文件\n        </div>\n        <div v-else>\n          <p>共有 {{ cacheData.length }} 个缓存文件</p>\n          <div class=\"cache-files\">\n            <div v-for=\"file in cacheData\" :key=\"file.id\" class=\"cache-file\">\n              <div class=\"file-name\">{{ file.name }}</div>\n              <div class=\"file-details\">\n                <span>大小: {{ formatFileSize(file.size) }}</span>\n                <span>状态: {{ getStatusText(file.status) }}</span>\n                <span>创建时间: {{ new Date(file.createdAt).toLocaleString() }}</span>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n    \n    <!-- 文件上传模态框 -->\n    <FileUploadModal \n      :show=\"showFileModal\" \n      @close=\"showFileModal = false\"\n    />\n  </div>\n</template>\n\n<script setup>\nimport { ref } from 'vue'\nimport FileUploadModal from '@/components/FileUploadModal.vue'\nimport { checkBackendConnection, getCachedFiles } from '@/services/FileServices.js'\n\nconst showFileModal = ref(false)\nconst connectionStatus = ref(null)\nconst cacheData = ref(null)\n\nasync function checkConnection() {\n  try {\n    const isConnected = await checkBackendConnection()\n    connectionStatus.value = {\n      type: isConnected ? 'alert-success' : 'alert-danger',\n      message: isConnected ? '后端连接正常' : '后端未连接（离线模式）'\n    }\n  } catch (error) {\n    connectionStatus.value = {\n      type: 'alert-danger',\n      message: '连接检查失败：' + error.message\n    }\n  }\n}\n\nfunction viewCache() {\n  try {\n    cacheData.value = getCachedFiles()\n  } catch (error) {\n    connectionStatus.value = {\n      type: 'alert-danger',\n      message: '获取缓存失败：' + error.message\n    }\n  }\n}\n\nfunction clearCache() {\n  if (confirm('确定要清除所有缓存文件吗？')) {\n    try {\n      localStorage.removeItem('fuck_charts_files')\n      cacheData.value = null\n      connectionStatus.value = {\n        type: 'alert-success',\n        message: '缓存已清除'\n      }\n    } catch (error) {\n      connectionStatus.value = {\n        type: 'alert-danger',\n        message: '清除缓存失败：' + error.message\n      }\n    }\n  }\n}\n\nfunction formatFileSize(bytes) {\n  if (bytes === 0) return '0 Bytes'\n  const k = 1024\n  const sizes = ['Bytes', 'KB', 'MB', 'GB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n}\n\nfunction getStatusText(status) {\n  const statusMap = {\n    'local': '本地缓存',\n    'uploading': '上传中',\n    'uploaded': '已上传',\n    'error': '出错'\n  }\n  return statusMap[status] || '未知'\n}\n</script>\n\n<style scoped>\n.test-page {\n  min-height: 100vh;\n  background: var(--bg-color);\n  color: var(--text-color);\n  padding: 20px;\n}\n\n.container {\n  max-width: 1200px;\n  margin: 0 auto;\n}\n\n.test-controls {\n  margin: 20px 0;\n  display: flex;\n  gap: 10px;\n  flex-wrap: wrap;\n}\n\n.btn {\n  padding: 10px 20px;\n  border: none;\n  border-radius: 6px;\n  cursor: pointer;\n  font-size: 14px;\n  transition: all 0.3s;\n}\n\n.btn-primary {\n  background: #007bff;\n  color: white;\n}\n\n.btn-primary:hover {\n  background: #0056b3;\n}\n\n.btn-secondary {\n  background: #6c757d;\n  color: white;\n}\n\n.btn-secondary:hover {\n  background: #545b62;\n}\n\n.btn-info {\n  background: #17a2b8;\n  color: white;\n}\n\n.btn-info:hover {\n  background: #138496;\n}\n\n.btn-warning {\n  background: #ffc107;\n  color: #212529;\n}\n\n.btn-warning:hover {\n  background: #e0a800;\n}\n\n.alert {\n  padding: 15px;\n  margin: 15px 0;\n  border-radius: 4px;\n  border: 1px solid;\n}\n\n.alert-success {\n  background: #d4edda;\n  color: #155724;\n  border-color: #c3e6cb;\n}\n\n.alert-danger {\n  background: #f8d7da;\n  color: #721c24;\n  border-color: #f5c6cb;\n}\n\n.alert-info {\n  background: #d1ecf1;\n  color: #0c5460;\n  border-color: #bee5eb;\n}\n\n.cache-info {\n  margin-top: 30px;\n  padding: 20px;\n  background: rgba(255, 255, 255, 0.1);\n  border-radius: 8px;\n}\n\n.cache-files {\n  display: flex;\n  flex-direction: column;\n  gap: 10px;\n}\n\n.cache-file {\n  padding: 15px;\n  background: rgba(255, 255, 255, 0.1);\n  border-radius: 6px;\n  border: 1px solid rgba(255, 255, 255, 0.2);\n}\n\n.file-name {\n  font-weight: 600;\n  font-size: 16px;\n  margin-bottom: 5px;\n}\n\n.file-details {\n  display: flex;\n  gap: 15px;\n  font-size: 12px;\n  color: var(--text-color);\n  opacity: 0.8;\n}\n\n.file-details span {\n  background: rgba(255, 255, 255, 0.1);\n  padding: 2px 8px;\n  border-radius: 4px;\n}\n\n@media (max-width: 768px) {\n  .test-controls {\n    flex-direction: column;\n  }\n  \n  .btn {\n    width: 100%;\n  }\n  \n  .file-details {\n    flex-direction: column;\n    gap: 5px;\n  }\n}\n</style>\n"],"mappings":"AAqDA,SAASA,GAAG,QAAQ,KAAI;AACxB,OAAOC,eAAe,MAAM,kCAAiC;AAC7D,SAASC,sBAAsB,EAAEC,cAAc,QAAQ,4BAA2B;;;;;;;IAElF,MAAMC,aAAa,GAAGJ,GAAG,CAAC,KAAK;IAC/B,MAAMK,gBAAgB,GAAGL,GAAG,CAAC,IAAI;IACjC,MAAMM,SAAS,GAAGN,GAAG,CAAC,IAAI;IAE1B,eAAeO,eAAeA,CAAA,EAAG;MAC/B,IAAI;QACF,MAAMC,WAAW,GAAG,MAAMN,sBAAsB,CAAC;QACjDG,gBAAgB,CAACI,KAAK,GAAG;UACvBC,IAAI,EAAEF,WAAW,GAAG,eAAe,GAAG,cAAc;UACpDG,OAAO,EAAEH,WAAW,GAAG,QAAQ,GAAG;QACpC;MACF,CAAC,CAAC,OAAOI,KAAK,EAAE;QACdP,gBAAgB,CAACI,KAAK,GAAG;UACvBC,IAAI,EAAE,cAAc;UACpBC,OAAO,EAAE,SAAS,GAAGC,KAAK,CAACD;QAC7B;MACF;IACF;IAEA,SAASE,SAASA,CAAA,EAAG;MACnB,IAAI;QACFP,SAAS,CAACG,KAAK,GAAGN,cAAc,CAAC;MACnC,CAAC,CAAC,OAAOS,KAAK,EAAE;QACdP,gBAAgB,CAACI,KAAK,GAAG;UACvBC,IAAI,EAAE,cAAc;UACpBC,OAAO,EAAE,SAAS,GAAGC,KAAK,CAACD;QAC7B;MACF;IACF;IAEA,SAASG,UAAUA,CAAA,EAAG;MACpB,IAAIC,OAAO,CAAC,eAAe,CAAC,EAAE;QAC5B,IAAI;UACFC,YAAY,CAACC,UAAU,CAAC,mBAAmB;UAC3CX,SAAS,CAACG,KAAK,GAAG,IAAG;UACrBJ,gBAAgB,CAACI,KAAK,GAAG;YACvBC,IAAI,EAAE,eAAe;YACrBC,OAAO,EAAE;UACX;QACF,CAAC,CAAC,OAAOC,KAAK,EAAE;UACdP,gBAAgB,CAACI,KAAK,GAAG;YACvBC,IAAI,EAAE,cAAc;YACpBC,OAAO,EAAE,SAAS,GAAGC,KAAK,CAACD;UAC7B;QACF;MACF;IACF;IAEA,SAASO,cAAcA,CAACC,KAAK,EAAE;MAC7B,IAAIA,KAAK,KAAK,CAAC,EAAE,OAAO,SAAQ;MAChC,MAAMC,CAAC,GAAG,IAAG;MACb,MAAMC,KAAK,GAAG,CAAC,OAAO,EAAE,IAAI,EAAE,IAAI,EAAE,IAAI;MACxC,MAAMC,CAAC,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,GAAG,CAACN,KAAK,CAAC,GAAGI,IAAI,CAACE,GAAG,CAACL,CAAC,CAAC;MAClD,OAAOM,UAAU,CAAC,CAACP,KAAK,GAAGI,IAAI,CAACI,GAAG,CAACP,CAAC,EAAEE,CAAC,CAAC,EAAEM,OAAO,CAAC,CAAC,CAAC,CAAC,GAAG,GAAG,GAAGP,KAAK,CAACC,CAAC;IACxE;IAEA,SAASO,aAAaA,CAACC,MAAM,EAAE;MAC7B,MAAMC,SAAS,GAAG;QAChB,OAAO,EAAE,MAAM;QACf,WAAW,EAAE,KAAK;QAClB,UAAU,EAAE,KAAK;QACjB,OAAO,EAAE;MACX;MACA,OAAOA,SAAS,CAACD,MAAM,CAAC,IAAI,IAAG;IACjC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}