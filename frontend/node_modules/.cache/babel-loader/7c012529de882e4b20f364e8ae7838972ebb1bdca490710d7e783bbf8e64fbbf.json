{"ast":null,"code":"import { createElementVNode as _createElementVNode, toDisplayString as _toDisplayString, withModifiers as _withModifiers, normalizeClass as _normalizeClass, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, renderList as _renderList, Fragment as _Fragment, normalizeStyle as _normalizeStyle } from \"vue\";\nconst _hoisted_1 = {\n  class: \"workspace-title\"\n};\nconst _hoisted_2 = [\"innerHTML\"];\nconst _hoisted_3 = {\n  class: \"file-counter\"\n};\nconst _hoisted_4 = {\n  key: 0,\n  class: \"workspace-content\"\n};\nconst _hoisted_5 = {\n  class: \"file-info\"\n};\nconst _hoisted_6 = {\n  class: \"file-name\"\n};\nconst _hoisted_7 = {\n  class: \"file-meta\"\n};\nconst _hoisted_8 = {\n  class: \"file-size\"\n};\nconst _hoisted_9 = {\n  class: \"file-type\"\n};\nconst _hoisted_10 = {\n  class: \"workspace-actions\"\n};\nconst _hoisted_11 = [\"innerHTML\"];\nconst _hoisted_12 = [\"innerHTML\"];\nconst _hoisted_13 = [\"innerHTML\"];\nconst _hoisted_14 = {\n  key: 1,\n  class: \"workspace-navigation\"\n};\nconst _hoisted_15 = {\n  class: \"nav-dots\"\n};\nconst _hoisted_16 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return $setup.workspaceFiles.length > 0 ? (_openBlock(), _createElementBlock(\"div\", {\n    key: 0,\n    class: _normalizeClass([\"file-workspace\", {\n      'is-focused': $setup.isFocused,\n      'dragging': $setup.isDragging\n    }]),\n    style: _normalizeStyle($setup.workspacePosition),\n    onWheel: _withModifiers($setup.handleWheel, [\"prevent\"]),\n    onMouseenter: $setup.handleMouseEnter,\n    onMouseleave: $setup.handleMouseLeave,\n    onMousedown: $setup.handleMouseDown,\n    ref: \"workspaceRef\"\n  }, [_createElementVNode(\"div\", {\n    class: \"workspace-header\",\n    onMousedown: _withModifiers($setup.startDrag, [\"prevent\"])\n  }, [_createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"span\", {\n    class: \"workspace-icon\",\n    innerHTML: $setup.getThemeIcon('folder')\n  }, null, 8 /* PROPS */, _hoisted_2), _cache[1] || (_cache[1] = _createElementVNode(\"span\", null, \"Workspace\", -1 /* HOISTED */)), _createElementVNode(\"span\", _hoisted_3, _toDisplayString($setup.currentIndex + 1) + \"/\" + _toDisplayString($setup.workspaceFiles.length), 1 /* TEXT */)])], 32 /* NEED_HYDRATION */), $setup.currentFile ? (_openBlock(), _createElementBlock(\"div\", _hoisted_4, [_createElementVNode(\"div\", _hoisted_5, [_createElementVNode(\"div\", _hoisted_6, _toDisplayString($setup.currentFile.name), 1 /* TEXT */), _createElementVNode(\"div\", _hoisted_7, [_createElementVNode(\"span\", _hoisted_8, _toDisplayString($setup.formatFileSize($setup.currentFile.size)), 1 /* TEXT */), _createElementVNode(\"span\", _hoisted_9, _toDisplayString($setup.currentFile.name.split('.').pop().toUpperCase()), 1 /* TEXT */), _createElementVNode(\"span\", {\n    class: _normalizeClass([\"file-status\", $setup.currentFile.status])\n  }, _toDisplayString($setup.getStatusText($setup.currentFile.status)), 3 /* TEXT, CLASS */)])]), _createElementVNode(\"div\", _hoisted_10, [_createElementVNode(\"button\", {\n    class: \"floating-workspace-action-btn structure-btn\",\n    onClick: $setup.showFileStructure,\n    title: \"Show file structure\"\n  }, [_createElementVNode(\"span\", {\n    innerHTML: $setup.getThemeIcon('structure')\n  }, null, 8 /* PROPS */, _hoisted_11)]), _createElementVNode(\"button\", {\n    class: \"floating-workspace-action-btn preview-workspace-btn\",\n    onClick: $setup.previewCurrentFile,\n    title: \"Preview file\"\n  }, [_createElementVNode(\"span\", {\n    innerHTML: $setup.getThemeIcon('eye')\n  }, null, 8 /* PROPS */, _hoisted_12)]), _createElementVNode(\"button\", {\n    class: \"floating-workspace-action-btn remove-workspace-btn\",\n    onClick: _cache[0] || (_cache[0] = $event => $setup.removeFromWorkspace($setup.currentIndex)),\n    title: \"Remove from workspace\"\n  }, [_createElementVNode(\"span\", {\n    innerHTML: $setup.getThemeIcon('remove')\n  }, null, 8 /* PROPS */, _hoisted_13)])])])) : _createCommentVNode(\"v-if\", true), $setup.workspaceFiles.length > 1 ? (_openBlock(), _createElementBlock(\"div\", _hoisted_14, [_createElementVNode(\"div\", _hoisted_15, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($setup.workspaceFiles, (file, index) => {\n    return _openBlock(), _createElementBlock(\"span\", {\n      key: file.id,\n      class: _normalizeClass([\"nav-dot\", {\n        active: index === $setup.currentIndex\n      }]),\n      onClick: $event => $setup.currentIndex = index\n    }, null, 10 /* CLASS, PROPS */, _hoisted_16);\n  }), 128 /* KEYED_FRAGMENT */))])])) : _createCommentVNode(\"v-if\", true)], 38 /* CLASS, STYLE, NEED_HYDRATION */)) : _createCommentVNode(\"v-if\", true);\n}","map":{"version":3,"names":["class","key","$setup","workspaceFiles","length","_createElementBlock","_normalizeClass","isFocused","isDragging","style","_normalizeStyle","workspacePosition","onWheel","_withModifiers","handleWheel","onMouseenter","handleMouseEnter","onMouseleave","handleMouseLeave","onMousedown","handleMouseDown","ref","_createElementVNode","startDrag","_hoisted_1","innerHTML","getThemeIcon","_hoisted_2","_hoisted_3","_toDisplayString","currentIndex","currentFile","_hoisted_4","_hoisted_5","_hoisted_6","name","_hoisted_7","_hoisted_8","formatFileSize","size","_hoisted_9","split","pop","toUpperCase","status","getStatusText","_hoisted_10","onClick","showFileStructure","title","_hoisted_11","previewCurrentFile","_hoisted_12","_cache","$event","removeFromWorkspace","_hoisted_13","_createCommentVNode","_hoisted_14","_hoisted_15","_Fragment","_renderList","file","index","id","active","_hoisted_16"],"sources":["D:\\Learning Material\\Git\\Fuck-Charts\\frontend\\src\\components\\Common\\FileWorkspace.vue"],"sourcesContent":["<template>\n<div\nv-if=\"workspaceFiles.length > 0\"\nclass=\"file-workspace\"\n:class=\"{\n    'is-focused': isFocused,\n    'dragging': isDragging\n}\"\n:style=\"workspacePosition\"\n@wheel.prevent=\"handleWheel\"\n@mouseenter=\"handleMouseEnter\"\n@mouseleave=\"handleMouseLeave\"\n@mousedown=\"handleMouseDown\"\nref=\"workspaceRef\">\n    <div\n        class=\"workspace-header\"\n        @mousedown.prevent=\"startDrag\">\n        <div class=\"workspace-title\">\n        <span class=\"workspace-icon\" v-html=\"getThemeIcon('folder')\"></span>\n        <span>Workspace</span>\n        <span class=\"file-counter\">{{ currentIndex + 1 }}/{{ workspaceFiles.length }}</span>\n        </div>\n    </div>\n\n    <div class=\"workspace-content\" v-if=\"currentFile\">\n    <div class=\"file-info\">\n        <div class=\"file-name\">{{ currentFile.name }}</div>\n            <div class=\"file-meta\">\n                <span class=\"file-size\">{{ formatFileSize(currentFile.size) }}</span>\n                <span class=\"file-type\">{{ currentFile.name.split('.').pop().toUpperCase() }}</span>\n                <span class=\"file-status\" :class=\"currentFile.status\">\n                {{ getStatusText(currentFile.status) }}\n                </span>\n            </div>\n        </div>\n\n        <div class=\"workspace-actions\">\n            <button\n                class=\"floating-workspace-action-btn structure-btn\"\n                @click=\"showFileStructure\"\n                title=\"Show file structure\"\n            >\n                <span v-html=\"getThemeIcon('structure')\"></span>\n            </button>\n            <button\n                class=\"floating-workspace-action-btn preview-workspace-btn\"\n                @click=\"previewCurrentFile\"\n                title=\"Preview file\"\n            >\n                <span v-html=\"getThemeIcon('eye')\"></span>\n            </button>\n            <button\n                class=\"floating-workspace-action-btn remove-workspace-btn\"\n                @click=\"removeFromWorkspace(currentIndex)\"\n                title=\"Remove from workspace\"\n            >\n                <span v-html=\"getThemeIcon('remove')\"></span>\n            </button>\n        </div>\n    </div>\n\n    <div class=\"workspace-navigation\" v-if=\"workspaceFiles.length > 1\">\n        <div class=\"nav-dots\">\n        <span\n            v-for=\"(file, index) in workspaceFiles\"\n            :key=\"file.id\"\n            class=\"nav-dot\"\n            :class=\"{ active: index === currentIndex }\"\n            @click=\"currentIndex = index\">\n        </span>\n        </div>\n    </div>\n</div>\n</template>\n\n<script setup>\n/* eslint-disable */\nimport { ref, computed, watch, onMounted, onUnmounted } from 'vue'\nimport { getThemeIcon } from '@/assets/JS/SVG/icons.js'\n\n// Props\nconst props = defineProps({\n    files: {\n    type: Array,\n    default: () => []\n    }\n})\n\n// Emits\nconst emit = defineEmits(['remove', 'preview', 'clear', 'show-structure'])\n\n// 工作区文件列表\nconst workspaceFiles = ref([])\nconst currentIndex = ref(0)\n\n// 拖拽相关状态\nconst isDragging = ref(false)\nconst isFocused = ref(true)\nconst dragOffset = ref({ x: 0, y: 0 })\nconst workspacePosition = ref({\n    position: 'fixed',\n    top: '10px',\n    left: '200px'\n})\n\n// DOM 引用\nconst workspaceRef = ref(null)\n\n// 当前显示的文件\nconst currentFile = computed(() => {\n    return workspaceFiles.value[currentIndex.value] || null\n})\n\n// 监听传入的文件列表变化\nwatch(() => props.files, (newFiles) => {\n    workspaceFiles.value = [...newFiles]\n    if (currentIndex.value >= workspaceFiles.value.length) {\n        currentIndex.value = Math.max(0, workspaceFiles.value.length - 1)\n    }\n}, { immediate: true })\n\n// 鼠标事件处理\nfunction handleMouseEnter() {\n    isFocused.value = true\n}\n\nfunction handleMouseLeave() {\n    if (!isDragging.value) {\n        isFocused.value = false\n    }\n}\n\nfunction handleMouseDown() {\n    isFocused.value = true\n}\n\n// 拖拽功能\nfunction startDrag(event) {\n    isDragging.value = true\n    isFocused.value = true\n    \n    const rect = workspaceRef.value.getBoundingClientRect()\n    dragOffset.value = {\n        x: event.clientX - rect.left,\n        y: event.clientY - rect.top\n    }\n    \n    // 立即添加全局事件监听，提高响应速度\n    document.addEventListener('mousemove', handleDrag, { passive: false })\n    document.addEventListener('mouseup', stopDrag, { passive: false })\n    \n    // 防止默认行为和事件冒泡\n    event.preventDefault()\n    event.stopPropagation()\n    \n    // 添加拖拽类名以提供视觉反馈\n    workspaceRef.value.classList.add('dragging')\n}\n\nfunction handleDrag(event) {\n    if (!isDragging.value) return\n    \n    // 使用 requestAnimationFrame 确保流畅性\n    requestAnimationFrame(() => {\n        const newX = event.clientX - dragOffset.value.x\n        const newY = event.clientY - dragOffset.value.y\n        \n        // 确保窗口不会拖拽到屏幕外\n        const maxX = window.innerWidth - 220\n        const maxY = window.innerHeight - 200\n        \n        const clampedX = Math.max(0, Math.min(newX, maxX))\n        const clampedY = Math.max(0, Math.min(newY, maxY))\n        \n        workspacePosition.value = {\n            position: 'fixed',\n            top: `${clampedY}px`,\n            left: `${clampedX}px`,\n            transform: 'none' // 确保没有额外的transform影响位置\n        }\n    })\n    \n    event.preventDefault()\n}\n\nfunction stopDrag(event) {\n    isDragging.value = false\n    \n    // 立即移除事件监听\n    document.removeEventListener('mousemove', handleDrag)\n    document.removeEventListener('mouseup', stopDrag)\n    \n    // 移除拖拽类名\n    if (workspaceRef.value) {\n        workspaceRef.value.classList.remove('dragging')\n    }\n    \n    // 稍微延迟检查焦点状态，避免立即失焦\n    setTimeout(() => {\n        if (!isDragging.value) {\n            isFocused.value = false\n        }\n    }, 150)\n    \n    event.preventDefault()\n}\n\n// 组件挂载时添加全局点击监听\nonMounted(() => {\n    document.addEventListener('click', handleGlobalClick)\n})\n\nonUnmounted(() => {\n    document.removeEventListener('click', handleGlobalClick)\n    document.removeEventListener('mousemove', handleDrag)\n    document.removeEventListener('mouseup', stopDrag)\n})\n\n// 全局点击处理\nfunction handleGlobalClick(event) {\n    if (workspaceRef.value && !workspaceRef.value.contains(event.target)) {\n        isFocused.value = false\n    }\n}\n\n// 处理滚轮事件\nfunction handleWheel (event) {\n    if (workspaceFiles.value.length <= 1) return\n\n    const delta = event.deltaY\n    if (delta > 0) {\n        // 向下滚动，切换到下一个文件\n        currentIndex.value = (currentIndex.value + 1) % workspaceFiles.value.length\n    } else {\n        // 向上滚动，切换到上一个文件\n        currentIndex.value = currentIndex.value === 0\n        ? workspaceFiles.value.length - 1\n        : currentIndex.value - 1\n    }\n}\n\n// 从工作区移除文件\nfunction removeFromWorkspace (index) {\n    const removedFile = workspaceFiles.value[index]\n    workspaceFiles.value.splice(index, 1)\n\n    // 调整当前索引\n    if (currentIndex.value >= workspaceFiles.value.length) {\n        currentIndex.value = Math.max(0, workspaceFiles.value.length - 1)\n    }\n\n    emit('remove', removedFile)\n}\n\n// 清空工作区\nfunction clearWorkspace () {\n    workspaceFiles.value = []\n    currentIndex.value = 0\n    emit('clear')\n}\n\n// 预览当前文件\nfunction previewCurrentFile () {\n    if (currentFile.value) {\n        emit('preview', currentFile.value)\n    }\n}\n\n// 显示文件结构\nfunction showFileStructure() {\n    if (currentFile.value) {\n        emit('show-structure', currentFile.value)\n    }\n}\n\n// 格式化文件大小\nfunction formatFileSize (bytes) {\n    if (bytes === 0) return '0 Bytes'\n    const k = 1024\n    const sizes = ['Bytes', 'KB', 'MB', 'GB']\n    const i = Math.floor(Math.log(bytes) / Math.log(k))\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n}\n\n// 获取状态文本（仅本地缓存状态）\nfunction getStatusText (status) {\n    const statusMap = {\n        local: 'Local Cache',\n        error: 'Error'\n    }\n    return statusMap[status] || 'Local Cache'\n}\n\n// 暴露方法给父组件\ndefineExpose({\n    addFile: (file) => {\n        // 检查文件是否已经在工作区\n        const exists = workspaceFiles.value.find(f => f.id === file.id)\n        if (!exists) {\n        workspaceFiles.value.push(file)\n        }\n    },\n    removeFile: (fileId) => {\n        const index = workspaceFiles.value.findIndex(f => f.id === fileId)\n        if (index !== -1) {\n        removeFromWorkspace(index)\n        }\n    },\n    clearAll: () => {\n        clearWorkspace()\n    }\n})\n</script>\n\n<style scoped>\n@import '../../assets/CSS/FileWorkspace.css';\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}