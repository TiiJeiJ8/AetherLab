{"ast":null,"code":"import { ref, computed, onMounted, onBeforeUnmount } from 'vue';\nconst accelDuration = 700; // ms\nconst shakeDuration = 600; // ms\nconst returnDuration = 900; // ms\nconst shakeTimes = 3;\nexport default {\n  __name: 'GaugeChartIcon',\n  setup(__props, {\n    expose: __expose\n  }) {\n    __expose();\n\n    /* eslint-disable */\n    const t = ref(0);\n    let animId = null;\n    const min = Math.PI,\n      max = 0;\n    const pointerAngle = computed(() => min + (max - min) * t.value);\n    const pointerX = computed(() => 60 + 28 * Math.cos(pointerAngle.value));\n    const pointerY = computed(() => 60 - 28 * Math.sin(pointerAngle.value));\n\n    // 动画阶段：0=加速，1=抖动，2=回原点\n    let phase = 0;\n    let phaseStart = 0;\n    let shakeCount = 0;\n    function easeOutCubic(x) {\n      return 1 - Math.pow(1 - x, 3);\n    }\n    function easeInCubic(x) {\n      return x * x * x;\n    }\n    function easeOutElastic(x) {\n      // 弹性抖动\n      const c4 = 2 * Math.PI / 3;\n      return x === 0 ? 0 : x === 1 ? 1 : Math.pow(2, -10 * x) * Math.sin((x * 10 - 0.75) * c4) + 1;\n    }\n    function animateGauge(ts) {\n      if (!animateGauge.last) animateGauge.last = ts;\n      const elapsed = ts - animateGauge.last + phaseStart;\n      if (phase === 0) {\n        // 加速到最大\n        let p = Math.min(elapsed / accelDuration, 1);\n        t.value = easeOutCubic(p);\n        if (p >= 1) {\n          phase = 1;\n          phaseStart = 0;\n          animateGauge.last = ts;\n          shakeCount = 0;\n        } else {\n          animId = requestAnimationFrame(animateGauge);\n          return;\n        }\n      }\n      if (phase === 1) {\n        // 抖动\n        let p = Math.min(elapsed / shakeDuration, 1);\n        t.value = 1 - 0.08 * Math.sin(p * shakeTimes * Math.PI * 2) * (1 - p);\n        if (p >= 1) {\n          phase = 2;\n          phaseStart = 0;\n          animateGauge.last = ts;\n        } else {\n          animId = requestAnimationFrame(animateGauge);\n          return;\n        }\n      }\n      if (phase === 2) {\n        // 回原点\n        let p = Math.min(elapsed / returnDuration, 1);\n        t.value = 1 - easeInCubic(p);\n        if (p >= 1) {\n          // 停顿后循环\n          setTimeout(() => {\n            phase = 0;\n            phaseStart = 0;\n            animateGauge.last = undefined;\n            t.value = 0;\n            animId = requestAnimationFrame(animateGauge);\n          }, 400);\n          return;\n        } else {\n          animId = requestAnimationFrame(animateGauge);\n          return;\n        }\n      }\n    }\n    onMounted(() => {\n      t.value = 0;\n      phase = 0;\n      phaseStart = 0;\n      animateGauge.last = undefined;\n      animId = requestAnimationFrame(animateGauge);\n    });\n    onBeforeUnmount(() => {\n      if (animId) cancelAnimationFrame(animId);\n    });\n    const __returned__ = {\n      t,\n      get animId() {\n        return animId;\n      },\n      set animId(v) {\n        animId = v;\n      },\n      min,\n      max,\n      pointerAngle,\n      pointerX,\n      pointerY,\n      get phase() {\n        return phase;\n      },\n      set phase(v) {\n        phase = v;\n      },\n      get phaseStart() {\n        return phaseStart;\n      },\n      set phaseStart(v) {\n        phaseStart = v;\n      },\n      get shakeCount() {\n        return shakeCount;\n      },\n      set shakeCount(v) {\n        shakeCount = v;\n      },\n      accelDuration,\n      shakeDuration,\n      returnDuration,\n      shakeTimes,\n      easeOutCubic,\n      easeInCubic,\n      easeOutElastic,\n      animateGauge,\n      ref,\n      computed,\n      onMounted,\n      onBeforeUnmount\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n};","map":{"version":3,"names":["ref","computed","onMounted","onBeforeUnmount","accelDuration","shakeDuration","returnDuration","shakeTimes","t","animId","min","Math","PI","max","pointerAngle","value","pointerX","cos","pointerY","sin","phase","phaseStart","shakeCount","easeOutCubic","x","pow","easeInCubic","easeOutElastic","c4","animateGauge","ts","last","elapsed","p","requestAnimationFrame","setTimeout","undefined","cancelAnimationFrame"],"sources":["D:/Learning Material/Git/Fuck-Charts/frontend/src/components/svg/GaugeChartIcon.vue"],"sourcesContent":["<template>\n<svg width=\"150\" height=\"120\" viewBox=\"0 0 120 80\" fill=\"none\" xmlns=\"http://www.w3.org/2000/svg\" class=\"empty-gauge-svg\">\n    <g>\n        <!-- 仪表盘弧形 -->\n        <path class=\"gauge-arc\" d=\"M30,60 A30,30 0 0,1 90,60\" />\n        <!-- 动态指针 -->\n        <line class=\"gauge-pointer\" :x1=\"60\" :y1=\"60\" :x2=\"pointerX\" :y2=\"pointerY\" />\n        <!-- 圆心 -->\n        <circle cx=\"60\" cy=\"60\" r=\"4\" fill=\"#FFB300\" />\n    </g>\n</svg>\n</template>\n\n<script setup>\n/* eslint-disable */\nimport { ref, computed, onMounted, onBeforeUnmount } from 'vue'\nconst t = ref(0)\nlet animId = null\nconst min = Math.PI, max = 0\nconst pointerAngle = computed(() => min + (max-min)*t.value)\nconst pointerX = computed(() => 60 + 28*Math.cos(pointerAngle.value))\nconst pointerY = computed(() => 60 - 28*Math.sin(pointerAngle.value))\n\n// 动画阶段：0=加速，1=抖动，2=回原点\nlet phase = 0\nlet phaseStart = 0\nlet shakeCount = 0\nconst accelDuration = 700 // ms\nconst shakeDuration = 600 // ms\nconst returnDuration = 900 // ms\nconst shakeTimes = 3\n\nfunction easeOutCubic(x) { return 1 - Math.pow(1 - x, 3) }\nfunction easeInCubic(x) { return x * x * x }\nfunction easeOutElastic(x) {\n  // 弹性抖动\n  const c4 = (2 * Math.PI) / 3\n  return x === 0\n    ? 0\n    : x === 1\n    ? 1\n    : Math.pow(2, -10 * x) * Math.sin((x * 10 - 0.75) * c4) + 1\n}\n\nfunction animateGauge(ts) {\n  if (!animateGauge.last) animateGauge.last = ts\n  const elapsed = ts - animateGauge.last + phaseStart\n  if (phase === 0) {\n    // 加速到最大\n    let p = Math.min(elapsed / accelDuration, 1)\n    t.value = easeOutCubic(p)\n    if (p >= 1) {\n      phase = 1; phaseStart = 0; animateGauge.last = ts; shakeCount = 0\n    } else {\n      animId = requestAnimationFrame(animateGauge)\n      return\n    }\n  }\n  if (phase === 1) {\n    // 抖动\n    let p = Math.min(elapsed / shakeDuration, 1)\n    t.value = 1 - 0.08 * Math.sin(p * shakeTimes * Math.PI * 2) * (1 - p)\n    if (p >= 1) {\n      phase = 2; phaseStart = 0; animateGauge.last = ts\n    } else {\n      animId = requestAnimationFrame(animateGauge)\n      return\n    }\n  }\n  if (phase === 2) {\n    // 回原点\n    let p = Math.min(elapsed / returnDuration, 1)\n    t.value = 1 - easeInCubic(p)\n    if (p >= 1) {\n      // 停顿后循环\n      setTimeout(() => {\n        phase = 0; phaseStart = 0; animateGauge.last = undefined; t.value = 0\n        animId = requestAnimationFrame(animateGauge)\n      }, 400)\n      return\n    } else {\n      animId = requestAnimationFrame(animateGauge)\n      return\n    }\n  }\n}\n\nonMounted(() => {\n  t.value = 0; phase = 0; phaseStart = 0; animateGauge.last = undefined\n  animId = requestAnimationFrame(animateGauge)\n})\nonBeforeUnmount(() => { if (animId) cancelAnimationFrame(animId) })\n</script>\n<style scoped>\n.empty-gauge-svg { display: block; margin: 0 auto; animation: floatX 4.2s ease-in-out infinite; }\n.gauge-arc {\n    fill: none;\n    stroke: #A0C4FF;\n    stroke-width: 7;\n    opacity: 0.18;\n}\n.gauge-pointer {\n    stroke: #4F8EF7;\n    stroke-width: 5;\n    stroke-linecap: round;\n    opacity: 0.7;\n    transition: x2 0.32s, y2 0.32s, opacity 0.32s;\n}\n@keyframes floatX {\n    0% { transform: translateY(0) translateX(0); }\n    25% { transform: translateY(-8px) translateX(4px); }\n    50% { transform: translateY(-12px) translateX(-4px); }\n    75% { transform: translateY(-8px) translateX(4px); }\n    100% { transform: translateY(0) translateX(0); }\n}\n</style>\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}